<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<meta name="robots" content="noindex" />
		<link rel="canonical" href="http://dkn255hz262ypmii.onion/index.php?topic=171274.0" />
		<title>Print Page - A threat to SR?</title>
		<style type="text/css">
			body, a
			{
				color: #000;
				background: #fff;
			}
			body, td, .normaltext
			{
				font-family: Verdana, arial, helvetica, serif;
				font-size: small;
			}
			h1#title
			{
				font-size: large;
				font-weight: bold;
			}
			h2#linktree
			{
				margin: 1em 0 2.5em 0;
				font-size: small;
				font-weight: bold;
			}
			dl#posts
			{
				width: 90%;
				margin: 0;
				padding: 0;
				list-style: none;
			}
			dt.postheader
			{
				border: solid #000;
				border-width: 1px 0;
				padding: 4px 0;
			}
			dd.postbody
			{
				margin: 1em 0 2em 2em;
			}
			table
			{
				empty-cells: show;
			}
			blockquote, code
			{
				border: 1px solid #000;
				margin: 3px;
				padding: 1px;
				display: block;
			}
			code
			{
				font: x-small monospace;
			}
			blockquote
			{
				font-size: x-small;
			}
			.smalltext, .quoteheader, .codeheader
			{
				font-size: x-small;
			}
			.largetext
			{
				font-size: large;
			}
			.centertext
			{
				text-align: center;
			}
			hr
			{
				height: 1px;
				border: 0;
				color: black;
				background-color: black;
			}
		</style>
	</head>
	<body>
		<h1 id="title">Silk Road forums</h1>
		<h2 id="linktree">Discussion => Silk Road discussion => Topic started by: vanilla on June 12, 2013, 05:29 am</h2>
		<dl id="posts">
			<dt class="postheader">
				Title: <strong>A threat to SR?</strong><br />
				Post by: <strong>vanilla</strong> on <strong>June 12, 2013, 05:29 am</strong>
			</dt>
			<dd class="postbody">
				I came across this earlier tonight and it troubled me deeply. Basically details how SR could be de-anonymized for $11,000. Clearnet link... Anyone with way more technical knowledge than me care to comment? Should we be worried?<br /><br />https://plus.google.com/114798402540078632611/posts/i45Ma63cMgg<br />
			</dd>
			<dt class="postheader">
				Title: <strong>Re: A threat to SR?</strong><br />
				Post by: <strong>forgettegrof</strong> on <strong>June 12, 2013, 05:50 am</strong>
			</dt>
			<dd class="postbody">
				Did you send it to DPR?
			</dd>
			<dt class="postheader">
				Title: <strong>Re: A threat to SR?</strong><br />
				Post by: <strong>vanilla</strong> on <strong>June 12, 2013, 05:57 am</strong>
			</dt>
			<dd class="postbody">
				I did not send it to DPR directly but I hope that by putting it here this post might garner enough attention that he will see it. Feel free to contact him and direct him to the thread. Frankly, I wanted to get some input from some of the community&#039;s more knowledgeable people before bothering DPR with it.
			</dd>
			<dt class="postheader">
				Title: <strong>Re: A threat to SR?</strong><br />
				Post by: <strong>forgettegrof</strong> on <strong>June 12, 2013, 06:02 am</strong>
			</dt>
			<dd class="postbody">
				<div class="quoteheader"><div class="topslice_quote"><a href="http://dkn255hz262ypmii.onion/index.php?topic=171274.msg1226152#msg1226152">Quote from: vanilla on June 12, 2013, 05:57 am</a></div></div><blockquote class="bbc_standard_quote">I did not send it to DPR directly but I hope that by putting it here this post might garner enough attention that he will see it. Feel free to contact him and direct him to the thread. Frankly, I wanted to get some input from some of the community&#039;s more knowledgeable people before bothering DPR with it.<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />That&#039;s true, but when someone makes that bold of a claim I&#039;m sure he/she/it wouldn&#039;t mind giving it a look over. I&#039;d probably send it to pine too, just to see what the platypus has to say on such a thing.
			</dd>
			<dt class="postheader">
				Title: <strong>Re: A threat to SR?</strong><br />
				Post by: <strong>envioso</strong> on <strong>June 12, 2013, 06:04 am</strong>
			</dt>
			<dd class="postbody">
				it is unlikely the servers are traceable back to anyone except fictitious identities payed for in bitcoin. i wouldn&#039;t worry too much.
			</dd>
			<dt class="postheader">
				Title: <strong>Re: A threat to SR?</strong><br />
				Post by: <strong>SelfSovereignty</strong> on <strong>June 12, 2013, 06:27 am</strong>
			</dt>
			<dd class="postbody">
				Yeah, so um... they&#039;ve got some of their technical details... well they&#039;re either just straight up wrong, they&#039;re talking about an earlier protocol of Tor (despite their explicit claim to be referencing the current design), or I&#039;m just too fucking exhausted to follow their paper.&nbsp; My money&#039;s on it being a prior version of the onion routing protocol.&nbsp; Which is pretty fucked up given their opening paragraphs; but frankly I&#039;m too tired to read the whole thing... still, that&#039;s my opinion based on skimming their description of how the network they&#039;re attacking works.&nbsp; Even some of their diagrams aren&#039;t right...<br /><br />I wouldn&#039;t worry about this.&nbsp; I think they&#039;re outdated, or... fucking something, I don&#039;t know.&nbsp; I&#039;ll come back to it another time.&nbsp; Don&#039;t forget, in academia, you either publish or perish -- nobody says it has to be useful&nbsp; &nbsp;;D
			</dd>
			<dt class="postheader">
				Title: <strong>Re: A threat to SR?</strong><br />
				Post by: <strong>astor</strong> on <strong>June 12, 2013, 06:41 am</strong>
			</dt>
			<dd class="postbody">
				FYI, Mike Hearn is a Google employee and Bitcoin developer.<br /><br />Anyway: http://dkn255hz262ypmii.onion/index.php?topic=161391.msg1160970#msg1160970<br /><br />The threat is real.<br />
			</dd>
			<dt class="postheader">
				Title: <strong>Re: A threat to SR?</strong><br />
				Post by: <strong>forgettegrof</strong> on <strong>June 12, 2013, 06:44 am</strong>
			</dt>
			<dd class="postbody">
				<div class="quoteheader"><div class="topslice_quote"><a href="http://dkn255hz262ypmii.onion/index.php?topic=171274.msg1226250#msg1226250">Quote from: astor on June 12, 2013, 06:41 am</a></div></div><blockquote class="bbc_standard_quote"><br />The threat is real.<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />*cue dramatic music*
			</dd>
			<dt class="postheader">
				Title: <strong>Re: A threat to SR?</strong><br />
				Post by: <strong>Libertas</strong> on <strong>June 12, 2013, 06:51 am</strong>
			</dt>
			<dd class="postbody">
				Thanks for the link, vanilla. I&#039;ve passed it up to DPR in case he/she hasn&#039;t seen it yet.<br /><br />Libertas
			</dd>
			<dt class="postheader">
				Title: <strong>Re: A threat to SR?</strong><br />
				Post by: <strong>astor</strong> on <strong>June 12, 2013, 07:04 am</strong>
			</dt>
			<dd class="postbody">
				<div class="quoteheader"><div class="topslice_quote"><a href="http://dkn255hz262ypmii.onion/index.php?topic=171274.msg1226256#msg1226256">Quote from: forgettegrof on June 12, 2013, 06:44 am</a></div></div><blockquote class="bbc_standard_quote">*cue dramatic music*<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />It&#039;s pretty well known that Tor is insecure with respect to the default configuration for hidden services. An attacker can find the entry guards in under 2 hours. That&#039;s not news. One such attack has been in the literature since 2006.<br /><br />However, there are measures a hidden service can take to mitigate these attacks, and I&#039;m sure DPR and gang are well ahead of LE and researchers in their defenses.
			</dd>
			<dt class="postheader">
				Title: <strong>Re: A threat to SR?</strong><br />
				Post by: <strong>Libertas</strong> on <strong>June 12, 2013, 07:09 am</strong>
			</dt>
			<dd class="postbody">
				<div class="quoteheader"><div class="topslice_quote"><a href="http://dkn255hz262ypmii.onion/index.php?topic=171274.msg1226279#msg1226279">Quote from: astor on June 12, 2013, 07:04 am</a></div></div><blockquote class="bbc_standard_quote">However, there are measures a hidden service can take to mitigate these attacks, and I&#039;m sure DPR and gang are well ahead of LE and researchers in their defenses.<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />No doubt!<br /><br />Libertas
			</dd>
			<dt class="postheader">
				Title: <strong>Re: A threat to SR?</strong><br />
				Post by: <strong>SelfSovereignty</strong> on <strong>June 12, 2013, 07:42 am</strong>
			</dt>
			<dd class="postbody">
				<div class="quoteheader"><div class="topslice_quote"><a href="http://dkn255hz262ypmii.onion/index.php?topic=171274.msg1226250#msg1226250">Quote from: astor on June 12, 2013, 06:41 am</a></div></div><blockquote class="bbc_standard_quote">FYI, Mike Hearn is a Google employee and Bitcoin developer.<br /><br />Anyway: http://dkn255hz262ypmii.onion/index.php?topic=161391.msg1160970#msg1160970<br /><br />The threat is real.<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />But it can&#039;t be; here&#039;s their description of hidden services:<br /><br /><div class="quoteheader"><div class="topslice_quote">Quote from: Section III</div></div><blockquote class="bbc_standard_quote">The Tor hidden service architecture:<br />1. Internet service which is available as Tor hidden service;<br />2. Client, which wants to access hidden service;<br />3. Introduction Points, tor relays chosen by the hidden service and which are used for forwarding management cells necessary to connect the Client and the Hidden Service at the Rendezvous point;<br />4. Hidden Service directories (HSDir): Tor relays at which the hidden service publishes its descriptors and which are communicated by clients in order to learn the address of the hidden service&#039;s introduction points;<br />5. Rendezvous point (RP): a Tor relay chosen by the client which is used to forward all the data between the client and the hidden service.<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />That&#039;s... not, quite accurate.&nbsp; It&#039;s leaving out guards, which is what had me thinking it was the protocol before their introduction.&nbsp; But sure, maybe they skimmed over it (or I missed it in my own skimming).&nbsp; But further on, they clearly state:<br /><br /><div class="quoteheader"><div class="topslice_quote">Quote from: Section III</div></div><blockquote class="bbc_standard_quote">In order to establish a connection to a given hidden service Alice&#039;s OP [note: onion proxy] first builds a rendezvous circuit (step 4).&nbsp; It does this by establishing a circ uit to a randomly chosen Tor relay (OR)&nbsp; [note: onion router], and sending a RELAY_COMMAND_ESTABLISH_RENDEZVOUS cell to that OR.&nbsp; The body of that cell contains a Rendezvous cookie (RC).&nbsp; The rendezvous cookie is an arbitrary 20-byte value, chosen randomly by Alice&#039;s OP... ... ... Alice builds a separate circuit to one of Bob&#039;s chosen introduction points, and sends it a RELAY_COMMAND_INTRODUCE1 cell containing the IP address and the fingerprint of the rendezvous point, the hash of the public key of the hidden service (PK_ID), and the rendezvous cookie (step 5).<br /><br />If the introduction point recognizes PK_ID as the public key of a hidden service it serves, it sends the body of the cell in a new RELAY_COMMAND_INTRODUCE2 cell down the corrsponding circuit (step 6).<br /><br />When Bob&#039;s OP receives the RELAY_COMMAND_INTRODUCE2 cell, it decrypts it using the private key of the corresponding hidden service and extracts the rendezvous point&#039;s nickname as well as the rendezvous cookie.<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />Sure, that&#039;s all well and good... except they STILL haven&#039;t mentioned the fucking guards?&nbsp; It&#039;s like they&#039;re analyzing the network before guards were introduced.&nbsp; Now in fairness they go on to talk about them when detailing their next attack, but there&#039;s weirdness there.&nbsp; Before skipping to VI A though, this line in V A caught my eye:<br /><br /><div class="quoteheader"><div class="topslice_quote">Quote from: Section V A</div></div><blockquote class="bbc_standard_quote">Just like any Tor client, an attacker is able to compute the descriptor IDs of the hidden service for any moment in the future and find the fingerprints of expected responsible HS directories.&nbsp; After that she can compute the private/public key pairs so that SHA-1 hash of the public keys would be in-between the descriptor ID and the fingerprint of the first responsible hidden service directory.&nbsp; The attacker then runs Tor relays with the computer public/private key pairs and waits for 25 hours until they obtain the HSDir flag.<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />I thought you could only calculate the descriptor IDs 24 hours in advance, but whatever, skipping that: how can this be possible at all, since even assuming they get to the point of impersonating the HSDirs in question due to the properties of the distributed hash table... they still won&#039;t have the private key for those servers that the 6 (is it 6?) authoritative directories will be checking for, and so will be ignored anyway?<br /><br /><br />Last bit I actually skimmed; I&#039;m sick of quoting this paper, but again:<br /><br /><div class="quoteheader"><div class="topslice_quote">Quote from: Section VI A</div></div><blockquote class="bbc_standard_quote">In order to confirm that an attacker controls a guard node of a hidden service she needs to control at least one more Tor non-exit relay.&nbsp; In the attack, the hidden service is forced to establish rendezvous circuits to the rendezvous point controlled by the attacker.<br />...<br />If all the conditions are satisfied, the attacker decides that her guard node was chosen for the hidden service&#039;s rendezvous circuit and marks the previous node in the circuit as the origin of the hidden service.<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />I skipped over some stuff because I&quot;m tired, but I don&#039;t understand how this is possible, unless you&#039;re running Tor over Tor...?&nbsp; How can a guard ever be chosen as an introduction point for a hidden service -- the guard knows what hidden service it&#039;s a guard for, why in God&#039;s name would it blindly say &quot;sure, I&#039;ll be the rendezvous point for my pal there!&quot;&nbsp; ???<br /><br />
			</dd>
			<dt class="postheader">
				Title: <strong>Re: A threat to SR?</strong><br />
				Post by: <strong>Jediknight</strong> on <strong>June 12, 2013, 05:40 pm</strong>
			</dt>
			<dd class="postbody">
				Good reading guys.&nbsp; thanks.&nbsp; &nbsp;
			</dd>
			<dt class="postheader">
				Title: <strong>Re: A threat to SR?</strong><br />
				Post by: <strong>Purple_Hue000</strong> on <strong>June 12, 2013, 06:06 pm</strong>
			</dt>
			<dd class="postbody">
				imagine how paranoid DPR must be! Anything so little out of the ordinary such as a strange car passing by and he probably thinks the feds are onto him!!
			</dd>
			<dt class="postheader">
				Title: <strong>Re: A threat to SR?</strong><br />
				Post by: <strong>BlazedForDays</strong> on <strong>June 12, 2013, 07:08 pm</strong>
			</dt>
			<dd class="postbody">
				<div class="quoteheader"><div class="topslice_quote"><a href="http://dkn255hz262ypmii.onion/index.php?topic=171274.msg1226265#msg1226265">Quote from: Libertas on June 12, 2013, 06:51 am</a></div></div><blockquote class="bbc_standard_quote">Thanks for the link, vanilla. I&#039;ve passed it up to DPR in case he/she hasn&#039;t seen it yet.<br /><br />Libertas<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />Hey just a heads up if you don&#039;t know someone&#039;s gender it&#039;s grammatically correct to say he instead of he/she. Not trying to be a dick. :)<br /><br />Anyway, from skimming the paper I&#039;m not sure this attack would really be that effective; I have no experience with Hidden Services development though, so take my opinion as you will.&nbsp; 
			</dd>
			<dt class="postheader">
				Title: <strong>Re: A threat to SR?</strong><br />
				Post by: <strong>blacksmith</strong> on <strong>June 12, 2013, 07:40 pm</strong>
			</dt>
			<dd class="postbody">
				That&#039;s because the FEDS are probably on to him.
			</dd>
			<dt class="postheader">
				Title: <strong>Re: A threat to SR?</strong><br />
				Post by: <strong>piratesam</strong> on <strong>June 12, 2013, 08:59 pm</strong>
			</dt>
			<dd class="postbody">
				This is unnerving. It doesn&#039;t seem to pose a threat to the users but to SR itself. Although we know here the drug war all to well, and we know there is always a way around it. If SR goes then there will be another to take its place. Except a new SR probably wouldn&#039;t be so open and maybe even invite. SR is only in danger because a lot of kids end up here after a few google searches and then cry to the authorities when their mommy intercepts their orders. SR needs to go low profile.
			</dd>
			<dt class="postheader">
				Title: <strong>Re: A threat to SR?</strong><br />
				Post by: <strong>astor</strong> on <strong>June 12, 2013, 09:07 pm</strong>
			</dt>
			<dd class="postbody">
				<div class="quoteheader"><div class="topslice_quote"><a href="http://dkn255hz262ypmii.onion/index.php?topic=171274.msg1226315#msg1226315">Quote from: SelfSovereignty on June 12, 2013, 07:42 am</a></div></div><blockquote class="bbc_standard_quote">That&#039;s... not, quite accurate.&nbsp; It&#039;s leaving out guards, which is what had me thinking it was the protocol before their introduction.&nbsp; But sure, maybe they skimmed over it (or I missed it in my own skimming).&nbsp; But further on, they clearly state:<br />....<br /><br />Sure, that&#039;s all well and good... except they STILL haven&#039;t mentioned the fucking guards?&nbsp; It&#039;s like they&#039;re analyzing the network before guards were introduced.&nbsp; Now in fairness they go on to talk about them when detailing their next attack, but there&#039;s weirdness there.&nbsp; Before skipping to VI A though, this line in V A caught my eye:<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />Well, they&#039;re describing the first part of the attack. The other part is to flood the network with guards, the economics of which is described in VI.C:<br /><br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">In early 2012 we operated a guard node that we rented from a large European hosting company (Server4You, product EcoServer Large X5) for EUR 45 (approx. USD 60) per month. Averaging over a month and taking the bandwidth weights into account we calculated that the probability for this node to be chosen as a guard node was approximately 0.6% on average for each try a Tor client made that month. As each hidden service chooses three guard nodes initially, we expect over 450 hidden services to have chosen this node as a guard node10 . Running these numbers for a targeted (non-opportunistic) version of the attack described in Section VI-A shows us that by renting 23 servers of this same type would give us a chance of 13.8% for any of these servers to be chosen. This means that within 8 months, the probability to deanonymize a long-running hidden service by one of these servers becoming its guard node is more than 90%, for a cost of EUR 8280 (approximately USD 11,000).<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br /><br /><div class="quoteheader"><div class="topslice_quote"><a href="http://dkn255hz262ypmii.onion/index.php?topic=171274.msg1226315#msg1226315">Quote from: SelfSovereignty on June 12, 2013, 07:42 am</a></div></div><blockquote class="bbc_standard_quote"><div class="quoteheader"><div class="topslice_quote">Quote from: Section V A</div></div><blockquote class="bbc_alternate_quote">Just like any Tor client, an attacker is able to compute the descriptor IDs of the hidden service for any moment in the future and find the fingerprints of expected responsible HS directories.&nbsp; After that she can compute the private/public key pairs so that SHA-1 hash of the public keys would be in-between the descriptor ID and the fingerprint of the first responsible hidden service directory.&nbsp; The attacker then runs Tor relays with the computer public/private key pairs and waits for 25 hours until they obtain the HSDir flag.<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />I thought you could only calculate the descriptor IDs 24 hours in advance<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />Unless a cookie is set with the HiddenServiceAuthorizeClient option, the descriptor IDs are deterministic and computable arbitrarily into the future:<br /><br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">Tor hidden service desc_id‘s are calculated deterministically and if there is no ‘descriptor cookie’ set in the hidden service Tor config anyone can determine the desc id‘s for any hidden service at any point in time.This is a requirement for the current hidden service protocol as clients must calculate the current descriptor id to request hidden service descriptors from the HSDir’s. The descriptor ID’s are calculated as follows:<br /><br />descriptor-id = H(permanent-id | H(time-period | descriptor-cookie | replica))<br /><br />The replica is an integer, currently either 0 or 1 which will generate two separate descriptor ID’s, distributing the descriptor to two sets of 3 consecutive nodes in the DHT. The permanent-id is derived from the service public key. The hash function is SHA1.<br /><br />time-period = (current-time + permanent-id-byte * 86400 / 256) / 86400<br /><br />The time-period changes every 24 hours. The first byte of the permanent_id is added to make sure the hidden services do not all try to update their descriptors at the same time.<br /><br />identity-digest = H(server-identity-key)<br /><br />The identity-digest is the SHA1 hash of the public key generated from the secret_id_key file in Tor’s keys directory. Normally it should never change for a node as it is used for to determine the router’s long-term fingerprint, but the key is completely user controlled.<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br /><div class="quoteheader"><div class="topslice_quote"><a href="http://dkn255hz262ypmii.onion/index.php?topic=171274.msg1226315#msg1226315">Quote from: SelfSovereignty on June 12, 2013, 07:42 am</a></div></div><blockquote class="bbc_standard_quote">but whatever, skipping that: how can this be possible at all, since even assuming they get to the point of impersonating the HSDirs in question due to the properties of the distributed hash table... they still won&#039;t have the private key for those servers that the 6 (is it 6?) authoritative directories will be checking for, and so will be ignored anyway?<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />I&#039;m not sure what you&#039;re asking here. <br /><br /><div class="quoteheader"><div class="topslice_quote"><a href="http://dkn255hz262ypmii.onion/index.php?topic=171274.msg1226315#msg1226315">Quote from: SelfSovereignty on June 12, 2013, 07:42 am</a></div></div><blockquote class="bbc_standard_quote"><div class="quoteheader"><div class="topslice_quote">Quote from: Section VI A</div></div><blockquote class="bbc_alternate_quote">In order to confirm that an attacker controls a guard node of a hidden service she needs to control at least one more Tor non-exit relay.&nbsp; In the attack, the hidden service is forced to establish rendezvous circuits to the rendezvous point controlled by the attacker.<br />...<br />If all the conditions are satisfied, the attacker decides that her guard node was chosen for the hidden service&#039;s rendezvous circuit and marks the previous node in the circuit as the origin of the hidden service.<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />I skipped over some stuff because I&quot;m tired, but I don&#039;t understand how this is possible, unless you&#039;re running Tor over Tor...?&nbsp; How can a guard ever be chosen as an introduction point for a hidden service -- the guard knows what hidden service it&#039;s a guard for, why in God&#039;s name would it blindly say &quot;sure, I&#039;ll be the rendezvous point for my pal there!&quot;&nbsp; ???<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />The guard node isn&#039;t the intro point. The guard and rendezvous nodes are controlled by the attacker.<br />
			</dd>
			<dt class="postheader">
				Title: <strong>Re: A threat to SR?</strong><br />
				Post by: <strong>banginon1808</strong> on <strong>June 13, 2013, 07:20 am</strong>
			</dt>
			<dd class="postbody">
				ANYONE WHO IS A THREAT TO THE ROAD SHOULD BE KILLED!!&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;PERIOD!<br /><br /><br />its the best way to protect anything
			</dd>
			<dt class="postheader">
				Title: <strong>Re: A threat to SR?</strong><br />
				Post by: <strong>vanilla</strong> on <strong>June 13, 2013, 04:45 pm</strong>
			</dt>
			<dd class="postbody">
				Can&#039;t kill technology, man. The threat is not Mike Hearn for discussing this paper, nor the people that wrote it. There are flaws in the tor/.onion system that&nbsp; hopefully can be addressed. The tech is there regardless if anyone dies or not.
			</dd>
			<dt class="postheader">
				Title: <strong>Re: A threat to SR?</strong><br />
				Post by: <strong>astor</strong> on <strong>June 13, 2013, 04:56 pm</strong>
			</dt>
			<dd class="postbody">
				<div class="quoteheader"><div class="topslice_quote"><a href="http://dkn255hz262ypmii.onion/index.php?topic=171274.msg1231402#msg1231402">Quote from: banginon1808 on June 13, 2013, 07:20 am</a></div></div><blockquote class="bbc_standard_quote">ANYONE WHO IS A THREAT TO THE ROAD SHOULD BE KILLED!!&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;PERIOD!<br /><br /><br />its the best way to protect anything<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />Oh cool. Then we become another violent cartel.<br />
			</dd>
			<dt class="postheader">
				Title: <strong>Re: A threat to SR?</strong><br />
				Post by: <strong>kmfkewm</strong> on <strong>June 13, 2013, 05:02 pm</strong>
			</dt>
			<dd class="postbody">
				<div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">But it can&#039;t be; here&#039;s their description of hidden services:<br /><br /><div class="quoteheader"><div class="topslice_quote">Quote from: Section III</div></div><blockquote class="bbc_alternate_quote">The Tor hidden service architecture:<br />1. Internet service which is available as Tor hidden service;<br />2. Client, which wants to access hidden service;<br />3. Introduction Points, tor relays chosen by the hidden service and which are used for forwarding management cells necessary to connect the Client and the Hidden Service at the Rendezvous point;<br />4. Hidden Service directories (HSDir): Tor relays at which the hidden service publishes its descriptors and which are communicated by clients in order to learn the address of the hidden service&#039;s introduction points;<br />5. Rendezvous point (RP): a Tor relay chosen by the client which is used to forward all the data between the client and the hidden service.<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />That&#039;s... not, quite accurate.&nbsp; It&#039;s leaving out guards, which is what had me thinking it was the protocol before their introduction.&nbsp; But sure, maybe they skimmed over it (or I missed it in my own skimming).&nbsp; But further on, they clearly state:<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />Notice that they left out the entire Tor circuit, I assume because they imagine we have a basic idea of how Tor works, but might not know the intricate details of the hidden service specific algorithms. <br /><br /><br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote"><br /><div class="quoteheader"><div class="topslice_quote">Quote from: Section III</div></div><blockquote class="bbc_alternate_quote">In order to establish a connection to a given hidden service Alice&#039;s OP [note: onion proxy] first builds a rendezvous circuit (step 4).&nbsp; It does this by establishing a circ uit to a randomly chosen Tor relay (OR)&nbsp; [note: onion router], and sending a RELAY_COMMAND_ESTABLISH_RENDEZVOUS cell to that OR.&nbsp; The body of that cell contains a Rendezvous cookie (RC).&nbsp; The rendezvous cookie is an arbitrary 20-byte value, chosen randomly by Alice&#039;s OP... ... ... Alice builds a separate circuit to one of Bob&#039;s chosen introduction points, and sends it a RELAY_COMMAND_INTRODUCE1 cell containing the IP address and the fingerprint of the rendezvous point, the hash of the public key of the hidden service (PK_ID), and the rendezvous cookie (step 5).<br /><br />If the introduction point recognizes PK_ID as the public key of a hidden service it serves, it sends the body of the cell in a new RELAY_COMMAND_INTRODUCE2 cell down the corrsponding circuit (step 6).<br /><br />When Bob&#039;s OP receives the RELAY_COMMAND_INTRODUCE2 cell, it decrypts it using the private key of the corresponding hidden service and extracts the rendezvous point&#039;s nickname as well as the rendezvous cookie.<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />Sure, that&#039;s all well and good... except they STILL haven&#039;t mentioned the fucking guards?&nbsp; It&#039;s like they&#039;re analyzing the network before guards were introduced.&nbsp; Now in fairness they go on to talk about them when detailing their next attack, but there&#039;s weirdness there.&nbsp; Before skipping to VI A though, this line in V A caught my eye:<br /><br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />They probably have not mentioned guards yet because so far they are completely irrelevant to what they are discussing, which is the hidden service protocol. All of the circuits utilized make use of guard nodes, but there isn&#039;t any particular reason for them to point this out yet. <br /><br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote"><div class="quoteheader"><div class="topslice_quote">Quote from: Section V A</div></div><blockquote class="bbc_alternate_quote">Just like any Tor client, an attacker is able to compute the descriptor IDs of the hidden service for any moment in the future and find the fingerprints of expected responsible HS directories.&nbsp; After that she can compute the private/public key pairs so that SHA-1 hash of the public keys would be in-between the descriptor ID and the fingerprint of the first responsible hidden service directory.&nbsp; The attacker then runs Tor relays with the computer public/private key pairs and waits for 25 hours until they obtain the HSDir flag.<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />I thought you could only calculate the descriptor IDs 24 hours in advance, but whatever, skipping that: how can this be possible at all, since even assuming they get to the point of impersonating the HSDirs in question due to the properties of the distributed hash table... they still won&#039;t have the private key for those servers that the 6 (is it 6?) authoritative directories will be checking for, and so will be ignored anyway?<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />They are not impersonating hidden service directories, they are making it so that they are selected as the hidden service directories.&nbsp; <br /><br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">Last bit I actually skimmed; I&#039;m sick of quoting this paper, but again:<br /><br /><div class="quoteheader"><div class="topslice_quote">Quote from: Section VI A</div></div><blockquote class="bbc_alternate_quote">In order to confirm that an attacker controls a guard node of a hidden service she needs to control at least one more Tor non-exit relay.&nbsp; In the attack, the hidden service is forced to establish rendezvous circuits to the rendezvous point controlled by the attacker.<br />...<br />If all the conditions are satisfied, the attacker decides that her guard node was chosen for the hidden service&#039;s rendezvous circuit and marks the previous node in the circuit as the origin of the hidden service.<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />I skipped over some stuff because I&quot;m tired, but I don&#039;t understand how this is possible, unless you&#039;re running Tor over Tor...?&nbsp; How can a guard ever be chosen as an introduction point for a hidden service -- the guard knows what hidden service it&#039;s a guard for, why in God&#039;s name would it blindly say &quot;sure, I&#039;ll be the rendezvous point for my pal there!&quot;&nbsp; ???<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />This is a slight modification to the attack from 2006 that caused guard nodes to be introduced in the first place, essentially they are saying that if they are selected as the hidden services guard node they can deanonymize the hidden service by making it open a circuit to their malicious rendezvous node (which actually isn&#039;t even required, since they can just be the client, which is in itself enough for 1/2 of a timing attack). It doesn&#039;t say anything about introduction points. <br /><br />I still have not read this paper but it seems that they are talking about two different attacks. One attack works to censor the hidden service, and also to position yourself for 1/2 of a timing attack against the hidden service and/or its clients, but the other attack is for enumeration of all hidden service .onion addresses, which can then be used in combination with the 2006 attack to deanonymize some percentage of the identified hidden services. In the 2006 attack they brute force circuits by making the server open new circuits to rendezvous node until they own its entry node, in this attack they &#039;brute enumerate&#039; hidden services in the hopes that they own some of their entry guards. 
			</dd>
			<dt class="postheader">
				Title: <strong>Re: A threat to SR?</strong><br />
				Post by: <strong>banginon1808</strong> on <strong>June 14, 2013, 01:35 am</strong>
			</dt>
			<dd class="postbody">
				<div class="quoteheader"><div class="topslice_quote"><a href="http://dkn255hz262ypmii.onion/index.php?topic=171274.msg1233021#msg1233021">Quote from: astor on June 13, 2013, 04:56 pm</a></div></div><blockquote class="bbc_standard_quote"><div class="quoteheader"><div class="topslice_quote"><a href="http://dkn255hz262ypmii.onion/index.php?topic=171274.msg1231402#msg1231402">Quote from: banginon1808 on June 13, 2013, 07:20 am</a></div></div><blockquote class="bbc_alternate_quote">ANYONE WHO IS A THREAT TO THE ROAD SHOULD BE KILLED!!&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;PERIOD!<br /><br /><br />its the best way to protect anything<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />Oh cool. Then we become another violent cartel.<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />thats exactly what i was thinking!! (cartels) lol<br />they know how to protect a very lucrative business!!! kill anyone who gets in the way!!!
			</dd>
			<dt class="postheader">
				Title: <strong>Re: A threat to SR?</strong><br />
				Post by: <strong>kmfkewm</strong> on <strong>June 14, 2013, 10:27 am</strong>
			</dt>
			<dd class="postbody">
				<div class="quoteheader"><div class="topslice_quote"><a href="http://dkn255hz262ypmii.onion/index.php?topic=171274.msg1232997#msg1232997">Quote from: vanilla on June 13, 2013, 04:45 pm</a></div></div><blockquote class="bbc_standard_quote">Can&#039;t kill technology, man. The threat is not Mike Hearn for discussing this paper, nor the people that wrote it. There are flaws in the tor/.onion system that&nbsp; hopefully can be addressed. The tech is there regardless if anyone dies or not.<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />Not to mention that if you kill all of the people finding attacks on Tor, nobody will work on Tor anymore, because all of the Tor developers also research how to attack Tor. Look at Roger Dingledine, he has his name on a lot of papers that demonstrate attacks against Tor. He is also the lead Tor developer. The person saying we should kill the anonymity researchers has got to be the stupidest fucking person in the world, he should get a prize or something. 
			</dd>
			<dt class="postheader">
				Title: <strong>Re: A threat to SR?</strong><br />
				Post by: <strong>White 0ut</strong> on <strong>June 14, 2013, 10:34 am</strong>
			</dt>
			<dd class="postbody">
				sub&#039;d
			</dd>
			<dt class="postheader">
				Title: <strong>Re: A threat to SR?</strong><br />
				Post by: <strong>colorblack</strong> on <strong>June 14, 2013, 10:42 am</strong>
			</dt>
			<dd class="postbody">
				DPR does not take security lightly.. and quite frankly, he is actually EXTREMELY intelligent. I know this for a fact. He knows his shit.<br />Good to be vigilant at all times of course, but only &quot;threats&quot; to SR are at time going to be the human element(s), definetly not the tech/infrastructural.<br /><br />i.e. vendors dealing IRL/customers blabbing about SR to idiot friends who log in via clearnet, etc etc. Those kinds of &quot;threats&quot; will always be reason to be vigilant. As far as a technically.. I wouldn&#039;t worry too much about that. The Pirate knows what he&#039;s doing.&nbsp; 8)<br />
			</dd>
			<dt class="postheader">
				Title: <strong>Re: A threat to SR?</strong><br />
				Post by: <strong>jthev2005</strong> on <strong>June 14, 2013, 08:03 pm</strong>
			</dt>
			<dd class="postbody">
				<div class="quoteheader"><div class="topslice_quote"><a href="http://dkn255hz262ypmii.onion/index.php?topic=171274.msg1236290#msg1236290">Quote from: kmfkewm on June 14, 2013, 10:27 am</a></div></div><blockquote class="bbc_standard_quote"><div class="quoteheader"><div class="topslice_quote"><a href="http://dkn255hz262ypmii.onion/index.php?topic=171274.msg1232997#msg1232997">Quote from: vanilla on June 13, 2013, 04:45 pm</a></div></div><blockquote class="bbc_alternate_quote">Can&#039;t kill technology, man. The threat is not Mike Hearn for discussing this paper, nor the people that wrote it. There are flaws in the tor/.onion system that&nbsp; hopefully can be addressed. The tech is there regardless if anyone dies or not.<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />Not to mention that if you kill all of the people finding attacks on Tor, nobody will work on Tor anymore, because all of the Tor developers also research how to attack Tor. Look at Roger Dingledine, he has his name on a lot of papers that demonstrate attacks against Tor. He is also the lead Tor developer. The person saying we should kill the anonymity researchers has got to be the stupidest fucking person in the world, he should get a prize or something.<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />+10. In fact the developers are doing a huge service to DPR and others who run similar illicit hidden sites by pointing out potential vulnerabilities before they are exploited by malevolent folks. I have faith that the Pirate and team have an exceptional security system in place and continually stay up to date on information security developments.
			</dd>
			<dt class="postheader">
				Title: <strong>Re: A threat to SR?</strong><br />
				Post by: <strong>Gengar17</strong> on <strong>June 15, 2013, 11:54 pm</strong>
			</dt>
			<dd class="postbody">
				Great info, subbed the shit out of this thread
			</dd>
			<dt class="postheader">
				Title: <strong>Re: A threat to SR?</strong><br />
				Post by: <strong>astor</strong> on <strong>June 16, 2013, 12:01 am</strong>
			</dt>
			<dd class="postbody">
				<div class="quoteheader"><div class="topslice_quote"><a href="http://dkn255hz262ypmii.onion/index.php?topic=171274.msg1236290#msg1236290">Quote from: kmfkewm on June 14, 2013, 10:27 am</a></div></div><blockquote class="bbc_standard_quote">Not to mention that if you kill all of the people finding attacks on Tor, nobody will work on Tor anymore, because all of the Tor developers also research how to attack Tor. Look at Roger Dingledine, he has his name on a lot of papers that demonstrate attacks against Tor. He is also the lead Tor developer. The person saying we should kill the anonymity researchers has got to be the stupidest fucking person in the world, he should get a prize or something.<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />Then we can live in the ignorant bliss that our network is secure. That&#039;s what I tell the I2P folks when they mention that there are few known attacks on it. That only proves that few people are looking at it.<br />
			</dd>
			<dt class="postheader">
				Title: <strong>Re: A threat to SR?</strong><br />
				Post by: <strong>astor</strong> on <strong>June 16, 2013, 12:04 am</strong>
			</dt>
			<dd class="postbody">
				<div class="quoteheader"><div class="topslice_quote"><a href="http://dkn255hz262ypmii.onion/index.php?topic=171274.msg1237753#msg1237753">Quote from: jthev2005 on June 14, 2013, 08:03 pm</a></div></div><blockquote class="bbc_standard_quote">+10. In fact the developers are doing a huge service to DPR and others who run similar illicit hidden sites by pointing out potential vulnerabilities before they are exploited by malevolent folks. <br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />Yep. It&#039;s better that an honest researcher proves these attacks work and makes them publicly known (in fact, the Tor devs knew about this months before it was made public) than a malicious person discovers an attack and keeps it to himself.<br />
			</dd>
			<dt class="postheader">
				Title: <strong>Re: A threat to SR?</strong><br />
				Post by: <strong>smokecrack</strong> on <strong>June 16, 2013, 12:12 am</strong>
			</dt>
			<dd class="postbody">
				<div class="quoteheader"><div class="topslice_quote"><a href="http://dkn255hz262ypmii.onion/index.php?topic=171274.msg1241798#msg1241798">Quote from: astor on June 16, 2013, 12:04 am</a></div></div><blockquote class="bbc_standard_quote"><div class="quoteheader"><div class="topslice_quote"><a href="http://dkn255hz262ypmii.onion/index.php?topic=171274.msg1237753#msg1237753">Quote from: jthev2005 on June 14, 2013, 08:03 pm</a></div></div><blockquote class="bbc_alternate_quote">+10. In fact the developers are doing a huge service to DPR and others who run similar illicit hidden sites by pointing out potential vulnerabilities before they are exploited by malevolent folks. <br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />Yep. It&#039;s better that an honest researcher proves these attacks work and makes them publicly known (in fact, the Tor devs knew about this months before it was made public) than a malicious person discovers an attack and keeps it to himself.<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />because men are superior 8)
			</dd>
			<dt class="postheader">
				Title: <strong>Re: A threat to SR?</strong><br />
				Post by: <strong>kmfkewm</strong> on <strong>June 16, 2013, 08:38 am</strong>
			</dt>
			<dd class="postbody">
				<div class="quoteheader"><div class="topslice_quote"><a href="http://dkn255hz262ypmii.onion/index.php?topic=171274.msg1241798#msg1241798">Quote from: astor on June 16, 2013, 12:04 am</a></div></div><blockquote class="bbc_standard_quote"><div class="quoteheader"><div class="topslice_quote"><a href="http://dkn255hz262ypmii.onion/index.php?topic=171274.msg1237753#msg1237753">Quote from: jthev2005 on June 14, 2013, 08:03 pm</a></div></div><blockquote class="bbc_alternate_quote">+10. In fact the developers are doing a huge service to DPR and others who run similar illicit hidden sites by pointing out potential vulnerabilities before they are exploited by malevolent folks. <br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />Yep. It&#039;s better that an honest researcher proves these attacks work and makes them publicly known (in fact, the Tor devs knew about this months before it was made public) than a malicious person discovers an attack and keeps it to himself.<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />Hell the Tor devs probably knew about this from the moment they implemented hidden services. It is obvious to anybody who knows how hidden services work. 
			</dd>
			<dt class="postheader">
				Title: <strong>Re: A threat to SR?</strong><br />
				Post by: <strong>SelfSovereignty</strong> on <strong>June 16, 2013, 11:50 pm</strong>
			</dt>
			<dd class="postbody">
				<div class="quoteheader"><div class="topslice_quote"><a href="http://dkn255hz262ypmii.onion/index.php?topic=171274.msg1229124#msg1229124">Quote from: astor on June 12, 2013, 09:07 pm</a></div></div><blockquote class="bbc_standard_quote"><div class="quoteheader"><div class="topslice_quote"><a href="http://dkn255hz262ypmii.onion/index.php?topic=171274.msg1226315#msg1226315">Quote from: SelfSovereignty on June 12, 2013, 07:42 am</a></div></div><blockquote class="bbc_alternate_quote">but whatever, skipping that: how can this be possible at all, since even assuming they get to the point of impersonating the HSDirs in question due to the properties of the distributed hash table... they still won&#039;t have the private key for those servers that the 6 (is it 6?) authoritative directories will be checking for, and so will be ignored anyway?<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />I&#039;m not sure what you&#039;re asking here. <br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />Frankly, neither am I anymore... I think I had assumed that there was an additional check in place involving an identity key.<br /><br /><br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote"><div class="quoteheader"><div class="topslice_quote"><a href="http://dkn255hz262ypmii.onion/index.php?topic=171274.msg1226315#msg1226315">Quote from: SelfSovereignty on June 12, 2013, 07:42 am</a></div></div><blockquote class="bbc_alternate_quote"><div class="quoteheader"><div class="topslice_quote">Quote from: Section VI A</div></div><blockquote class="bbc_standard_quote">In order to confirm that an attacker controls a guard node of a hidden service she needs to control at least one more Tor non-exit relay.&nbsp; In the attack, the hidden service is forced to establish rendezvous circuits to the rendezvous point controlled by the attacker.<br />...<br />If all the conditions are satisfied, the attacker decides that her guard node was chosen for the hidden service&#039;s rendezvous circuit and marks the previous node in the circuit as the origin of the hidden service.<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />I skipped over some stuff because I&quot;m tired, but I don&#039;t understand how this is possible, unless you&#039;re running Tor over Tor...?&nbsp; How can a guard ever be chosen as an introduction point for a hidden service -- the guard knows what hidden service it&#039;s a guard for, why in God&#039;s name would it blindly say &quot;sure, I&#039;ll be the rendezvous point for my pal there!&quot;&nbsp; ???<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />The guard node isn&#039;t the intro point. The guard and rendezvous nodes are controlled by the attacker.<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />Yeah, I... yeah.&nbsp; I shouldn&#039;t try making technical posts to things I&#039;ve only read on day 2 or 3 awake; what can I say, it&#039;s a hard lesson to remember&nbsp; :P
			</dd>
		</dl>
		<div id="footer" class="smalltext">
			
			<span class="smalltext" style="display: inline; visibility: visible; font-family: Verdana, Arial, sans-serif;"><a href="http://dkn255hz262ypmii.onion/index.php?action=credits" title="Simple Machines Forum" target="_blank" class="new_win">SMF 2.0.5</a> |
 <a href="http://www.simplemachines.org/about/smf/license.php" title="License" target="_blank" class="new_win">SMF &copy; 2013</a>, <a href="http://www.simplemachines.org" title="Simple Machines" target="_blank" class="new_win">Simple Machines</a>
			</span>
		</div>
	</body>
</html>