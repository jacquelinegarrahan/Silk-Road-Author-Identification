<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<meta name="robots" content="noindex" />
		<link rel="canonical" href="http://dkn255hz262ypmii.onion/index.php?topic=48902.0" />
		<title>Print Page - linux: decrypt a file in memory</title>
		<style type="text/css">
			body, a
			{
				color: #000;
				background: #fff;
			}
			body, td, .normaltext
			{
				font-family: Verdana, arial, helvetica, serif;
				font-size: small;
			}
			h1#title
			{
				font-size: large;
				font-weight: bold;
			}
			h2#linktree
			{
				margin: 1em 0 2.5em 0;
				font-size: small;
				font-weight: bold;
			}
			dl#posts
			{
				width: 90%;
				margin: 0;
				padding: 0;
				list-style: none;
			}
			dt.postheader
			{
				border: solid #000;
				border-width: 1px 0;
				padding: 4px 0;
			}
			dd.postbody
			{
				margin: 1em 0 2em 2em;
			}
			table
			{
				empty-cells: show;
			}
			blockquote, code
			{
				border: 1px solid #000;
				margin: 3px;
				padding: 1px;
				display: block;
			}
			code
			{
				font: x-small monospace;
			}
			blockquote
			{
				font-size: x-small;
			}
			.smalltext, .quoteheader, .codeheader
			{
				font-size: x-small;
			}
			.largetext
			{
				font-size: large;
			}
			.centertext
			{
				text-align: center;
			}
			hr
			{
				height: 1px;
				border: 0;
				color: black;
				background-color: black;
			}
		</style>
	</head>
	<body>
		<h1 id="title">Silk Road forums</h1>
		<h2 id="linktree">Discussion => Security => Topic started by: hootsmon on October 08, 2012, 07:19 am</h2>
		<dl id="posts">
			<dt class="postheader">
				Title: <strong>linux: decrypt a file in memory</strong><br />
				Post by: <strong>hootsmon</strong> on <strong>October 08, 2012, 07:19 am</strong>
			</dt>
			<dd class="postbody">
				so i&#039;ve got the basics with gpg down, using gpa I have encrypted a file, and I can decrypt it, but i end up with a plaintext version of the file on the file system. I want to be able to decrypt the file into memory, or the clipboard. That way (hopefully) the plaintext never hits the disk, and I don&#039;t have to worry about shredding. any ideas?
			</dd>
			<dt class="postheader">
				Title: <strong>Re: linux: decrypt a file in memory</strong><br />
				Post by: <strong>Nightcrawler</strong> on <strong>October 08, 2012, 09:30 am</strong>
			</dt>
			<dd class="postbody">
				<div class="quoteheader"><div class="topslice_quote"><a href="http://dkn255hz262ypmii.onion/index.php?topic=48902.msg508255#msg508255">Quote from: hootsmon on October 08, 2012, 07:19 am</a></div></div><blockquote class="bbc_standard_quote">so i&#039;ve got the basics with gpg down, using gpa I have encrypted a file, and I can decrypt it, but i end up with a plaintext version of the file on the file system. I want to be able to decrypt the file into memory, or the clipboard. That way (hopefully) the plaintext never hits the disk, and I don&#039;t have to worry about shredding. any ideas?<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />gpa, like most other gpg frontends, uses the clipboard to both encrypt and decrypt. Your message is never written to disk unless you save it to a file. <br /><br />If you&#039;re worried about the swapfile, just turn it off. Just su to root, and use the command swapoff -a <br /><br />If you want to turn swap on again, you can re-enable it with the command: swapon -a <br /><br />Also, you can encrypt your swap file with a key that changes every time you reboot, but those instructions are beyond the scope of what I can cover here. <br /><br />
			</dd>
			<dt class="postheader">
				Title: <strong>Re: linux: decrypt a file in memory</strong><br />
				Post by: <strong>kmfkewm</strong> on <strong>October 08, 2012, 09:51 am</strong>
			</dt>
			<dd class="postbody">
				The way you phrase the question makes me wonder if you are not quite using GPG properly (ie: encrypting files that contain messages? why not just encrypt the message itself). There is no reason to save the plaintext, gpg --d , paste ciphertext, enter password, it displays the plaintext and doesn&#039;t save it anywhere. If you are worried about swap your best option is to just encrypt it with a random key. 
			</dd>
			<dt class="postheader">
				Title: <strong>Re: linux: decrypt a file in memory</strong><br />
				Post by: <strong>kmfkewm</strong> on <strong>October 08, 2012, 09:55 am</strong>
			</dt>
			<dd class="postbody">
				But it is possible your question is not indicative of not properly using GPG, for example you could decrypt an encrypted .pdf and not want to save it to disk. I imagine&nbsp; you can output the decryption of a .pdf onto your terminal , but it will not be very helpful. In such a scenario one solution might be to load the ciphertext in a virtual machine and decrypt it there. 
			</dd>
			<dt class="postheader">
				Title: <strong>Re: linux: decrypt a file in memory</strong><br />
				Post by: <strong>hootsmon</strong> on <strong>October 08, 2012, 10:05 am</strong>
			</dt>
			<dd class="postbody">
				thanks guys.<br /><br />I hope you don&#039;t mind no quotes, too lazy atm.<br /><br />The file is on the disk, and encrypted. It needs to stay on the disk because I need its contents.<br />using gpa, there doesn&#039;t seem to be a way to decrypt it other than using the file manager and saving it in the clear to a file.<br /><br />So one option given, if I&#039;m remembering right, is to not use gpa and to use gpg on the command line, I can live with that.<br /><br />for what it&#039;s worth my disks are already encrypted including swap. this is for an extra layer.<br /><br /><br />
			</dd>
			<dt class="postheader">
				Title: <strong>Re: linux: decrypt a file in memory</strong><br />
				Post by: <strong>Nightcrawler</strong> on <strong>October 08, 2012, 10:34 am</strong>
			</dt>
			<dd class="postbody">
				<div class="quoteheader"><div class="topslice_quote"><a href="http://dkn255hz262ypmii.onion/index.php?topic=48902.msg508374#msg508374">Quote from: hootsmon on October 08, 2012, 10:05 am</a></div></div><blockquote class="bbc_standard_quote">thanks guys.<br /><br />I hope you don&#039;t mind no quotes, too lazy atm.<br /><br />The file is on the disk, and encrypted. It needs to stay on the disk because I need its contents.<br />using gpa, there doesn&#039;t seem to be a way to decrypt it other than using the file manager and saving it in the clear to a file.<br /><br />So one option given, if I&#039;m remembering right, is to not use gpa and to use gpg on the command line, I can live with that.<br /><br />for what it&#039;s worth my disks are already encrypted including swap. this is for an extra layer.<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />I don&#039;t get the problem. With gpa open, you click the clipboard icon. In clipboard, you use File, Open and then open your encrypted file, which will show up encrypted in the clipboard pane. I&#039;m presuming that the file is saved or stored as ascii armored? If not, maybe that is the problem. <br /><br />Use File, Decrypt in the clipboard pane to decrypt the file. The decrypted file is only on the clipboard. Nothing is saved to a file. <br /><br /><br /><br />
			</dd>
			<dt class="postheader">
				Title: <strong>Re: linux: decrypt a file in memory</strong><br />
				Post by: <strong>kmfkewm</strong> on <strong>October 08, 2012, 10:42 am</strong>
			</dt>
			<dd class="postbody">
				I also am not understanding the problem (if the solution is not &#039;do it in a virtual machine&#039;). 
			</dd>
			<dt class="postheader">
				Title: <strong>Re: linux: decrypt a file in memory</strong><br />
				Post by: <strong>pine</strong> on <strong>October 08, 2012, 11:14 am</strong>
			</dt>
			<dd class="postbody">
				kmfkewm/Nightcrawler, I think he/she is asking this:<br /><br />A PGP message is usually only a couple of kilobytes in size at the most. Therefore you can encrypt and decrypt PGP messages in main memory or RAM with ease. Once you switch the machine off, about five or ten minutes later the data is completely irrecoverable, which is a nice security feature.<br /><br />However you are talking about PGP encrypted *files* if I am not mistaken. Most people will have about 4 GB - 16 GB at the most worth of RAM, with about half of that being used by the OS and other associated process/services. So you&#039;ll have about 50% - 75% of your RAM to use in practice for other applications, including your desire to decrypt to RAM.<br /><br />So you are asking if you can decrypt a file (presumably quite a bit less than the size of your main memory or RAM), to this store, instead of to the hard disk.<br /><br />I think the answer is yes, you can, so long as the file is sufficiently small in size, but I don&#039;t know the correct terminal command, I&#039;ll check back later with some info.
			</dd>
			<dt class="postheader">
				Title: <strong>Re: linux: decrypt a file in memory</strong><br />
				Post by: <strong>hootsmon</strong> on <strong>October 08, 2012, 11:38 am</strong>
			</dt>
			<dd class="postbody">
				<br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">With gpa open, you click the clipboard icon. In clipboard, you use File, Open and then open your encrypted file, which will show up encrypted in the clipboard pane</blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />Obviously I didn&#039;t read the instructions, and this, while may seem basic to you, didn&#039;t occur to me, and I didn&#039;t discover it. My file isn&#039;t armored, but I will do that. Thanks again. sorry to perplex you all and I appreciate your perseverance and patience<br /><br />
			</dd>
			<dt class="postheader">
				Title: <strong>Re: linux: decrypt a file in memory</strong><br />
				Post by: <strong>kmfkewm</strong> on <strong>October 08, 2012, 12:44 pm</strong>
			</dt>
			<dd class="postbody">
				you can decrypt an encrypted file and have it display on terminal with gpg -d and it just treats it as any other ciphertext, the output will not be very helpful in 99.99% of cases though, your shell doesn&#039;t know what to do with a pdf file it just displays the raw bytes. To get it so that you can view it with a pdf reader, I don&#039;t know of a solution other than to save the output as a .pdf on the disk and then open it with the pdf reader. I tried to pipe the decrypted output to a reader from my terminal in the following way and it failed to work:<br /><br />gpg -d test.pdf.gpg | evince <br /><br />a solution would therefor be to put the ciphertext in a virtual machine, then decrypt it and save it as a .pdf file, then open that file. You can do all of this from memory with a virtual machine, but without a virtual machine I don&#039;t know how else you would load the plaintext as a .pdf file with your reader without having to write it to the HD, since the file is saved as a .pdf only in the virtual machine which you can configure to be entirely in the hosts RAM. 
			</dd>
			<dt class="postheader">
				Title: <strong>Re: linux: decrypt a file in memory</strong><br />
				Post by: <strong>CoolGrey</strong> on <strong>October 08, 2012, 10:32 pm</strong>
			</dt>
			<dd class="postbody">
				If you decrypt a PGP message, the decrypted plaintext will be displayed in terminal, and - I assume - only stored in the RAM.<br /><br />If you decrypt an encrypted file, like a pdf, the decrypted file will get stored on the hard drive, in the same directory as the original encrypted text. If you want to securely delete it, you can use the shred command.<br /><br />If you use full disk encryption (which I highly recommend), this whole problem is non-existent. 
			</dd>
			<dt class="postheader">
				Title: <strong>Re: linux: decrypt a file in memory</strong><br />
				Post by: <strong>hootsmon</strong> on <strong>October 09, 2012, 02:30 am</strong>
			</dt>
			<dd class="postbody">
				<div class="quoteheader"><div class="topslice_quote"><a href="http://dkn255hz262ypmii.onion/index.php?topic=48902.msg509078#msg509078">Quote from: CoolGrey on October 08, 2012, 10:32 pm</a></div></div><blockquote class="bbc_standard_quote">If you use full disk encryption (which I highly recommend), this whole problem is non-existent.<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />incorrect. it&#039;s only non existent when the computer is off, while it&#039;s on and in use, it&#039;s decrypted. <br /><br />
			</dd>
			<dt class="postheader">
				Title: <strong>Re: linux: decrypt a file in memory</strong><br />
				Post by: <strong>CoolGrey</strong> on <strong>October 09, 2012, 08:56 pm</strong>
			</dt>
			<dd class="postbody">
				<div class="quoteheader"><div class="topslice_quote"><a href="http://dkn255hz262ypmii.onion/index.php?topic=48902.msg509565#msg509565">Quote from: hootsmon on October 09, 2012, 02:30 am</a></div></div><blockquote class="bbc_standard_quote"><div class="quoteheader"><div class="topslice_quote"><a href="http://dkn255hz262ypmii.onion/index.php?topic=48902.msg509078#msg509078">Quote from: CoolGrey on October 08, 2012, 10:32 pm</a></div></div><blockquote class="bbc_alternate_quote">If you use full disk encryption (which I highly recommend), this whole problem is non-existent.<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />incorrect. it&#039;s only non existent when the computer is off, while it&#039;s on and in use, it&#039;s decrypted.<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div>Fair enough, I see your point. <br /><br />I guess the bottom line is, if somebody gets hold of your computer while the encrypted disk is mounted, you are caught dead in the water.<br /><br />Maybe, if you&#039;re a skilled programmer, you could reprogram gpg in such a way that it automatically securely erases any file saved to the hard drive after reading. Until that&#039;s possible, you&#039;ll have to manually shred it.<br />
			</dd>
			<dt class="postheader">
				Title: <strong>Re: linux: decrypt a file in memory</strong><br />
				Post by: <strong>gilmour</strong> on <strong>October 09, 2012, 09:18 pm</strong>
			</dt>
			<dd class="postbody">
				I use ramfs for this purpose.&nbsp; Let&#039;s say that you want to use /ramfs as a mount point.&nbsp; The syntax would be something like: mount -t ramfs /ramfs /ramfs<br /><br />Memory pages that back ramfs contents are guaranteed never to be swapped out (unlike tmpfs), so I find it ideal for temporarily decrypting small files I wish to never lie on my HDD.<br /><br />I don&#039;t recommend relying on the shred command, especially on journaling file systems like ext3/4, XFS, or JFS -- it&#039;s not secure.
			</dd>
			<dt class="postheader">
				Title: <strong>Re: linux: decrypt a file in memory</strong><br />
				Post by: <strong>pine</strong> on <strong>October 10, 2012, 04:13 pm</strong>
			</dt>
			<dd class="postbody">
				The problem with FDE, is that the judge/jury are seriously unlikely to believe you&#039;ve &quot;lost&quot; your passphrase if they have evidence you&#039;ve been logging in periodically and there is a record of this.<br /><br />Every tool has a place, and also limitations. Things like FDE should be treated for what they are, a last resort. Like the forensic scientist doing a AMA over in the other thread is saying, the best thing is to have a small footprint in the first place.
			</dd>
			<dt class="postheader">
				Title: <strong>Re: linux: decrypt a file in memory</strong><br />
				Post by: <strong>kmfkewm</strong> on <strong>October 10, 2012, 04:49 pm</strong>
			</dt>
			<dd class="postbody">
				In the USA it doesn&#039;t matter if you have lost your passphrase or not, probably. You can just plead the fifth. There have been a few CP cases thrown out by the judge because all the prosecution had was an IP address. The accused refuse to decrypt their drive, the government experts have to admit that an IP address is not solid proof, the judge throws the case out. 
			</dd>
			<dt class="postheader">
				Title: <strong>Re: linux: decrypt a file in memory</strong><br />
				Post by: <strong>pine</strong> on <strong>October 10, 2012, 05:46 pm</strong>
			</dt>
			<dd class="postbody">
				<div class="quoteheader"><div class="topslice_quote"><a href="http://dkn255hz262ypmii.onion/index.php?topic=48902.msg514533#msg514533">Quote from: kmfkewm on October 10, 2012, 04:49 pm</a></div></div><blockquote class="bbc_standard_quote">In the USA it doesn&#039;t matter if you have lost your passphrase or not, probably. You can just plead the fifth. There have been a few CP cases thrown out by the judge because all the prosecution had was an IP address. The accused refuse to decrypt their drive, the government experts have to admit that an IP address is not solid proof, the judge throws the case out.<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />If everybody did FDE it&#039;d be no big deal. But almost nobody does. So using FDE is always suspect. Remember how you were saying intelligence info != evidence? ;)<br /><br />To my mind it is preferable that you have no physical footprint whatsoever. No usb keys, no portable media. It may be possible just to have a thin client setup so there is no local storage at all.&nbsp; You have your computer (like the Pi) magnetically attached to a drainpipe across the city half way up some skyscaper, and you login to that remotely. I&#039;m pretty sure this is possible. <br /><br />So, you can do this with the regular net, where you have rented space on machine in some server farm across the globe in another jurisdiction. The practical problem there is almost nobody has enough bandwidth to do that without serious frustration unless you&#039;re from Japan or South Korea or similar. <br /><br />So, if you have some specialized network hardware capable of delivering &gt; 50 - 100 Mbps from A to B for a range of several kilometers, then this is an ideal way to make busting you extremely complicated. They can have your password, no problem. But they only have a dumb terminal, no data unless they&#039;ve tapped your station. Actually best of all, you&#039;d have all your &quot;real&quot; hardware lying about for them to investigate, none of which you use for SR related business.<br /><br />Now I&#039;m sure there&#039;s holes in such an idea, but the principal seems sound. Thoughts?<br />
			</dd>
		</dl>
		<div id="footer" class="smalltext">
			
			<span class="smalltext" style="display: inline; visibility: visible; font-family: Verdana, Arial, sans-serif;"><a href="http://dkn255hz262ypmii.onion/index.php?action=credits" title="Simple Machines Forum" target="_blank" class="new_win">SMF 2.0.5</a> |
 <a href="http://www.simplemachines.org/about/smf/license.php" title="License" target="_blank" class="new_win">SMF &copy; 2013</a>, <a href="http://www.simplemachines.org" title="Simple Machines" target="_blank" class="new_win">Simple Machines</a>
			</span>
		</div>
	</body>
</html>