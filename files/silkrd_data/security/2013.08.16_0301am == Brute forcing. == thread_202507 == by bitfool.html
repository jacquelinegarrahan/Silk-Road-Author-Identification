<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<meta name="robots" content="noindex" />
		<link rel="canonical" href="http://dkn255hz262ypmii.onion/index.php?topic=202507.0" />
		<title>Print Page - Brute forcing.</title>
		<style type="text/css">
			body, a
			{
				color: #000;
				background: #fff;
			}
			body, td, .normaltext
			{
				font-family: Verdana, arial, helvetica, serif;
				font-size: small;
			}
			h1#title
			{
				font-size: large;
				font-weight: bold;
			}
			h2#linktree
			{
				margin: 1em 0 2.5em 0;
				font-size: small;
				font-weight: bold;
			}
			dl#posts
			{
				width: 90%;
				margin: 0;
				padding: 0;
				list-style: none;
			}
			dt.postheader
			{
				border: solid #000;
				border-width: 1px 0;
				padding: 4px 0;
			}
			dd.postbody
			{
				margin: 1em 0 2em 2em;
			}
			table
			{
				empty-cells: show;
			}
			blockquote, code
			{
				border: 1px solid #000;
				margin: 3px;
				padding: 1px;
				display: block;
			}
			code
			{
				font: x-small monospace;
			}
			blockquote
			{
				font-size: x-small;
			}
			.smalltext, .quoteheader, .codeheader
			{
				font-size: x-small;
			}
			.largetext
			{
				font-size: large;
			}
			.centertext
			{
				text-align: center;
			}
			hr
			{
				height: 1px;
				border: 0;
				color: black;
				background-color: black;
			}
		</style>
	</head>
	<body>
		<h1 id="title">Silk Road forums</h1>
		<h2 id="linktree">Discussion => Security => Topic started by: bitfool on August 16, 2013, 03:01 am</h2>
		<dl id="posts">
			<dt class="postheader">
				Title: <strong>Brute forcing.</strong><br />
				Post by: <strong>bitfool</strong> on <strong>August 16, 2013, 03:01 am</strong>
			</dt>
			<dd class="postbody">
				How many times per second can an AES key from something like truecrypt be tried? <br /><br />(I understand that the question depends on what hardware is being used, so you can give a rough description of it)<br /><br />
			</dd>
			<dt class="postheader">
				Title: <strong>Re: Brute forcing.</strong><br />
				Post by: <strong>jampants</strong> on <strong>August 16, 2013, 03:15 am</strong>
			</dt>
			<dd class="postbody">
				Look up supercomputer&#039;s like the Jaguar, that will tell you want you want to hear.
			</dd>
			<dt class="postheader">
				Title: <strong>Re: Brute forcing.</strong><br />
				Post by: <strong>ECC_ROT13</strong> on <strong>August 16, 2013, 03:20 am</strong>
			</dt>
			<dd class="postbody">
				They wouldn&#039;t be cracking the AES key, they&#039;d be cracking the passphrase protecting it in most cases.<br /><br />And it&#039;s a huge number of attempts per second if they&#039;re doing it right.&nbsp; &nbsp;GPU&#039;s have dramatically sped up password cracking, and thanks to a few billion user passwords being leaked on the Internet, dictionary attacks have a really good idea of how people structure passwords.<br /><br />That&#039;s why lots of folks here say things like &quot;at least 30 characters, preferably more&quot;.
			</dd>
			<dt class="postheader">
				Title: <strong>Re: Brute forcing.</strong><br />
				Post by: <strong>bitfool</strong> on <strong>August 16, 2013, 03:30 am</strong>
			</dt>
			<dd class="postbody">
				<div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">They wouldn&#039;t be cracking the AES key, they&#039;d be cracking the passphrase protecting it in most cases.</blockquote><div class="quotefooter"><div class="botslice_quote"></div></div>Well, in that case, how many passphrases per second can be tried?<br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">And it&#039;s a huge number of attempts per second if they&#039;re doing it right.</blockquote><div class="quotefooter"><div class="botslice_quote"></div></div>So, how many attempts per second? <br /><br />
			</dd>
			<dt class="postheader">
				Title: <strong>Re: Brute forcing.</strong><br />
				Post by: <strong>Tessellated</strong> on <strong>August 16, 2013, 03:34 am</strong>
			</dt>
			<dd class="postbody">
				Using the Amazon computer cloud they could guess millions of passwords per second.
			</dd>
			<dt class="postheader">
				Title: <strong>Re: Brute forcing.</strong><br />
				Post by: <strong>bitfool</strong> on <strong>August 16, 2013, 04:07 am</strong>
			</dt>
			<dd class="postbody">
				I&#039;d expect people trying to crack TC or a similar system to use FPGAs or GPUs or some kind of custom hardware, which rules out &quot;amazon computer cloud&quot; <br /><br />edit : <br />looks like amazon&#039;s &quot;cloud&quot; has GPUs in it. Still, the original question hasn&#039;t been answered.<br /><br />
			</dd>
			<dt class="postheader">
				Title: <strong>Re: Brute forcing.</strong><br />
				Post by: <strong>awhiteknight</strong> on <strong>August 16, 2013, 04:13 am</strong>
			</dt>
			<dd class="postbody">
				Looks like Trucrack does about 230,000 attempts per minute on a top-end graphics card (GTX Titan) so I think about a million per minute is reasonable for a hacker with a large botnet of machines with good GPUs.<br /><br />If your adversary is the NSA and has, say $1M of ASICs pointed at the problem, assuming you get 1000x as much power as a high-end graphics card for about $20k then call it about 150M/sec.
			</dd>
			<dt class="postheader">
				Title: <strong>Re: Brute forcing.</strong><br />
				Post by: <strong>bitfool</strong> on <strong>August 16, 2013, 04:26 am</strong>
			</dt>
			<dd class="postbody">
				A year is 60x60x24x365 seconds. We can use 2^25 to represent a year (that&#039;s actually ~388 days in seconds)<br /><br />Assume&nbsp; machine W does something like a million tries per second, that is 2^20.<br /><br />So&nbsp; machine W can try 2^25 x 2^20 --&gt; 2^45 keys per year.<br /><br />If the keyspace is 2^60 then it would take 2^(60-45) --&gt; 2^15 --&gt; 32768 years to find a key.<br /><br />Did I get the math right?<br /><br />
			</dd>
			<dt class="postheader">
				Title: <strong>Re: Brute forcing.</strong><br />
				Post by: <strong>Nightcrawler</strong> on <strong>August 16, 2013, 08:11 am</strong>
			</dt>
			<dd class="postbody">
				<div class="quoteheader"><div class="topslice_quote"><a href="http://dkn255hz262ypmii.onion/index.php?topic=202507.msg1456016#msg1456016">Quote from: bitfool on August 16, 2013, 04:26 am</a></div></div><blockquote class="bbc_standard_quote">A year is 60x60x24x365 seconds. We can use 2^25 to represent a year (that&#039;s actually ~388 days in seconds)<br /><br />Assume&nbsp; machine W does something like a million tries per second, that is 2^20.<br /><br />So&nbsp; machine W can try 2^25 x 2^20 --&gt; 2^45 keys per year.<br /><br />If the keyspace is 2^60 then it would take 2^(60-45) --&gt; 2^15 --&gt; 32768 years to find a key.<br /><br />Did I get the math right?<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />Pretty much.&nbsp; It is a general rule of thumb that keys are usually found via searching approaximatley half of the keyspace. That said, 2^60, however is not a very large keyspace. Even in the mid-90s it was recommended that keys be used that would provide at least 90 bits of entropy, versus 60 in your scenario. <br /><br />You have to realize that brute-forcing is the absolute LAST option that anyone will use, because it is so often a waste of time. The authorities will almost never use brute-force as a option, unless all other methods have failed first.&nbsp; The basic problem boils down to this: people are lazy; people will all too often, not use proper methods because they are &quot;too hard to remember&quot;. <br /><br />The authorities know this, and indeed, count on it.&nbsp; People choose passphrases that are meaningful to them, which makes them more predictable (i.e less random). <br /><br />If you want a good system, try Diceware: http://www.diceware.com/ <br /><br />Diceware uses a specialized dictionary, the entries for which are paired with dice rolls. The dice rolls are a truly random physical process, thus it is impossible to predict which words were chosen, much less in what order. 10 Diceware words will yield a passphrase with 129 bits of entropy -- even given the fact that keys are usually found in only searching half the keyspace, that means that a potential attacker would have to go through 128-bits of the keyspace to potentially find what they&#039;re looking for. <br /><br />Nightcrawler<br />4096R/BBF7433B 2012-09-22 Nightcrawler &lt;Nightcrawler@SR&gt;<br />PGP Key: http://pgp.mit.edu:11371/pks/lookup?op=get&amp;search=0xB8F1D88EBBF7433B&nbsp; &nbsp; &nbsp; (MIT clearnet keyserver)<br />PGP Key: https://keys.indymedia.org/pks/lookup?op=get&amp;search=0xB8F1D88EBBF7433B&nbsp; &nbsp; (IndyMedia https: clearnet keyserver)<br />PGP Key: http://qtt2yl5jocgrk7nu.onion/pks/lookup?op=get&amp;search=0xB8F1D88EBBF7433B (IndyMedia .onion keyserver)<br />PGP Key: http://dkn255hz262ypmii.onion/index.php?topic=174.msg633090#msg633090&nbsp; &nbsp; &nbsp;(Silk Road Forums PGP Key Link)<br />PGP Key Fingerprint = 83F8 CAF8 7B73 C3C7 8D07&nbsp; B66B AFC8 CE71 D9AF D2F0<br />
			</dd>
			<dt class="postheader">
				Title: <strong>Re: Brute forcing.</strong><br />
				Post by: <strong>AfternoonDelight</strong> on <strong>August 16, 2013, 08:30 am</strong>
			</dt>
			<dd class="postbody">
				They have a new quantum computer they just installed at NASA, various government departments, google and NASA are time-sharing it... but it could potentially crack shit lickety-split.
			</dd>
			<dt class="postheader">
				Title: <strong>Re: Brute forcing.</strong><br />
				Post by: <strong>Bazille</strong> on <strong>August 16, 2013, 10:10 am</strong>
			</dt>
			<dd class="postbody">
				@AfternoonDelight<br />I don&#039;t think quantum computers can be used to crack anything, yet.<br /><br />
			</dd>
			<dt class="postheader">
				Title: <strong>Re: Brute forcing.</strong><br />
				Post by: <strong>ECC_ROT13</strong> on <strong>August 16, 2013, 12:35 pm</strong>
			</dt>
			<dd class="postbody">
				One other variable is that I believe Truecrypt is relying on PBKDF functions (which basically, make it more expensive in CPU terms, to attack the password).<br /><br />So while a cheap ($&lt;5k) password cracking GPU rig might be crunching 20-30+ billion hashed NTLM passwords a second, the number for TC passwords would be much, much lower.&nbsp; Just guessing that might be as low as 1000 passwords/sec, but that&#039;s just a wild guess.&nbsp; I could be off by a few digits in either direction.&nbsp; :)
			</dd>
			<dt class="postheader">
				Title: <strong>Re: Brute forcing.</strong><br />
				Post by: <strong>kmfkewm</strong> on <strong>August 16, 2013, 01:40 pm</strong>
			</dt>
			<dd class="postbody">
				<div class="quoteheader"><div class="topslice_quote"><a href="http://dkn255hz262ypmii.onion/index.php?topic=202507.msg1457340#msg1457340">Quote from: ECC_ROT13 on August 16, 2013, 12:35 pm</a></div></div><blockquote class="bbc_standard_quote">One other variable is that I believe Truecrypt is relying on PBKDF functions (which basically, make it more expensive in CPU terms, to attack the password).<br /><br />So while a cheap ($&lt;5k) password cracking GPU rig might be crunching 20-30+ billion hashed NTLM passwords a second, the number for TC passwords would be much, much lower.&nbsp; Just guessing that might be as low as 1000 passwords/sec, but that&#039;s just a wild guess.&nbsp; I could be off by a few digits in either direction.&nbsp; :)<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />Came here to say this. Truecrypt certainly uses a Password Based Key Derivation Function (PBKDF) which greatly slows down the speed with which passwords can be guessed. You should expect a well funded attacker can guess trillions of passwords per second. A quick search reveals a cluster of 25 AMD graphics cards got up to 348 billion passwords per second, and the best card in their cluster was a 7970 not even any 7990. I think the cost of that must have been no more than about $12,000 since several of the cards they used are fairly old. <br /><br />It seems to me that they are making exponential gains in password cracking technology because the last time I looked into it the commercially available solutions were guessing about twenty billion passwords per second but now I find people making their own clusters getting into the hundreds of billions. <br /><br />PBKDF slows down such attacks depending on how many iterations the PBKDF is set to use. Cracking a password created with PBKDF with 10,000 iterations takes 10,000 times as long as cracking a password with no PBKDF iterations. So if an attacker can guess 1 trillion hashes per second they can only guess 100 million passwords created with PBKDF with 10,000 iterations. The problem with PBKDF is the more iterations there are the slower it is for a legitimate user to obtain their key with their password. If the user was willing to wait sixty seconds after typing in a password before anything happened, we could add more and more iterations and more and more security for the user. I think in the future the best option is to let the user set their own number of PBKDF iterations, so they can decide the trade off they want to make between ease of use and security. For most applications they try to make it so the user cannot even notice a delay from PBKDF but that it adds up to a big delay when someone tries to guess trillions of passwords. If a user was willing to wait for 100,000 password iterations on whatever CPU they have, the password cracker that can guess 1 trillion hashes per second would only be able to guess 10 million passwords a second. There are techniques for using RAM to limit password attempts as well.
			</dd>
			<dt class="postheader">
				Title: <strong>Re: Brute forcing.</strong><br />
				Post by: <strong>garry63</strong> on <strong>August 16, 2013, 03:50 pm</strong>
			</dt>
			<dd class="postbody">
				Why not use a Yubikey?<br /><br />~ kmfkewm<br />Wihtout going in depth, LUKS uses more iterations so I&#039;d consider using it instead.
			</dd>
			<dt class="postheader">
				Title: <strong>Re: Brute forcing.</strong><br />
				Post by: <strong>bitfool</strong> on <strong>August 16, 2013, 10:30 pm</strong>
			</dt>
			<dd class="postbody">
				<div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">people are lazy; people will all too often, not use proper methods because they are &quot;too hard to remember&quot;. </blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />Yes. But I&#039;m assuming a long and random key for argument&#039;s sake.<br /><br />As to passphrases, I&#039;m not sure how one should define the per word keyspace. <br /><br />If you use words out of a list that is 2^13 words long (~8000 words) then it would seem obvious that&nbsp; the per word keyspace is 2^13, but in principle an attacker doesn&#039;t know how long your&nbsp; word list is. so he may have to assume a (much) bigger keyspace? (for instance, you&#039;re using words from two different languages?)<br /><br />Anyway, assuming 13 bits per word, a 5 word passphrase gets you 65 bits. Seven words is 91.<br /><br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">One other variable is that I believe Truecrypt is relying on PBKDF functions (which basically, make it more expensive in CPU terms, to attack the password).</blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />As I understand it, you can do two things.<br /><br />One : Try AES keys directly.<br /><br />Two : Use a dictionary. And that means, get a word from the dictionary, derive an AES key (expensive) and try it.<br /><br />What is still missing is how many tries per second can different hardware do...<br /><br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">last time I looked into it the commercially available solutions were guessing about twenty billion passwords per second</blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />But what kind of passwords were they cracking? Finding a TC password is not the same thing as just generating a hash.<br /><br />Also, there&#039;s a hashing algo&nbsp; that in theory has been designed in a way to avoid efficient hardware implementation (it&#039;s the hash algo used in litecoins)<br /><br /><br /><br /><br /><br />
			</dd>
			<dt class="postheader">
				Title: <strong>Re: Brute forcing.</strong><br />
				Post by: <strong>kmfkewm</strong> on <strong>August 16, 2013, 11:44 pm</strong>
			</dt>
			<dd class="postbody">
				<div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">As I understand it, you can do two things.<br /><br />One : Try AES keys directly.<br /><br />Two : Use a dictionary. And that means, get a word from the dictionary, derive an AES key (expensive) and try it.<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />Yeah those are the two options, short of actual cryptanalysis. Directly guessing AES keys is always going to be the least effective way as it will have a key space of 2^128 or 2^256 whereas the effective key space of the password is not likely to have this much entropy. Even if the password has more entropy I think brute force on the password will brute force the key in no more time than it takes to brute force the encryption key directly, because of the pigeon hole principle. The KDF can produce outputs of 256 bits, if the password has 300 bits of entropy that means it will take 2^300 guesses to certainly break the password, each password given to the KDF produces a unique output if there are not collisions (there ARE collisions but they should be super rare), by the time you guess 2^256 passwords the KDF should output about 2^256 unique keys exhausting its key space, which means future password inputs can only produce a key output that has already been obtained (there are collisions but they are super rare), which means that you will almost certainly brute force the AES key prior to brute forcing the 300 bit password. <br /><br />On the other hand if you brute force the AES key directly you can guess each key as soon as you generate it, if you use a PBKDF with 100,000 iterations you need to generate 100,000 keys prior to having one for testing (although you could test each key on the path to the one mapping to the password as well). You can calculate the entropy PBKDF iterations add with the following formula:<br /><br />log2(2^password_entropy * pbkdf_iterations) == entropy of password WITH pbkdf iterations<br /><br />so with 10,000 pbkdf iterations an 80 bit password turns into a 96 bits of security, and a 256 bit password turns into 272 bits of security. But with PBKDF or not you are still only guessing 2^256 passwords, it just takes as long to guess that many passwords as it normally would take to guess 2^272 passwords, so actually in this case I think it could be slower to brute force the password than it is to brute force the key directly, unless you guess each of the iterations the password produces when run through the PBKDF all the way up to the final iteration. In cases where a PBKDF is used this is probably the best strategy if you plan to do non stop brute force, because either it will break the key because the password is correct, or it will break the key because it has tried 2^256 unique inputs into a KDF that can only produce 2^256 outputs and which is highly collision resistant. <br /><br />Please correct any of what I just said if I am wrong but I think it is correct, and it pretty much means that it is virtually always best to try to crack the password instead of the AES key directly (because not only is the password likely to be much easier to crack than the key, but even if it is not you will crack the key in the process of trying to crack the much harder to crack password, due to the collision resistance of the KDF and the pigeon hole property). <br /><br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">What is still missing is how many tries per second can different hardware do...<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />This can be answered easily in millions of hashes per second, when it comes to PBKDF you take millions of hashes per second / PBKDF iterations. <br /><br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">Also, there&#039;s a hashing algo&nbsp; that in theory has been designed in a way to avoid efficient hardware implementation (it&#039;s the hash algo used in litecoins)<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />I always assume when they give figures about passwords per second that they mean hashes per second unless otherwise specified. Yeah I know TC password is not the same thing as generating a hash, it uses a PBKDF, read my post. I think litecoin tries to be RAM intensive right? That is a cool technique. PBKDF2 (the standard PBKDF and what Truecrypt uses) tries to be CPU intensive. 
			</dd>
			<dt class="postheader">
				Title: <strong>Re: Brute forcing.</strong><br />
				Post by: <strong>kmfkewm</strong> on <strong>August 17, 2013, 12:13 am</strong>
			</dt>
			<dd class="postbody">
				Actually the quantum Grovers algorithm would result in it sometimes making more sense to attack the key directly than attacking the password, since it halves the key space of the symmetric key (turning AES-128 into AES-64, which is hopefully easier to break than many passwords). But I think direct attacks on the key only make sense in the quantum rather than classical world. 
			</dd>
			<dt class="postheader">
				Title: <strong>Re: Brute forcing.</strong><br />
				Post by: <strong>bitfool</strong> on <strong>August 21, 2013, 12:23 am</strong>
			</dt>
			<dd class="postbody">
				<div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">Please correct any of what I just said if I am wrong but I think it is correct</blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />Well, I haven&#039;t studied all the details, you seem to know more about them than I.<br /><br />Regardless, my overall take is this :<br /><br />If the attacker is using a dictionary and your passphrase/word is in the dictionary, you had it. <br /><br />The other possibility is, you&#039;re using a random passhprase that can go from something like ~60 bits to...as much as you like.<br /><br />Then we need to figure out how many keys (AES or similar) can be tried per second.<br /><br />A simple hardware counter running at 4 ghz (2^32) would count up to 2^57 in 388 days (~1.06 years)<br /><br />The questions remain, what can off the shelf hardware do? What could custom hardware do?<br /><br />For starters trying a key is going to take more than a clock cycle...<br /><br />
			</dd>
		</dl>
		<div id="footer" class="smalltext">
			
			<span class="smalltext" style="display: inline; visibility: visible; font-family: Verdana, Arial, sans-serif;"><a href="http://dkn255hz262ypmii.onion/index.php?action=credits" title="Simple Machines Forum" target="_blank" class="new_win">SMF 2.0.5</a> |
 <a href="http://www.simplemachines.org/about/smf/license.php" title="License" target="_blank" class="new_win">SMF &copy; 2013</a>, <a href="http://www.simplemachines.org" title="Simple Machines" target="_blank" class="new_win">Simple Machines</a>
			</span>
		</div>
	</body>
</html>