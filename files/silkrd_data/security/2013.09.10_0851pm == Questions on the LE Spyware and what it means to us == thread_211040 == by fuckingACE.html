<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<meta name="robots" content="noindex" />
		<link rel="canonical" href="http://dkn255hz262ypmii.onion/index.php?topic=211040.0" />
		<title>Print Page - Questions on the LE Spyware and what it means to us</title>
		<style type="text/css">
			body, a
			{
				color: #000;
				background: #fff;
			}
			body, td, .normaltext
			{
				font-family: Verdana, arial, helvetica, serif;
				font-size: small;
			}
			h1#title
			{
				font-size: large;
				font-weight: bold;
			}
			h2#linktree
			{
				margin: 1em 0 2.5em 0;
				font-size: small;
				font-weight: bold;
			}
			dl#posts
			{
				width: 90%;
				margin: 0;
				padding: 0;
				list-style: none;
			}
			dt.postheader
			{
				border: solid #000;
				border-width: 1px 0;
				padding: 4px 0;
			}
			dd.postbody
			{
				margin: 1em 0 2em 2em;
			}
			table
			{
				empty-cells: show;
			}
			blockquote, code
			{
				border: 1px solid #000;
				margin: 3px;
				padding: 1px;
				display: block;
			}
			code
			{
				font: x-small monospace;
			}
			blockquote
			{
				font-size: x-small;
			}
			.smalltext, .quoteheader, .codeheader
			{
				font-size: x-small;
			}
			.largetext
			{
				font-size: large;
			}
			.centertext
			{
				text-align: center;
			}
			hr
			{
				height: 1px;
				border: 0;
				color: black;
				background-color: black;
			}
		</style>
	</head>
	<body>
		<h1 id="title">Silk Road forums</h1>
		<h2 id="linktree">Discussion => Security => Topic started by: fuckingACE on September 10, 2013, 08:51 pm</h2>
		<dl id="posts">
			<dt class="postheader">
				Title: <strong>Questions on the LE Spyware and what it means to us</strong><br />
				Post by: <strong>fuckingACE</strong> on <strong>September 10, 2013, 08:51 pm</strong>
			</dt>
			<dd class="postbody">
				So I´ve been doing some thinking about the recent Spyware propagated by the feds and its got me worried.. <br /><br />I was wondering if anyone that understands the technology and legal ramifications of it could help me answer some questions. <br /><br />1. How do we know if our machines are infected. I know its best to be safe than sorry and format anyway at the slightest doubt. But I want to find a way to actually test to see if any machines are infected. Are there any processes or files we can search for, any rootkit finder apps (think sysinternals rootkit revealer type apps), sypyware finders etc. that we know alert positive to its presence. <br /><br />2. Infection vectors, What are the chances the feds are currently using other sites to get it on our machines. Perhaps propagating links to news articles on the forums or main site, Are there any other sites known to be carrying the same payload. <br /><br />3. I imagine with the amount of machines infected, the job of data-mining must be huge for the feds. SO I doubt its done by hand. Are all the details just stored on one big database for access later in individual cases. Or are there key markers like url bookmarks, apps or other things that if the spyware finds on the system will prompt the feds to do a manual investigation. or perhaps all infected systems are due for a manual analysis at a later stage<br /><br />4. I have seen a comprehensive list of the information that this tool is programmed to collect. but I cant believe thats all they would want. Can that tool keylog? can it be used to retrieve passport information or internet history in amnesic browsers?<br /><br />5. I have read that the kit is memory persistent. I wanted to know If they mean this in the the sense that its written in the MBR and thus persistent after a fresh install or simply memory persistent and will only survive reboots and shutdowns. <br /><br />6. Am I correct in the assumption that there is only one version of the tool and that is a windows binary only. So if we run Linux or Mac were good?<br /><br />I realise its probably tedious for someone techy to answer all this as they´ve probably been bombarded with questions since it first happened. So perhaps we could start a discussion or something, or if the info already exists point me in the right direction.
			</dd>
			<dt class="postheader">
				Title: <strong>Re: Questions on the LE Spyware and what it means to us</strong><br />
				Post by: <strong>Bazille</strong> on <strong>September 10, 2013, 09:56 pm</strong>
			</dt>
			<dd class="postbody">
				1. That&#039;s hard. Rootkit finders probably won&#039;t detect it. Maybe you could monitor your internet traffic by sending it through another computer and see to which places it connects to by recording all connections with Wireshark.<br />2. Windows update maybe. They could hijack the connection between you and the Windows update server and send you malware. Not sure if Linux updates could be affected, because they automatically check package integrity? Anyway, you can turn off&nbsp; update checks in Linux.<br />3. They don&#039;t infect huge amount of machines, only strategically useful machines or machines of targets. Mostly they just passively spy on everyone and store their data in giant data centers, sometimes maybe hijack your connection to give you their own SSL certificates etc.<br />4. They can retrieve everything which is not encrypted at the time of the spying. They can extract encryption keys from your memory etc. But for that too you&#039;d have to become a target. They can&#039;t recover data from amnesic operating systems, unless maybe they record everything by installing malware into the computers processor or MBR. For that you would have to become a target.<br />5. They can write malware in the MBR or into the CPU. Though backdoored CPU&#039;s may just be a rumor.<br />6. They most likely have malware for Linux and Mac. But it&#039;s probably a lot harder to make your computer execute the malware if you use Linux. I think for the CPU to install their malware they&#039;d have to make your computer execute a program, e.g. by sending you a PDF exploit or get through the router and exploit some unknown security vulnerability on one of the services which open a port (SMTP, SSH, webserver etc.). <br />
			</dd>
			<dt class="postheader">
				Title: <strong>Re: Questions on the LE Spyware and what it means to us</strong><br />
				Post by: <strong>astor</strong> on <strong>September 10, 2013, 10:04 pm</strong>
			</dt>
			<dd class="postbody">
				What spyware that was propagated by the feds?<br />
			</dd>
			<dt class="postheader">
				Title: <strong>Re: Questions on the LE Spyware and what it means to us</strong><br />
				Post by: <strong>fuckingACE</strong> on <strong>September 10, 2013, 11:25 pm</strong>
			</dt>
			<dd class="postbody">
				<div class="quoteheader"><div class="topslice_quote"><a href="http://dkn255hz262ypmii.onion/index.php?topic=211040.msg1528759#msg1528759">Quote from: Bazille on September 10, 2013, 09:56 pm</a></div></div><blockquote class="bbc_standard_quote">1. That&#039;s hard. Rootkit finders probably won&#039;t detect it. Maybe you could monitor your internet traffic by sending it through another computer and see to which places it connects to by recording all connections with Wireshark.<br />2. Windows update maybe. They could hijack the connection between you and the Windows update server and send you malware. Not sure if Linux updates could be affected, because they automatically check package integrity? Anyway, you can turn off&nbsp; update checks in Linux.<br />3. They don&#039;t infect huge amount of machines, only strategically useful machines or machines of targets. Mostly they just passively spy on everyone and store their data in giant data centers, sometimes maybe hijack your connection to give you their own SSL certificates etc.<br />4. They can retrieve everything which is not encrypted at the time of the spying. They can extract encryption keys from your memory etc. But for that too you&#039;d have to become a target. They can&#039;t recover data from amnesic operating systems, unless maybe they record everything by installing malware into the computers processor or MBR. For that you would have to become a target.<br />5. They can write malware in the MBR or into the CPU. Though backdoored CPU&#039;s may just be a rumor.<br />6. They most likely have malware for Linux and Mac. But it&#039;s probably a lot harder to make your computer execute the malware if you use Linux. I think for the CPU to install their malware they&#039;d have to make your computer execute a program, e.g. by sending you a PDF exploit or get through the router and exploit some unknown security vulnerability on one of the services which open a port (SMTP, SSH, webserver etc.).<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />From your answer then, It would seem that you need to specifically be picked out as a target for this form of active monitoring. <br />My question then: was everyone classed as a target who accessed tor-mail during the critical period in which the feds used a vulnerability in the browser bundle code to allow spyware to install on any machine accessing the tormail url during the time window from the servers seizure until unknown, could still be happening Or was the spyware only activated or used on certain machines, or was only certain information collected from all machines. <br /><br />Astor - From my limited understanding of whats going on. The FBI after taking control of the servers that hosted tormail made alterations to the sites code to exploit a vulnerability in the browser bundle to install spyware on any machine attempting to access the URL after its seizure. This spyware was set be persistent with no date to stop monitoring and its job to gather information from the clients such as MAC, IP, bookmarks, I am unsure as to exactly what it is meant to gather, exactly who is affected, and to what extent, that is ideally what I would like to find out. <br /><br />My two biggest concerns are, how many people right now on here are unwittingly accessing from infected machines, and also the capability of the spyware, I want to know if it has the ability to collect things above and beyond what has been stated, including account info from cookies etc.. Autofill info, files, key logging things that could be used to easily pinpoint SR members by doing a quick search for example for the SR url in all the data that the machines are sending back, and if then they could even go a step further and after having located a machine that accesses the SR URL regularly to then activate keylogging on the client and capture SR login credentials... You can see where im going with this.. <br />&nbsp;Any help appreciated. <br /><br /><br /><br />
			</dd>
			<dt class="postheader">
				Title: <strong>Re: Questions on the LE Spyware and what it means to us</strong><br />
				Post by: <strong>P2P</strong> on <strong>September 10, 2013, 11:53 pm</strong>
			</dt>
			<dd class="postbody">
				Ace, I think astor just thought you were talking about a different spyware attack, as I did when I initially saw this thread. Something that happened a good while ago (now) is not really what one would call &quot;recent,&quot; but do as you like. In any event, there were several threads started a month or two ago discussing this matter; I would chip in really quickly with the capabilities of the spyware but I actually have not been on the forums as much lately, so I cannot remember the exact capabilities; but they are out there. They were posted on another site and quoted on this forum, so that info should be in one of the discussion threads regarding the attack. And yes, it&#039;s very possible that there are several individuals (especially those that foolishly do not keep up on current events in this EXTREMELY dynamic business), whose computers were infected, that are accessing the site right now. I think that should be fairly obvious.
			</dd>
			<dt class="postheader">
				Title: <strong>Re: Questions on the LE Spyware and what it means to us</strong><br />
				Post by: <strong>astor</strong> on <strong>September 11, 2013, 12:23 am</strong>
			</dt>
			<dd class="postbody">
				Yeah, I thought he was talking about the botnet and had concluded it was LE spyware. I&#039;ve seen no evidence of that. Some blog post claimed to have identified the malware in the botnet attack, and there was no indication it was LE related.<br />
			</dd>
			<dt class="postheader">
				Title: <strong>Re: Questions on the LE Spyware and what it means to us</strong><br />
				Post by: <strong>ECC_ROT13</strong> on <strong>September 11, 2013, 03:19 am</strong>
			</dt>
			<dd class="postbody">
				The exploit delivered from the FH/Tormail takedown seems to be very well understood.&nbsp; &nbsp;It tried to capture the MAC address of the machine, then phone home to a public Internet site to denanonymize the user.&nbsp; &nbsp;Only seems to have affected Windows + Tor Browser Bundle users (who were NOT using the current TBB version at the time).<br /><br />That&#039;s it.&nbsp; &nbsp;That&#039;s all it did.&nbsp; &nbsp;No long-term infection, no keylogging, nothing else.&nbsp; &nbsp;Just told them the IP you were sending non-Tor traffic from at the moment it ran.<br /><br />Now if there&#039;s some *other* exploit or malware that I&#039;m not aware of that somebody found from the FH servers, somebody post a link.&nbsp; <br /><br />
			</dd>
			<dt class="postheader">
				Title: <strong>Re: Questions on the LE Spyware and what it means to us</strong><br />
				Post by: <strong>comsec</strong> on <strong>September 11, 2013, 03:30 am</strong>
			</dt>
			<dd class="postbody">
				<div class="quoteheader"><div class="topslice_quote"><a href="http://dkn255hz262ypmii.onion/index.php?topic=211040.msg1529327#msg1529327">Quote from: ECC_ROT13 on September 11, 2013, 03:19 am</a></div></div><blockquote class="bbc_standard_quote">The exploit delivered from the FH/Tormail takedown seems to be very well understood.&nbsp; &nbsp;It tried to capture the MAC address of the machine, then phone home to a public Internet site to denanonymize the user.&nbsp; &nbsp;Only seems to have affected Windows + Tor Browser Bundle users (who were NOT using the current TBB version at the time).<br /><br />That&#039;s it.&nbsp; &nbsp;That&#039;s all it did.&nbsp; &nbsp;No long-term infection, no keylogging, nothing else.&nbsp; &nbsp;Just told them the IP you were sending non-Tor traffic from at the moment it ran.<br /><br />Now if there&#039;s some *other* exploit or malware that I&#039;m not aware of that somebody found from the FH servers, somebody post a link. <br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />It also left a cookie lying around for about 20-30mins for some reason. Probably so if you went on a certain clearnet site you could be identified for having that cookie and decloaked. Anyways, it self deleted itself so there is no federal malware hanging around. 
			</dd>
			<dt class="postheader">
				Title: <strong>Re: Questions on the LE Spyware and what it means to us</strong><br />
				Post by: <strong>kmfkewm</strong> on <strong>September 11, 2013, 04:59 am</strong>
			</dt>
			<dd class="postbody">
				<div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">1. How do we know if our machines are infected. I know its best to be safe than sorry and format anyway at the slightest doubt. But I want to find a way to actually test to see if any machines are infected. Are there any processes or files we can search for, any rootkit finder apps (think sysinternals rootkit revealer type apps), sypyware finders etc. that we know alert positive to its presence. <br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />It didn&#039;t install a rootkit. I believe the term for what they did is &#039;beaconing&#039; (though you could also call it a proxy bypass attack, or a side channel attack, but I suggest not calling it a side channel attack in front of any cryptographers). Essentially, they hacked you, phoned home immediately with your MAC address, also getting them your IP address, and that was that. Nothing persistent was installed. There was a cookie set but it expired after half an hour. <br /><br />The attack only worked against Windows. If your OS is not Windows, you are fine. The attack only worked against version 17.0.6 of Firefox and prior, if you had an up to date Firefox, you are fine. It had been patched a month prior to them using it. The attack requires javascript to be enabled, if you had javascript disabled, you are fine. The attack can only phone home an IP address if you didn&#039;t isolate Firefox from external IP address. If you used Whonix or Qubes with a TorVM you are fine, and also you are fine if you isolated firefox yourself. If you used Whonix or isolated yourself they cannot even phone home a real MAC address. They can only phone home a real IP address if firefox isn&#039;t isolated from the network, if firefox can only talk to Tor because of firewall rules you are fine, which means even if the attack was targeted against Linux users and they infected you on Tails, they could only phone home a MAC address and not an IP address because the Tails Browser is network (but not process) isolated. <br /><br />So you were not compromised at all if you meet any of the following criteria:<br /><br />A. You don&#039;t use Windows<br />B. You had updated your browser roughly within the past month<br />C. You did not have javascript enabled<br />D. You used Whonix or isolated yourself with HVM or isolated with TorVM <br /><br />If you meet none of the previous criteria, but still meet the following criteria, they did not get your IP address but did get your username and MAC:<br /><br />E. You had firefox network isolated with a firewall <br /><br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">2. Infection vectors, What are the chances the feds are currently using other sites to get it on our machines. Perhaps propagating links to news articles on the forums or main site, Are there any other sites known to be carrying the same payload. <br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />The feds could try that but I don&#039;t know that they will be allowed to hack random people reading news articles. I guess they could make a fake news site and direct SR people to it in order to pwn them. It is totally possible. No other sites are known to be carrying the same payload or exploiting the same vulnerability.<br /><br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">3. I imagine with the amount of machines infected, the job of data-mining must be huge for the feds. SO I doubt its done by hand. Are all the details just stored on one big database for access later in individual cases. Or are there key markers like url bookmarks, apps or other things that if the spyware finds on the system will prompt the feds to do a manual investigation. or perhaps all infected systems are due for a manual analysis at a later stage<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />I doubt they infected many machines. They only infected people who not only took absolutely no additional security measures versus using vanilla TBB, but who were on Windows and who had a TBB that was more than a month out of date. They got only the very lowest hanging fruit, and it is actually debatable if they even got a single person. <br /><br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">4. I have seen a comprehensive list of the information that this tool is programmed to collect. but I cant believe thats all they would want. Can that tool keylog? can it be used to retrieve passport information or internet history in amnesic browsers?<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />This entire attack has been analyzed to hell and back by probably a hundred different professional level security researchers and hackers. It cannot do any of that. <br /><br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">5. I have read that the kit is memory persistent. I wanted to know If they mean this in the the sense that its written in the MBR and thus persistent after a fresh install or simply memory persistent and will only survive reboots and shutdowns. <br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />It is none of those things, it crashes itself immediately after phoning home and the only thing left is a cookie that expires half an hour later. <br /><br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">6. Am I correct in the assumption that there is only one version of the tool and that is a windows binary only. So if we run Linux or Mac were good?<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />The exploit technically is cross platform, but the delivered payload is for Windows only. <br /><br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">I realise its probably tedious for someone techy to answer all this as they´ve probably been bombarded with questions since it first happened. So perhaps we could start a discussion or something, or if the info already exists point me in the right direction.<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />NP glad to help. 
			</dd>
		</dl>
		<div id="footer" class="smalltext">
			
			<span class="smalltext" style="display: inline; visibility: visible; font-family: Verdana, Arial, sans-serif;"><a href="http://dkn255hz262ypmii.onion/index.php?action=credits" title="Simple Machines Forum" target="_blank" class="new_win">SMF 2.0.5</a> |
 <a href="http://www.simplemachines.org/about/smf/license.php" title="License" target="_blank" class="new_win">SMF &copy; 2013</a>, <a href="http://www.simplemachines.org" title="Simple Machines" target="_blank" class="new_win">Simple Machines</a>
			</span>
		</div>
	</body>
</html>