<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<meta name="robots" content="noindex" />
		<link rel="canonical" href="http://dkn255hz262ypmii.onion/index.php?topic=201405.0" />
		<title>Print Page - Tutorial: Encrypted and Torified Linux Virtual Machine on a Windows USB Stick</title>
		<style type="text/css">
			body, a
			{
				color: #000;
				background: #fff;
			}
			body, td, .normaltext
			{
				font-family: Verdana, arial, helvetica, serif;
				font-size: small;
			}
			h1#title
			{
				font-size: large;
				font-weight: bold;
			}
			h2#linktree
			{
				margin: 1em 0 2.5em 0;
				font-size: small;
				font-weight: bold;
			}
			dl#posts
			{
				width: 90%;
				margin: 0;
				padding: 0;
				list-style: none;
			}
			dt.postheader
			{
				border: solid #000;
				border-width: 1px 0;
				padding: 4px 0;
			}
			dd.postbody
			{
				margin: 1em 0 2em 2em;
			}
			table
			{
				empty-cells: show;
			}
			blockquote, code
			{
				border: 1px solid #000;
				margin: 3px;
				padding: 1px;
				display: block;
			}
			code
			{
				font: x-small monospace;
			}
			blockquote
			{
				font-size: x-small;
			}
			.smalltext, .quoteheader, .codeheader
			{
				font-size: x-small;
			}
			.largetext
			{
				font-size: large;
			}
			.centertext
			{
				text-align: center;
			}
			hr
			{
				height: 1px;
				border: 0;
				color: black;
				background-color: black;
			}
		</style>
	</head>
	<body>
		<h1 id="title">Silk Road forums</h1>
		<h2 id="linktree">Discussion => Security => Topic started by: Bazille on August 13, 2013, 12:23 pm</h2>
		<dl id="posts">
			<dt class="postheader">
				Title: <strong>Tutorial: Encrypted and Torified Linux Virtual Machine on a Windows USB Stick</strong><br />
				Post by: <strong>Bazille</strong> on <strong>August 13, 2013, 12:23 pm</strong>
			</dt>
			<dd class="postbody">
				This tutorial explains step by step how to create an encrypted USB stick with Linux OS which you can start directly from Microsoft Windows without rebooting.<br /><br />It is mainly aimed at Windows users who never used Linux before and don&#039;t want to reboot their computer every time they use Tor. Following the tutorial produces a torified Linux installation, similar to Tails.<br />Some users may miss some features in Tails and Whonix and would find Ubuntu more convenient and easier to use, or they&#039;re DIY guys and like to have more control by understanding the steps of torifying Linux.<br /><br />Don&#039;t be put off by the length of this tutorial, I mostly tried to mention every single click, so even your granny could successfully install it.<br />If you follow the steps in this tutorial you can&#039;t do much wrong, even if you never used Ubuntu/VirtualBox/TrueCrypt.<br />Also, don&#039;t be put off by having to type stuff in the command line, you will only have to do this during installation. <br /><br />Once you&#039;ve completed the tutorial, Xubuntu is quite easy to use. You can click your way through the desktop using your mouse, as you&#039;re used to.<br /><br />Features: <br />* Runs in a virtual machine on your Windows desktop, but has no access to your hard drives<br />* Entirely encrypted, except for the TrueCrypt and VirtualBox executables<br />* Easily portable to another computer running Windows<br />* Torified with iptables (firewall)<br />* Safer GnuPG configuration<br />* Ubuntu is widely used and easy to use for Linux novices, extensive documentation and help is available on the internet<br />* Install any Ubuntu software you like through the Ubuntu Software Center <br />* Receives manual security updates until 2017, no need to install a new Xubuntu version all the time<br />* Synchronizes time by using tlsdate, which should be slightly more secure than htpdate used by Whonix and Tails<br />* All changes you make are persistent (unless you restore a snapshot)<br />* No program other than Firefox, torsocks and the package updater can contact the network/internet (through Tor only)<br />* Programs don&#039;t share the same Tor circuit (Stream Isolation of Tor Browser, torsocks, tlsdate, security updates)<br />* Copy and paste between Windows and Linux is possible (you should turn this feature off when it&#039;s not needed)<br />* Boots more quickly (~5 seconds) right into the browser window when you use the snapshot feature of VirtualBox<br />* If your browser gets attacked with malware, simply restore the VirtualBox snapshot you&#039;ve created upon completion of this tutorial<br />* Does not install anything or leave traces on your Windows system after unplugging the USB stick (*)<br /><br />(*) Note that after examining the Windows registry file, it may be possible to tell that TrueCrypt was run (and that a TrueCrypt volume was mounted). However no one can tell that Tor was run on your computer.<br /><br />System requirements:<br />* Microsoft Windows XP or higher<br />* 8GB USB stick<br /><br />Time needed to complete the tutorial: 2+ hours<br /><br />CC-BY Bernd Liefert, 13.08.2013<br />Updated 29.08.2013<br /><br />[WARNING]<br />As of now, despite best efforts, there may be some issues which allow websites to fingerprint the standard Firefox browser installed in this tutorial. This doesn&#039;t threaten to reveal your identity, but makes you more pseudonymous than anonymous. Therefor you should preferably use the latest version of the Tor Browser. Step 7. explains how to install it.<br /><br />What is missing in the standard version of Firefox:<br />https://www.torproject.org/projects/torbrowser/design/#firefox-patches<br /><br />Furthermore this installation is not as secured as Whonix and Tails, yet. The tutorial will be updated in the future.<br />For most users this installation should be safe enough however, as it reliably prevents unwanted connections, profiling and fingerprinting of the browser.<br />[/WARNING]
			</dd>
			<dt class="postheader">
				Title: <strong>Re: Tutorial: Encrypted and Torified Linux Virtual Machine on a Windows USB Stick</strong><br />
				Post by: <strong>Bazille</strong> on <strong>August 13, 2013, 12:24 pm</strong>
			</dt>
			<dd class="postbody">
				1. Prepare your 8GB USB stick or SD card<br /><br />Format the USB stick either with NTFS (Windows Vista or later) or exFAT (Windows XP or later). Formatting the USB stick with FAT won&#039;t be sufficient due to file size limits.<br /><br />2. Download software<br /><br />2.1. TrueCrypt<br /><br />Get the latest stable version of TrueCrypt for Windows from http://www.truecrypt.org/downloads<br /><br />Start the installer and choose &quot;Extract&quot; instead of &quot;Install&quot;. Choose your USB stick as destination.<br />If you don&#039;t want to use an USB stick, simply extract it to some folder.<br /><br />2.2. VirtualBox (portable)<br /><br />Get the portable version of VirtualBox from http://www.vbox.me/<br />(click &quot;Download and run Portable-VirtualBox_xxxxx-Win_all.exe&quot;)<br /><br />Run the installer and choose your USB stick as destination<br /><br />2.3. Ubuntu<br /><br />Download the latest version of Xubuntu 12.04 LTS. We are using Xubuntu in this tutorial because the default version of Ubuntu uses too much resources for the desktop. <br />We are not using the latest Xubuntu (version 13.04), because this version will only receive security updates for a short time. We&#039;d have to install a new version of Xubuntu<br />in 2014 to receive important security updates. Xubuntu 12.04 LTS will receive security updates until 2017. There&#039;s also problems with GPG helper programs in version 13.04, which we try to avoid.<br /><br />If you have a 64bit Intel or AMD CPU download this image:<br />http://se.archive.ubuntu.com/mirror/cdimage.ubuntu.com/xubuntu/releases/12.04/release/xubuntu-12.04.2-desktop-amd64.iso<br /><br />If you have a 32bit CPU download this image:<br />http://se.archive.ubuntu.com/mirror/cdimage.ubuntu.com/xubuntu/releases/12.04/release/xubuntu-12.04.2-desktop-i386.iso<br /><br />If the above images are not available any longer, you can download the latest 12.04 images from here:<br />http://se.archive.ubuntu.com/mirror/cdimage.ubuntu.com/xubuntu/releases/12.04/release/<br />or here<br />http://xubuntu.org/getxubuntu/
			</dd>
			<dt class="postheader">
				Title: <strong>Re: Tutorial: Encrypted and Torified Linux Virtual Machine on a Windows USB Stick</strong><br />
				Post by: <strong>Bazille</strong> on <strong>August 13, 2013, 12:24 pm</strong>
			</dt>
			<dd class="postbody">
				3. Installation and configuration<br /><br />3.1. TrueCrypt<br /><br />Start &quot;TrueCrypt.exe&quot; from your USB stick and click the &quot;Create Volume&quot; button<br />Click &quot;Next&quot; to create an encrypted file container<br />Click &quot;Next&quot; to make it a standard TrueCrypt volume<br />Click &quot;Select File&quot; and open your USB stick, enter filename: &quot;crypt&quot; and click &quot;Save&quot;<br />Optionally check &quot;Never save history&quot;, or keep it unchecked for more convenience<br />Click &quot;Next&quot; to leave the encryption algorithm at its default values<br />Select MB and enter &quot;7500&quot; to have a encrypted container with 7.5GB size. If your USB stick is larger than 8GB you may want to increase the size<br />Enter a reasonably long password, preferably with more than 20 characters, and click &quot;Next&quot;<br />Click &quot;Next&quot; because we don&#039;t need large files<br />Click &quot;Format&quot; and wait until the container creation is complete. Cook some coffee or roll a joint<br />Click &quot;Exit&quot; when done<br /><br />Switch to the remaining TrueCrypt window or start TrueCrypt again and select a drive letter, in this tutorial it will be L:<br />Click &quot;Select File&quot;, browse to your USB stick and select the &quot;crypt&quot; file you have created<br />Click &quot;Mount&quot; and enter the password of your TrueCrypt container<br /><br />The TrueCrypt container will now appear as drive L: in your Computer. You will have to always use the same drive letter in future, or VirtualBox will not find the files.<br /><br />3.2. VirtualBox<br /><br />Start &quot;Portable-VirtualBox.exe&quot; and click &quot;New&quot; to create a new virtual machine<br />Enter any name, e.g. &quot;Ubuntu 2017&quot;<br />Select Type &quot;Linux&quot;<br />Select &quot;Ubuntu (64bit)&quot; if you have a 64bit CPU and click &quot;Next&quot;<br />Choose something between 512MB and 2048MB as memory size<br />Click &quot;Create&quot; to create a new virtual hard drive<br />Click &quot;Next&quot; because using a dynamically allocated hard drive file is enough for our use<br />Use the slider to make the maximum size of the virtual hard disk file slightly smaller than 7.5GB<br />The virtual machine is now created and powered off<br /><br />Click &quot;Settings&quot; in the VirtualBox window<br />In the settings tree select &quot;General&quot; and click the &quot;Advanced&quot; tab<br />Click the &quot;Snapshot Folder&quot; text box and select &quot;Other&quot;<br />Browse to drive L:, click &quot;Make New Folder&quot;, enter &quot;snapshots&quot; and click &quot;OK&quot;<br />To be able to use copy + paste between the virtual machine and your Windows desktop, set &quot;Shared Clipboard&quot; to &quot;bidirectional&quot;<br /><br />In the settings tree select &quot;Display&quot; and give the virtual machine more memory (up to 128MB) for desktop graphics<br />In the settings tree select &quot;System&quot;, select the &quot;Processor&quot; tab and make the virtual machine use more CPU cores (if your CPU has more than one core)<br />In the settings tree select &quot;Storage&quot; and select &quot;Empty&quot; below &quot;Controller: IDE&quot;<br />On the right side (&quot;Attributes&quot;) click the little CD icon and select &quot;Choose a virtual CD/DVD disk file&quot;<br />Browse to the folder where you downloaded Xubuntu to and select the .iso file (e.g. &quot;xubuntu-12.04.2-desktop-amd64.iso&quot;)<br /><br />(Optional) If you want to be able to share files between your Windows desktop and the virtual machine, select &quot;Shared Folders&quot; in the settings tree<br />(Optional) Click the folder icon on the right side of the settings window, e.g. your Downloads folder<br />(Optional) Check the &quot;Automount&quot; box after you selected the shared folder<br /><br />Click &quot;OK&quot; to close the settings window<br /><br />In the Oracle VM VirtualBox Manager window, open File -&gt; Preferences and select &quot;Update&quot;<br />Uncheck &quot;Check for updates&quot; to conceal that you are using VirtualBox<br /><br /><br />3.3. Ubuntu<br /><br />In the VirtualBox window click the &quot;Start&quot; button and click &quot;OK&quot; to remove the VirtualBox Information window.<br />If any errors occur click &quot;OK&quot; to close the error windows. You can ignore them, or they will probably pop up more often in the future.<br /><br />The virtual machine should now successfully boot the Xubuntu installer. Click the &quot;Install Xubuntu&quot; button.<br /><br />Check &quot;Download updates while installing&quot; and click &quot;Continue&quot;<br />Click &quot;Continue&quot; and &quot;Install Now&quot; to format the virtual hard disk<br />Select any time zone and click &quot;Continue&quot;<br />Choose your keyboard layout or click &quot;Detect Keyboard Layout&quot; if you are unsure, then click &quot;Continue&quot;<br />Enter any name (e.g. &quot;Manning&quot;) and any computer name (e.g. &quot;NSA&quot;)<br />This password can be weak, as it doesn&#039;t add much security. You need this password later to make administrator changes to Ubuntu<br />Change the username if you like or leave it as it is<br />Select &quot;Login automatically&quot; and click &quot;Continue&quot;<br /><br />Ubuntu will now install a few packages. This will usually take less than 5 minutes. Once this is done, click &quot;Restart Now&quot;.<br />If the virtual machine doesn&#039;t restart, open the &quot;Machine&quot; menu, select &quot;Close&quot;, check &quot;Power off the machine&quot; and click &quot;OK&quot;. Then start the virtual machine again with the &quot;Start&quot; button.<br /><br />VirtualBox should now boot into the Xubuntu Desktop.
			</dd>
			<dt class="postheader">
				Title: <strong>Re: Tutorial: Encrypted and Torified Linux Virtual Machine on a Windows USB Stick</strong><br />
				Post by: <strong>Bazille</strong> on <strong>August 13, 2013, 12:25 pm</strong>
			</dt>
			<dd class="postbody">
				4. Setting up Ubuntu<br /><br />4.1. Update packages<br /><br />When the Xubuntu desktop is loaded, after a few seconds you will most likely get popups about new software being available. Click the red icon in the Xubuntu menu bar and select &quot;Show updates&quot;.<br />Click &quot;Install Now&quot; to start the update process and enter your user password when prompted. Once this is done, click the &quot;Restart Now&quot; button.<br /><br />After restart more software updates may be available. Wait a minute to see if the red icon shows up again, click it and install the updates, then restart Xubuntu again.<br />It is important that all updates were installed before proceeding to the next step. If you install any kernel updates later, you may have to repeat step 4.2.<br /><br />4.2. VirtualBox Guest Additions<br /><br />To use copy + paste between Windows and Ubuntu and some other useful VirtualBox features we need to install the VirtualBox Guest Additions.<br /><br />Open the &quot;Devices&quot; menu in the VirtualBox machine window and select &quot;Install Guest Additions&quot;<br />On the Xubuntu desktop, doubleclick the VBOXADDITIONS CD icon<br />Doubleclick &quot;autorun.sh&quot; and enter your user password<br />When the installation is done (&quot;Press Return to close this window&quot;), restart the virtual machine by clicking the start button on the utter left of the Xubuntu menu bar, select &quot;Log Out&quot; and click the &quot;Restart&quot; button.<br />Enter your user password when prompted.<br /><br />After rebooting copy + paste between Windows and Ubuntu should work. This will be quite useful later in the next step.<br /><br />4.3. Installing Tor, Privoxy and Polipo<br /><br />Click the start button at the utter left of the Xubuntu menu bar and start Accessories -&gt; Terminal Emulator<br />In the new terminal window you should see something like &quot;manning@NSA:~$ &quot;, which is the command prompt.<br /><br />At the command prompt enter &quot;sudo su&quot;, enter your user password when prompted<br /><br />Paste these lines in the terminal window (copy them to your clipboard and select Edit -&gt; Paste in the terminal):<br /><br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">echo &quot;deb http://deb.torproject.org/torproject.org experimental-precise main&quot; &gt;&gt; /etc/apt/sources.list<br />gpg --keyserver keys.gnupg.net --recv 886DDD89<br />gpg --export A3C4F0F979CAA22CDBA8F512EE8CBC9E886DDD89 | apt-key add -<br />apt-get update<br />apt-get install deb.torproject.org-keyring<br />apt-get install tor tor-arm privoxy polipo<br /># <br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />Enter Y to continue when prompted and wait until the packages are downloaded and installed. <br /><br />4.4. PGP (Seahorse and Geany) and text editor<br /><br />Geany is a text editor (actually an IDE), which we will use to encrypt PGP messages. Seahorse is a key manager which we will use to create and store PGP keys. Gedit is a simple text editor.<br /><br />Click the start button in the Xubuntu menu bar and start &quot;Ubuntu Software Center&quot;<br />Enter &quot;seahorse&quot; in the search box of the Ubuntu Software Center, select &quot;Passwords and Keys&quot; and click &quot;Install&quot;, enter your user password when prompted<br />Enter &quot;geany&quot; in the search box, select &quot;Geany&quot; and click &quot;Install&quot;<br />Enter &quot;geanypg&quot; in the search box, select &quot;Pg plugin for Geany&quot; and click &quot;Install&quot; - click &quot;OK&quot; to install untrusted packages<br />Enter &quot;gedit&quot; in the search box, select &quot;Text Editor&quot; and click &quot;Install&quot;<br />Enter &quot;pinentry-gtk2&quot; in the search box, select &quot;GTK+-2-based PIN or pass-phrase entry dialog for GnuPG&quot; and click &quot;Install&quot;<br /><br />When this is done, restart the system by using the restart icon or start button -&gt; Log Out<br /><br />4.5. Change timezone<br /><br />We set our timezone to UTC to reduce fingerprinting possibilities. <br /><br />Click the start button at the utter left of the Xubuntu menu bar and start Accessories -&gt; Terminal Emulator<br />Enter &quot;sudo dpkg-reconfigure tzdata&quot;<br />Use the cursor keys to scroll down, select &quot;Etc&quot; and press enter<br />Use the cursor keys to select UTC and press enter
			</dd>
			<dt class="postheader">
				Title: <strong>Re: Tutorial: Encrypted and Torified Linux Virtual Machine on a Windows USB Stick</strong><br />
				Post by: <strong>Bazille</strong> on <strong>August 13, 2013, 12:26 pm</strong>
			</dt>
			<dd class="postbody">
				5. Firewall configuration<br /><br />5.1. IPtables firewall<br /><br />We only want Tor to be able to connect to the internet, so we setup the firewall accordingly.<br /><br />Click the start button at the utter left of the Xubuntu menu bar and start Accessories -&gt; Terminal Emulator<br /><br /><br />In the terminal window enter <br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">sudo gedit /root/firewall</blockquote><div class="quotefooter"><div class="botslice_quote"></div></div> <br />and enter your user password when prompted<br /><br />In the new text editor window paste these lines:<br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">iptables -F<br /><br />iptables -A OUTPUT -j ACCEPT -m owner --uid-owner debian-tor<br />iptables -A OUTPUT -j ACCEPT -o lo<br />iptables -P OUTPUT DROP<br /><br />iptables -A INPUT -i lo -j ACCEPT<br />iptables -A INPUT -p tcp -m state --state RELATED,ESTABLISHED -j ACCEPT<br />iptables -P INPUT DROP<br /><br />iptables -P FORWARD DROP<br /><br />iptables-save &gt;/etc/iptables.rules<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />Open the &quot;File&quot; menu in the text editor and select &quot;Save&quot;, then close the text editor window<br /><br />Back in the terminal window enter<br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">sudo gedit /etc/network/if-pre-up.d/iptables</blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />In the text editor paste these lines:<br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">#!/bin/sh<br />iptables-restore &lt; /etc/iptables.rules<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />Save the text and close the text editor window.<br /><br />Back in the terminal window enter these lines:<br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">sudo chmod +x /root/firewall<br />sudo /root/firewall<br />sudo chmod +x /etc/network/if-pre-up.d/iptables<br />sudo reboot<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />After the system rebooted we will test our firewall configuration. Firefox should not be able to connect to the internet anymore at this point.<br /><br />Click the start button in the Xubuntu menu bar and start &quot;Web Browser&quot;<br />Firefox should start up and display a &quot;Server not found&quot; message. This means the firewall is running. Close the Firefox window again and proceed to the next step.<br /><br />To be certain you could also open a terminal and type &quot;sudo iptables -L -v&quot; to see if the firewall is running.
			</dd>
			<dt class="postheader">
				Title: <strong>Re: Tutorial: Encrypted and Torified Linux Virtual Machine on a Windows USB Stick</strong><br />
				Post by: <strong>Bazille</strong> on <strong>August 13, 2013, 12:27 pm</strong>
			</dt>
			<dd class="postbody">
				6. Tor and security<br /><br />6.1. Common configuration<br /><br />Click the start button in the Xubuntu menu bar and start Accessories -&gt; Terminal Emulator<br /><br />In the terminal window, enter this line and enter your user password when prompted:<br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">sudo gedit /etc/tor/torrc</blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />In the new text editor window, scroll down to the bottom of the text, add a new line and paste these lines:<br /><br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">ControlPort 9051<br />ControlListenAddress 127.0.0.1<br />SocksPort 127.0.0.1:9050<br />SocksPort 127.0.0.1:9100 IsolateDestAddr IsolateDestPort<br />SocksPort 127.0.0.1:9101<br />SocksPort 127.0.0.1:9102<br />StrictNodes 1<br />AvoidDiskWrites 1<br />DisableDebuggerAttachment 0<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />6.2. Exit nodes<br /><br />6.2.1 (Optional) Define allowed exit node countries<br /><br />Most people don&#039;t recommend this option, because it may make you less anonymous, but I prefer to have my exit nodes in countries which are not part of the NSA&#039;s PRISM program. <br />If you don&#039;t set any exit nodes yourself, then Tor will randomly choose exit nodes for you. As there is a huge amount of exit nodes running in the USA and other Five Eyes countries, <br />you will often use exit nodes which can be sniffed by the NSA. However, as many websites are in the USA and PRISM partner countries, this is no ultimate protection against getting sniffed by the NSA.<br /><br />This step may reduce anonymity significantly, because there is only a limited amount of exit nodes in those countries. If you want to block servers in certain countries from becoming your exit node, you may want to have a look at step 6.2.2. instead.<br /><br />By adding the next line to the bottom of /etc/tor/torrc we make Tor only use ExitNodes in Asia, South Africa, Ukraine, Russia, South America and Saudi Arabia: <br />ExitNodes {ru},{hk},{tw},{za},{in},{id},{th},{vn},{cn},{ar},{br},{jp},{kr},{sa},{tr},{ua}<br />&nbsp;<br />You can find a list of more country codes here (these are not always the same as internet top level domains)<br />http://dev.maxmind.com/geoip/legacy/codes/iso3166/<br /><br />Note that not all countries have a large amount of ExitNodes, and to avoid deanonymization it&#039;s better if Tor has more than 50 ExitNodes to choose from. <br /><br />6.2.2. (Optional) Define blocked exit nodes<br /><br />Instead of using the above option it&#039;s possible to simply avoid exit nodes in certain countries.<br />By adding the next line to the bottom of /etc/tor/torrc we make Tor only use ExitNodes outside of Five Eyes countries:<br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">ExcludeExitNodes {us},{gb},{ca},{au},{nz},{ie},{a1},{a2},{o1},{??}</blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />Note that you shouldn&#039;t add too many countries to that list, or this may contribute to deanonymizing you. Like option 6.2.1. this also doesn&#039;t really protect you from the clearnet traffic getting routed through cables sniffed by Five Eyes &amp; friends.<br /><br />6.3. (Optional) Define entry node countries<br /><br />If there are enough Tor relays in your country, you should only use EntryNodes in your country. If you are in the USA, add this line to the end of /etc/tor/torrc:<br /><br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">EntryNodes {us} <br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />If you are not from the USA, check the above list of country codes to find out which code your country uses. These are not internet top level domains.<br /><br />If you want to use specific trusted EntryNodes in your country, e.g. because you always want to have a fast entry node with large bandwidth, then you can specify those by using fingerprints. <br />In this case You should at least add 3 EntryNodes then, better more.<br /><br />manning2.torservers.net, bolobolo1.torservers.net and manning1.torservers.net are among the fastest EntryNodes in the USA (and the world) right now, so you may want to use them, if you live in the USA.<br />Instead of using the above EntryNodes example, you&#039;d have to use something like this:<br /><br />EntryNodes $D0236B1908B3CC686DB0A361F4931073A25793F1,$9F7A37446BC034B4FDB27CAE2C6CAAB83A40A361,$073F27934762FF8BA956FFCE136AAC1CCF45EA13 <br /><br />A configuration like this is recommended, if you don&#039;t use bridges.<br /><br />To get more fingerprints of servers, go to http://torstatus.blutmagie.de/ and click on the servernames. Copy the fingerpint line and add a $ in front of each fingerprint. Seperate individual fingerprints in the config with commas. Remove spaces in the fingerprints. You should use 3-10 fingerprints as entry nodes.<br /><br />6.4. (Optional) Tor bridges<br /><br />Instead of using public EntryNodes you may want to use Tor bridges, but this may not help against NSA sniffing. They may know the bridges from https://bridges.torproject.org/ anyway. To have a very secret bridge you&#039;d have to use hidden bridges run by your friends. As with the EntryNodes, you should use at least 5-10 bridges.<br /><br />Using normal non-obfuscated bridges is pretty much useless, if someone with enough resources (China, Five Eyes, ...) is doing deep packet inspection.<br />If getting a list of obfuscated bridges is too much hassle for you, but you do need to hide the fact that you are using Tor, then you should use a VPN with cover traffic instead.<br /><br />To use bridges you&#039;d have to add the line<br /><br />UseBridges 1<br /><br />to the end of your /etc/tor/torrc. To get a list of bridges, go to https://bridges.torproject.org/bridges and copy the list of IP addresses it shows you. Paste the addresses at the end of your /etc/tor/torrc text file and add &quot;Bridge &quot; (note the space) before each IP address. <br /><br />This will however not show you only bridges from your country, but from random countries. When you connect to a bridge in another country, then it is more likely that one or more secret services sniff your traffic. This would allow them to do time/size correlation when you browse clearnet websites.<br /><br />It may be best if you skip the Tor bridges part and only use the EntryNodes part of this tutorial, unless you know how to find out in which countries those bridges are hosted. If you do use bridges, then the EntryNodes line will be ignored by Tor.<br /><br />Once you&#039;re done with the Tor configuration text file, save it and close the text editor.<br /><br />6.5. Privoxy and Polipo configuration<br /><br />Back in the terminal type &quot;sudo gedit /etc/privoxy/config&quot;<br /><br />At the end of the text file insert a new line and paste this line:<br /><br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">forward-socks5 / 127.0.0.1:9102 .</blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />Save the text and exit the editor.<br /><br />In the terminaltype &quot;sudo gedit /etc/polipo/config&quot; and paste the following lines at the end of the text file:<br /><br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">proxyAddress = &quot;127.0.0.1&quot;&nbsp; &nbsp;<br />socksParentProxy = &quot;127.0.0.1:9101&quot;<br />socksProxyType = socks5<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />Save the text and exit the editor, then enter &quot;sudo reboot&quot; in the terminal to reboot Ubuntu before proceeding to the next step.<br /><br />6.6. Arm<br /><br />We didn&#039;t install Vidalia, which we could easily do by using the Ubuntu Software Center. However for some reason this is not recommended by the Whonix developers.<br />Instead we will use &quot;arm&quot; to get a new Tor identity.<br /><br />Click on the desktop background with your right mousebutton and select &quot;Create Launcher&quot;<br />Enter a Name, e.g. &quot;Arm&quot;<br />Check &quot;Run in terminal&quot;<br />Optionally click the &quot;No icon&quot; button and choose some fancy icon<br />In the &quot;Command&quot; text box, paste this line:<br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">sudo -u debian-tor arm</blockquote><div class="quotefooter"><div class="botslice_quote"></div></div>Click the &quot;Create&quot; button<br /><br />A new icon should now appear on your desktop. It will be explained later in this tutorial how to use it.<br /><br />6.7. Time synching<br /><br />Tor needs the correct date and time to function properly, and we need to avoid getting fingerprinted because our computer sends the local time of our virtual machine to some website or server.<br />Therefor we need to turn off time synching in VirtualBox and make our virtual machine fetch the correct time from the internet in a stealthy way.<br /><br />6.7.1. tlsdate<br /><br />First we need to get the latest version of tlsdate, a . For our installation of Xubuntu 12.04 we can&#039;t use the version from the Ubuntu servers, so we need to get the version for Debian/jessie instead.<br /><br />Go to http://packages.debian.org/jessie/tlsdate and scroll down and click the amd64 version if you are using a 64bit CPU or the i386 version if you are using a 32bit CPU. <br />Choose any mirror to download it to your Downloads folder.<br /><br />Start the Terminal Emulator and paste the following lines:<br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">cd Downloads<br />sudo dpkg -i tlsdate*<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />Enter your user password when prompted. Once the installation is done, enter &quot;sudo gedit /etc/tlsdate/tlsdated.conf&quot;<br /><br />Change the value of &quot;should-sync-hwclock&quot; to &quot;no&quot;<br />Change the value of &quot;jitter&quot; to &quot;1800&quot;<br />Change the value of &quot;min-steady-state-interval&quot; to &quot;60&quot;<br />Change the value of &quot;steady-state-interval&quot; to &quot;3600&quot;<br />Change the value of &quot;subprocess-wait-between-tries&quot; to &quot;10&quot;<br /><br />Change the value of &quot;proxy none&quot; to &quot;proxy socks5://127.0.0.1:9100&quot;<br /><br />Save the text file and exit the editor.<br /><br />6.7.2. Restart tlsdate through NetworkManager<br /><br />When using virtual machine snapshots instead of booting the machine normally, tlsdate may not synchronize the time.<br /><br />Open the Terminal Emulator and enter<br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">sudo gedit /etc/NetworkManager/dispatcher.d/10tlsdate</blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />In the text editor paste these lines:<br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">#!/bin/sh -e<br /><br />case &quot;$2&quot; in<br />&nbsp; &nbsp; up)<br />&nbsp;&nbsp;&nbsp;sleep 10<br />&nbsp;&nbsp;&nbsp;/etc/init.d/tlsdate restart<br />&nbsp;&nbsp;&nbsp;;;<br />&nbsp; &nbsp; &nbsp;*)<br />&nbsp; &nbsp; &nbsp;exit 1<br />esac<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />Save and exit the text editor, then enter <br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">sudo chmod +x /etc/NetworkManager/dispatcher.d/10tlsdate</blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />6.7.3. Disabling vboxadd-service<br /><br />In the terminal enter<br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">sudo gedit /etc/rc.local</blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />In the text editor, before the line &quot;exit 0&quot; add<br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">(sleep 20s; service vboxadd-service stop) &amp;</blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />In the terminal, type &quot;sudo halt&quot; to shutdown the virtual machine.<br /><br />6.7.4. VirtualBox advanced configuration<br /><br />Once the virtual machine is shutdown, close all VirtualBox windows on your Windows desktop.<br /><br />To hide our hardware identifications from the OS and to disable time synching we have to make a few change to a XML file.<br /><br />Open your USB stick folder on the Windows desktop, find and open the file &quot;Ubuntu 2017.vbox&quot; (or whatever you called your virtual machine) in a text editor.<br />Note that for this step to succeed there must be no VirtualBox snapshots present, or the values may get reverted later. Before doing this you have to delete the snapshots.<br /><br />Find the &lt;ExtraData&gt; section and add the following lines to it:<br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">&lt;ExtraDataItem name=&quot;VBoxInternal/Devices/VMMDev/0/Config/GetHostTimeDisabled&quot; value=&quot;1&quot;/&gt;<br />&lt;ExtraDataItem name=&quot;VBoxInternal/Devices/ahci/0/Config/Port0/ATAPIProductId&quot; value=&quot;product&quot;/&gt;<br />&lt;ExtraDataItem name=&quot;VBoxInternal/Devices/ahci/0/Config/Port0/ATAPIRevision&quot; value=&quot;revi&quot;/&gt;<br />&lt;ExtraDataItem name=&quot;VBoxInternal/Devices/ahci/0/Config/Port0/ATAPIVendorId&quot; value=&quot;vendor&quot;/&gt;<br />&lt;ExtraDataItem name=&quot;VBoxInternal/Devices/ahci/0/Config/Port0/FirmwareRevision&quot; value=&quot;firmware&quot;/&gt;<br />&lt;ExtraDataItem name=&quot;VBoxInternal/Devices/ahci/0/Config/Port0/ModelNumber&quot; value=&quot;model&quot;/&gt;<br />&lt;ExtraDataItem name=&quot;VBoxInternal/Devices/ahci/0/Config/Port0/SerialNumber&quot; value=&quot;serial&quot;/&gt;<br />&lt;ExtraDataItem name=&quot;VBoxInternal/Devices/ahci/0/Config/Port1/ATAPIProductId&quot; value=&quot;product&quot;/&gt;<br />&lt;ExtraDataItem name=&quot;VBoxInternal/Devices/ahci/0/Config/Port1/ATAPIRevision&quot; value=&quot;revi&quot;/&gt;<br />&lt;ExtraDataItem name=&quot;VBoxInternal/Devices/ahci/0/Config/Port1/ATAPIVendorId&quot; value=&quot;vendor&quot;/&gt;<br />&lt;ExtraDataItem name=&quot;VBoxInternal/Devices/ahci/0/Config/Port1/FirmwareRevision&quot; value=&quot;firmware&quot;/&gt;<br />&lt;ExtraDataItem name=&quot;VBoxInternal/Devices/ahci/0/Config/Port1/ModelNumber&quot; value=&quot;model&quot;/&gt;<br />&lt;ExtraDataItem name=&quot;VBoxInternal/Devices/ahci/0/Config/Port1/SerialNumber&quot; value=&quot;serial&quot;/&gt;<br />&lt;ExtraDataItem name=&quot;VBoxInternal/Devices/pcbios/0/Config/DmiBIOSFirmwareMajor&quot; value=&quot;3&quot;/&gt;<br />&lt;ExtraDataItem name=&quot;VBoxInternal/Devices/pcbios/0/Config/DmiBIOSFirmwareMinor&quot; value=&quot;4&quot;/&gt;<br />&lt;ExtraDataItem name=&quot;VBoxInternal/Devices/pcbios/0/Config/DmiBIOSReleaseDate&quot; value=&quot;BIOS Release Date&quot;/&gt;<br />&lt;ExtraDataItem name=&quot;VBoxInternal/Devices/pcbios/0/Config/DmiBIOSReleaseMajor&quot; value=&quot;1&quot;/&gt;<br />&lt;ExtraDataItem name=&quot;VBoxInternal/Devices/pcbios/0/Config/DmiBIOSReleaseMinor&quot; value=&quot;2&quot;/&gt;<br />&lt;ExtraDataItem name=&quot;VBoxInternal/Devices/pcbios/0/Config/DmiBIOSVendor&quot; value=&quot;BIOS Vendor&quot;/&gt;<br />&lt;ExtraDataItem name=&quot;VBoxInternal/Devices/pcbios/0/Config/DmiBIOSVersion&quot; value=&quot;BIOS Version&quot;/&gt;<br />&lt;ExtraDataItem name=&quot;VBoxInternal/Devices/pcbios/0/Config/DmiSystemFamily&quot; value=&quot;System Family&quot;/&gt;<br />&lt;ExtraDataItem name=&quot;VBoxInternal/Devices/pcbios/0/Config/DmiSystemProduct&quot; value=&quot;System Product&quot;/&gt;<br />&lt;ExtraDataItem name=&quot;VBoxInternal/Devices/pcbios/0/Config/DmiSystemSKU&quot; value=&quot;System SKU&quot;/&gt;<br />&lt;ExtraDataItem name=&quot;VBoxInternal/Devices/pcbios/0/Config/DmiSystemSerial&quot; value=&quot;System Serial&quot;/&gt;<br />&lt;ExtraDataItem name=&quot;VBoxInternal/Devices/pcbios/0/Config/DmiSystemUuid&quot; value=&quot;9852bf98-b83c-49db-a8de-182c42c7226b&quot;/&gt;<br />&lt;ExtraDataItem name=&quot;VBoxInternal/Devices/pcbios/0/Config/DmiSystemVendor&quot; value=&quot;System Vendor&quot;/&gt;<br />&lt;ExtraDataItem name=&quot;VBoxInternal/Devices/pcbios/0/Config/DmiSystemVersion&quot; value=&quot;System Version&quot;/&gt;<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />Find the &lt;BIOS&gt; section and change the TimeOffset value from 0 to something random between -60000 and +60000. Example: &lt;TimeOffset value=&quot;-31337&quot;/&gt;<br /><br />Find the &lt;CPU ....&gt; section and add<br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">&lt;SyntheticCpu enabled=&quot;true&quot;/&gt;</blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />Change &lt;Hardware version=&quot;2&quot;&gt; to &lt;Hardware version=&quot;2&quot; uuid=&quot;{05f2222c-9697-485b-b105-267a36c401fc}&quot;&gt; (this is the same as in Whonix)<br />If it&#039;s not already enabled, change &lt;PAE enabled=&quot;false&quot;/&gt; to &quot;true&quot;<br /><br />Find the &lt;Network&gt; section and change the first &lt;Adapter ...&gt; section to<br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">&lt;Adapter slot=&quot;0&quot; enabled=&quot;true&quot; MACAddress=&quot;080027070B08&quot; cable=&quot;true&quot; speed=&quot;0&quot; type=&quot;Am79C973&quot;&gt;<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />Change the &lt;DNS ...&gt; section below to <br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">&lt;DNS pass-domain=&quot;false&quot; use-proxy=&quot;true&quot; use-host-resolver=&quot;true&quot;/&gt;</blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />Save the text file and exit the editor.<br /><br />When this step is complete, boot the virtual machine again and proceed to the Firefox/Tor Browser installation.<br />You may want to load the .vbox configuration file into the text editor again to see if the values you changed are still in place. If they are not, this may lead to deanonymization or worse.<br /><br />When starting the virtual machine in future, make sure that the time is actually synchronized with the UTC timezone and doesn&#039;t lag behind UTC significantly before making connections through Tor. <br />If your time is not synchronized with UTC you can be fingerprinted under certain circumstances (&quot;oh look it&#039;s the Tor with the wrong clock again&quot;).<br />Sometimes tlsdate may not synchronize the time properly after restoring a snapshot (this may take a minute), then you should reboot the virtual machine.<br /><br />For more information about the previous steps see http://zo7fksnun4b4v4jv.onion/wiki/Protocol-Leak-Protection_and_Fingerprinting-Protection<br /><br />6.8. Hardening Ubuntu<br /><br />To make Ubuntu a little more secure we install some security packages.<br /><br />Open the Terminal Emulator and enter this line and enter Y to all questions<br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">sudo apt-get install tiger harden-servers harden-clients</blockquote><div class="quotefooter"><div class="botslice_quote"></div></div> <br />For more informations about these and additional hardening packages see http://www.debian.org/doc/manuals/securing-debian-howto/ch-automatic-harden.en.html
			</dd>
			<dt class="postheader">
				Title: <strong>Re: Tutorial: Encrypted and Torified Linux Virtual Machine on a Windows USB Stick</strong><br />
				Post by: <strong>Bazille</strong> on <strong>August 13, 2013, 12:27 pm</strong>
			</dt>
			<dd class="postbody">
				7. Firefox and Tor Browser<br /><br />It is not recommended that you use the standard version of Firefox, unless you are aware of the fingerprinting issues. The following steps are only left in the tutorial for educational reasons, and we may want another installation of Firefox because sometimes Tor Browser may not do what we want.<br /><br />7.1. Firefox (pre-installed)<br /><br />7.1.1. Firefox configuration<br /><br />Start Firefox (start button -&gt; Web Browser) and select Edit -&gt; Preferences in the Firefox menu bar<br /><br />In General preferences, change the &quot;When Firefox starts&quot; setting to blank page or tabs from last time, to prevent connection to Google<br />In Advanced preferences, select the &quot;Data Choices&quot; tab and uncheck both &quot;Enable Firefox Health Report&quot; and &quot;Enable Crash Reporter&quot;<br />In Advanced preferences, select the &quot;Update&quot; tab and uncheck &quot;Search Engines&quot;<br /><br />In Advanced preferences, select the &quot;Network&quot; tab and click Settings (&quot;Configure how Firefox connects to the internet&quot;)<br />In the Connection Settings check &quot;Manual proxy configuration&quot;<br />In the &quot;HTTP Proxy&quot; line enter HTTP Proxy: 127.0.0.1 Port: 8118<br />Check &quot;Use this proxy server for all protocols&quot;, click OK and Close the Firefox Preferences window<br /><br />Note that as of today you shouldn&#039;t &quot;Tell websites that I do not want to be tracked&quot;, yet.<br /><br />We don&#039;t want to connect to Google, so we change the default Firefox search engine.<br />Enter https://startpage.com (or https://ixquick.com/ if you don&#039;t even want to use Google through the Startpage proxy) in the URL bar of Firefox and click &quot;Add to Firefox&quot; on the webpage.<br />On the next page click the &quot;Install&quot; button (HTTPS), check &quot;Start using it right away&quot; and click &quot;Add&quot;<br /><br />Startpage.com is now your default search engine in Firefox. You may want to remove the other search engines, but they won&#039;t bother you unless you select them manually.<br />Enter http://3g2upl4pq6kufc4m.onion/ in the URL bar and bookmark it. This is the hidden service of the search engine DuckDuckGo, with it you can search the web without using the clearnet.<br /><br />7.1.2. Firefox addons<br /><br />First we want to disable all the default addons of Ubuntu.<br />Go to Tools -&gt; Addons menu and select Extensions<br />Click the &quot;Disable&quot; button next to all Ubuntu addons and click &quot;Restart now&quot;<br /><br />Select the &quot;Get Addons&quot; tab and search and install these addons:<br /><br />Cookie Monster<br />NoScript Security Suite<br />RefControl<br />User Agent Overrider<br /><br />Go to https://www.eff.org/https-everywhere and click &quot;Install in Firefox&quot;, click &quot;Allow&quot; to install it and restart the browser<br />After restart, when HTTPS Everywhere asks you if you want to use the SSL Observatory, click No<br /><br />Go to Tools -&gt; RefControl Options and click Edit <br />Select &quot;Block - Send no referer&quot;, check &quot;3rd Party requests only&quot; and click OK to close the RefControl options window<br /><br />Go to Tools -&gt; Addons and click Extensions<br />Click the &quot;Preferences&quot; button of the Cookie Monster addon<br />Check &quot;Block all Cookies&quot; and close the Cookie Monster configuration window <br /><br />Check View -&gt; Toolbars -&gt; Add-on Bar in Firefox, so you can allow cookies for each site later to you stay logged in forums etc.<br /><br />Click the &quot;Preferences&quot; button of the User Agent Overrider<br />At the top of the text enter a new line and paste this line:<br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">Firefox 17/Windows: Mozilla/5.0 (Windows NT 6.1; rv:17.0) Gecko/20100101 Firefox/17.0</blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />Close the Add-ons Manager tab <br />At the top right of Firefox click the User Agent Overrider button and select &quot;Firefox/17&quot;<br /><br />Site-specific or filter-based addons such as AdBlock Plus, Request Policy, Ghostery, Priv3, and Sharemenot are to be avoided.<br /><br />7.1.3. Change about:config<br /><br />Type &quot;about:config&quot; in the URL bar of Firefox and push the &quot;I&#039;ll be careful&quot; button<br />Search for &quot;lang&quot; in the new window and doubleclick &quot;intl.accept_languages&quot;<br />Change &quot;en-US, en&quot; to &quot;en-us, en&quot; (upper case &quot;US&quot; to lower case)<br />Search for &quot;track&quot; and doubleclick &quot;noscript.doNotTrack.enabled&quot; (Value should be &quot;false&quot;)<br />Search for &quot;security.tls.version&quot; and change the value of security.tls.version.max to 3 (this may cause problems with some websites but it can use better encryption for SSL connections)<br /><br />7.1.4. Disable automatic updates of add-ons<br /><br />Go to Tools -&gt; Add-ons -&gt; Extensions<br />For each add-on click the &quot;More&quot; link and turn &quot;Automatic updates&quot; off<br /><br />7.1.5. Change Firefox repository<br /><br />To always have the latest version of Firefox installed the Firefox PPA repository has to be added.<br /><br />Start the Terminal Emulator and enter<br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">sudo su<br />torsocks add-apt-repository ppa:ubuntu-mozilla-security/ppa<br />apt-get update &amp;&amp; apt-get dist-upgrade</blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />7.1.6. Test the browser settings<br /><br />While configuring Firefox we tried to make it appear as if it was the Tor Browser Bundle, thus giving us more anonymity. Now we test if we were successful.<br /><br />Quit and restart Firefox and go to http://ip-check.info , click START TEST! <br />Do not install the Flash or Java plugin.<br /><br />The most important part is that the &quot;Signature&quot; attribute is green. As of now it should show &quot;8ab3a24c55ad99f4e3a6e5c03cad9446 (Firefox)&quot;. This means that our HTTP headers look like the headers of Tor Browser Bundle.<br />Some exit nodes seem to add headers, so it may sometimes show a different signature.<br /><br />Every attribute except &quot;Authentication&quot; should be either green or orange. Note that if you resized the virtual machine window of VirtualBox your browser window may have an odd size. This could be used by websites to fingerprint you, because no one else has the exact same resolution. This issue may be neglectable however.<br /><br />Another test you can run is https://panopticlick.eff.org<br />If everything went well, it should show a message like this:<br />&quot;Within our dataset of several million visitors, only one in 492 browsers have the same fingerprint as yours.&quot;<br />This means that a lot of other browsers have the same signature as yours, making you more anonymous.<br /><br />As of now, Firefox pretends that it runs on Windows, which can confuse exploits which attack the browser and make them useless. As you shouldn&#039;t install any Flash plugins etc. this should not create any problems with websites. If it does create problems, you can change the User-Agent header to a Linux version with the User Agent Overrider button.<br /><br /><br />7.2. Tor Browser<br /><br />7.2.1. Installation<br /><br />7.2.1.1. Download and extract<br /><br />Download the latest version of Tor Browser (English, 64bit if you have a 64bit CPU) for Linux from<br /><br />https://www.torproject.org/projects/torbrowser.html.en#downloads<br /><br />When the download is complete, open your Home -&gt; Downloads folder on the desktop<br />Move the downloaded file from your Downloads folder to your Home folder<br />Click the downloaded file with the right mouse button and select &quot;Extract Here&quot;<br /><br />You will have to repeat step 7.2.1.1. if there is a Tor Browser update available.<br /><br />7.2.1.2. Making it work<br /><br />The &quot;start-tor-browser&quot; icon will not work properly with our installation, so we have to create our own Tor Browser starter.<br /><br />Open the &quot;tor-browser-en-US&quot; folder<br />Click the folder background with the right mouse button and select Create Document -&gt; Empty File<br />Enter any name, e.g. &quot;Tor Browser&quot;<br />Click the &quot;Tor Browser&quot; file with the right mouse button and select &quot;Open With Leafpad&quot;<br />Paste these lines into the text editor:<br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">#!/bin/sh<br />cd ~/tor-browser_en-US<br />./App/Firefox/firefox -profile ./Data/profile -no-remote<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />Save the text file and close the text editor, then click the &quot;Tor Browser&quot; icon with the right mouse button again<br />Select the &quot;Permissions&quot; tab and check &quot;Allow this file to run as a program&quot;<br />Click the &quot;Tor Browser&quot; icon with the right mouse button and select Send To -&gt; Desktop (Create Link)<br /><br />7.2.2. Configuration<br /><br />Start Tor Browser by clicking the icon on the desktop<br /><br />You may want to deactivate Javascript by clicking the &quot;S&quot; icon next to the green onion icon in the browser and selecting &quot;Forbid Script Globally&quot;. This is however not recommended by the Tor developers.<br /><br />In the browser, go to Edit -&gt; Preferences, click the &quot;Advanced&quot; tab and push the Settings button in the Network tab<br />Enter these values: <br />HTTP Proxy: 127.0.0.1<br />Port: 8118<br /><br />Check &quot;Use this proxy server for all protocols&quot;<br /><br />You can then configure your browser as desired, but don&#039;t change the language. Otherwise you may become more pseudonymous than anonymous.<br />If you want to save cookies for a website (e.g. to stay logged in in forums), click the Tor button -&gt; Cookie Protections and protect the cookies for the website 
			</dd>
			<dt class="postheader">
				Title: <strong>Re: Tutorial: Encrypted and Torified Linux Virtual Machine on a Windows USB Stick</strong><br />
				Post by: <strong>Bazille</strong> on <strong>August 13, 2013, 12:28 pm</strong>
			</dt>
			<dd class="postbody">
				8. Preparing PGP<br /><br />Click the start button in the Xubuntu menu bar and start Settings &gt; Passwords and Keys<br />In the Passwords &amp; Keys window, click the &quot;New&quot; button, select &quot;PGP Key&quot; and click &quot;Continue&quot;<br /><br />Enter a fake name (first + last name) and a fake email address<br />Click &quot;Advanced key options&quot; and increase key strength to 4096, click the &quot;Create&quot; button and enter a reasonable passphrase for your PGP key<br /><br />Click &quot;Cancel&quot; to close the &quot;Create New&quot; window (don&#039;t cancel the &quot;Generating Key&quot; window). <br />While the key is being created, this can take a while, open Firefox and browse some website, preferably a hidden service (OnionNews: newsiiwanaduqpre.onion ), or test some programs from the Xubuntu start menu.<br />When the PGP key is created, close the Passwords and Keys window (click &quot;Cancel&quot;). You can use Passwords and Keys later to add and delete keys of your contacts.<br /><br />Click the start button in the Xubuntu menu bar and start Development -&gt; Geany<br />In the Geany window, open Tools menu -&gt; Plugin Manager, check &quot;GeanyPG&quot; and click &quot;OK&quot;<br /><br />To stop GPG from being too open about itself we restrict the information which is passed on in a public PGP key and encrypted messages.<br /><br />Open the Terminal Emulator and type<br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">gedit ~/.gnupg/gpg.conf</blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />Scroll down to the end of the text file and enter these lines:<br /><br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">no-emit-version<br />no-comments<br />#throw-keyids<br />display-charset utf-8<br /><br />personal-digest-preferences SHA512<br />cert-digest-algo SHA512<br />default-preference-list SHA512 SHA384 SHA256 SHA224 AES256 AES192 AES CAST5 ZLIB BZIP2 ZIP Uncompressed<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />Save the text and exit the editor.<br /><br /><br />9. Security updates<br /><br />Due to possible time/size correlation attacks it&#039;s not recommended to turn on the automatic security updates feature all the time. Instead we setup the package updater to only update packages when we manually request it.<br /><br />Click the start button in the Xubuntu menu bar and start Accessories -&gt; Terminal Emulator<br />Enter &quot;sudo gedit /etc/apt/apt.conf.d/00aptitude&quot;, enter your user password when prompted and paste this into a new line in the text editor:<br /><br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">Acquire::http::Proxy &quot;http://127.0.0.1:8123&quot;;</blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />Save the file and exit the text editor.<br /><br />Click the start button, start System -&gt; Update Manager and click the &quot;Settings&quot; button<br />In the Updates tab change &quot;Automatically check for updates&quot; to &quot;Never&quot; and click the &quot;Close&quot; button, enter your user password when prompted<br />In the Ubuntu Software tab uncheck &quot;Proprietary drivers for devices&quot;<br />It&#039;s probably best when you change &quot;Download from&quot; to another country, e.g. Russia: mirror.yandex.ru<br /><br />Close the current window and the update manager. <br /><br />10. Create a snapshot of the virtual machine<br /><br />Congratulations! You are now done with installing Xubuntu.<br /><br />Now that the installation is complete, we can create a snapshot of the virtual machine. If we break something in Xubuntu or we receive some malware, we can revert back to the snapshot later. <br />Before taking a snapshot, you should turn off the Shared Clipboard feature of VirtualBox, and only turn it on again when you need it. <br /><br />Open the &quot;Devices&quot; menu in the running virtual machine window and select Shared Clipboard -&gt; Disabled.<br /><br />To create a snapshot, click the &quot;Machine&quot; menu in the running virtual machine window and select &quot;Take Snapshot&quot;.<br />You can basically create an unlimited number of snapshots, this is only limited by the size of your TrueCrypt container. You may want to create another snapshot later, after adding PGP public keys and bookmarks.<br /><br />Deleting a snapshot will merge it with the previous machine state, so the changes you made before taking the snapshot will be made permanent.<br /><br />To create a backup of this system, simply copy the contents of the USB stick to a folder or another USB stick.<br />This is recommended, as the USB stick may cease to function after some months or years, if a lot of data gets written on it regularly.
			</dd>
			<dt class="postheader">
				Title: <strong>Re: Tutorial: Encrypted and Torified Linux Virtual Machine on a Windows USB Stick</strong><br />
				Post by: <strong>Bazille</strong> on <strong>August 13, 2013, 12:28 pm</strong>
			</dt>
			<dd class="postbody">
				11. Using Ubuntu<br /><br />11.1. Booting the virtual machine<br /><br />Plug the USB stick into a Windows computer, open the USB drive and start Truecrypt.exe<br />Select the drive letter you used while creating the TrueCrypt container (in this tutorial we used drive letter L:)<br />Click the &quot;Select File&quot; button and choose the &quot;crypt&quot; file on your USB stick<br />Click &quot;Mount&quot; and enter your TrueCrypt password<br /><br />Start Portable-VirtualBox.exe from the USB stick<br />If it displays an error message you can usually ignore it<br />Click the &quot;Snapshots&quot; button and click the snapshot you want to restore with the right mousebutton<br />Select &quot;Restore Snapshot&quot;, then uncheck &quot;Create a snapshot of the current machine state&quot; and click &quot;Restore&quot;<br />Click the green &quot;Start&quot; arrow to start the virtual machine<br /><br />11.2. Manually checking for updates<br /><br />You should manually check for updates about once a month, by starting System -&gt; Update Manager.<br />If there is a Tor Browser update, repeat step 7.2.1.1.<br /><br />11.3. Using PGP<br /><br />11.3.1. Adding public PGP keys to your keyring<br /><br />To add a public PGP key to your list, copy it to your clipboard and start the Settings -&gt; Passwords and Keys<br />Open the &quot;Edit&quot; menu and click &quot;Paste&quot;<br />Click the &quot;Other Keys&quot; tab<br /><br />(Important) Click the newly imported key with your right mousebutton and select &quot;Sign Key&quot;<br />(Important) In the &quot;Sign Key&quot; window select &quot;Casually&quot; or &quot;Very Carefully&quot;, click the &quot;Sign&quot; button and enter your PGP passphrase<br /><br />You can now close the &quot;Passwords and Keys&quot; window again or add some more keys. The last 2 steps are important because otherwise Geany will refuse to encrypt your messages later.<br /><br />11.3.2. Encrypting text with Geany<br /><br />Start Development -&gt; Geany and type or paste your text into the editor<br />Select the whole text, either with Edit -&gt; Select All or by pressing CTRL + A<br />Open Tools -&gt; GeanyPG -&gt; Encrypt, select the recipient(s) and click the &quot;OK&quot; button<br /><br />Select the encrypted text and copy it to your clipboard.<br /><br />11.3.3. Decrypting text with Geany<br /><br />Start Development -&gt; Geany and paste the encrypted text into the editor<br />Select the whole text, either with Edit -&gt; Select All or by pressing CTRL + A<br />Open Tools -&gt; GeanyPG -&gt; Decrypt/Verify and enter your PGP passphrase<br /><br />11.3.4. Copying your own public PGP key to the clipboard with Seahorse<br /><br />Start Settings -&gt; Passwords and Keys and select the &quot;My Personal Keys&quot; tab<br />Click the key you want to copy with the right mousebutton and select &quot;Copy&quot;<br />You can now paste the key into your browser, text editor etc.<br /><br />11.4. Using shared folders<br /><br />If you specified shared folders at 3.2., they will be available in the &quot;media&quot; folder of the &quot;File System&quot;. To open it as admin, push ALT + F2, enter &quot;gksu thunar /media&quot; and enter your user password.<br /><br />11.5. Getting a new Tor identity<br /><br />Click the &quot;Arm&quot; icon you&#039;ve created earlier on the desktop and enter your user password.<br />Press &quot;n&quot; to get a new identity. More options are availabe when you press &quot;m&quot;, use the cursor keys and the enter key to navigate through the menu.<br /><br />11.6. Torsocks<br /><br />Command line programs which need a connection to the internet may have a proxy option, where you can use proxy host 127.0.0.1 port 8118 or 8123. A quicker solution is using torsocks. Usually you can ignore the errors.<br />Usage example: <div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">torsocks wget http://google.com</blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br /><br /><br /><br />Do you have any suggestions or questions about this tutorial? Was there any problem during installation? <br />Post it in this thread. 
			</dd>
			<dt class="postheader">
				Title: <strong>Re: Tutorial: Encrypted and Torified Linux Virtual Machine on a Windows USB Stick</strong><br />
				Post by: <strong>Pot Doctor Vendor</strong> on <strong>August 13, 2013, 04:32 pm</strong>
			</dt>
			<dd class="postbody">
				Your the man. I have been using tails and some other options for a while. Thanks for the step by step all this would have taken me a while to figure out. <br /><br />
			</dd>
			<dt class="postheader">
				Title: <strong>Re: Tutorial: Encrypted and Torified Linux Virtual Machine on a Windows USB Stick</strong><br />
				Post by: <strong>astor</strong> on <strong>August 13, 2013, 10:13 pm</strong>
			</dt>
			<dd class="postbody">
				Nice job! This tutorial gives people another option in securing their setup.<br /><br />I have some thoughts below.<br /><br /><div class="quoteheader"><div class="topslice_quote"><a href="http://dkn255hz262ypmii.onion/index.php?topic=201405.msg1445788#msg1445788">Quote from: Bazille on August 13, 2013, 12:23 pm</a></div></div><blockquote class="bbc_standard_quote">Advantages over Tails (tails.boum.org):<br />* all changes you make are persistent (unless you restore a snapshot)<br />* everything is encrypted, not just the persistent storage<br />* more control over the Tor configuration (specify EntryNodes in your country or use Tor bridges etc.)<br />* not using the Tor Browser Bundle, so Firefox is more uptodate, with all security/privacy updates etc.<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />One thing I&#039;d like to point out is that if your primary goal is unlinkability, the Tor Browser Bundle is safer than running regular Firefox. You will be in a much smaller anonymity set if you run Firefox 23, and Tor Browser includes many patches that reduce linkability. However, if your primary goal is untraceability, this setup is safer than running TBB on Windows. Also, I&#039;m not sure that newer versions of Firefox are more secure, since Firefox ESR receives security updates. Firefox 22 and 17.0.7 were both patched against the FH exploit.<br /><br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">* no need to reboot the computer, you can use Windows and Ubuntu at the same time<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />This makes it less secure than Tails, because the VM is exposed to exploits on the host OS, especially if you are running this on Windows. For example, malware could read the contents of the Truecrypt volume when it is decrypted, or it could steal the encryption key when it is in RAM, or a keylogger could steal your password when you open the Truecrypt volume.<br /><br />Of course, Whonix on Windows is subject to the same problems, which is why I&#039;ve held off on publishing my Whonix tutorial (yet again).<br /><br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">* install any Ubuntu software you like through the Ubuntu Software Center user interface<br />* no need to reinstall anything to update the packages<br />* copy and paste between Windows and Linux is possible <br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />A shared clipboard is a security vulnerability. If you copy a password on Windows, an exploit in the VM could read it, or vice versa. Shared folders and clipboards should be disabled for maximum VM isolation.<br /><br /><br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">* if your browser gets attacked with malware, simply restore the VirtualBox snapshot you&#039;ve created upon completion of this tutorial<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />I love disposable VMs and use them a lot myself. <br /><br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">Disadvantages compared with Whonix (whonix.org):<br />Like in Tails, if your browser gets attacked and executes a root exploit, the attacker may change the firewall rules to get your IP address. This is unlikely if you regularly download security updates and don&#039;t use javascript.<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />So why not add a separate Tor VM? In fact, why not modify this setup and run it over the Whonix Gateway?<br /><br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote"><br />By adding the next line to the bottom of /etc/tor/torrc we make Tor only use ExitNodes in Asia, South Africa and Russia. Note that Russias traffic often goes through european backbones, with several european secret services potentially sniffing your traffic. This may be an issue (possible time/size correlation attacks when browsing clearnet websites) if you&#039;re european and your entry node is in Europe. So you may want to remove the ,{ru} part at the end of the line.<br /><br />Add this line to a new line in the text editor:<br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_alternate_quote">ExitNodes {hk},{tw},{za},{in},{id},{th},{vn},{cn},{ru}<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />Excluding huge swaths of exit nodes like this harms your anonymity by making your circuits more fingerprintable, and can potentially make the Tor experience terrible with long lags and frequent time outs, while at the same time providing minimal benefit. This option doesn&#039;t affect hidden services like the Silk Road market and forum, and most clearnet sites are in the US anyway, so your connection will cross the US border and be exposed to the NSA.<br /><br /><br />Other than these things, it&#039;s a nice tutorial though!<br />
			</dd>
			<dt class="postheader">
				Title: <strong>Re: Tutorial: Encrypted and Torified Linux Virtual Machine on a Windows USB Stick</strong><br />
				Post by: <strong>Bazille</strong> on <strong>August 13, 2013, 11:03 pm</strong>
			</dt>
			<dd class="postbody">
				<div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote"> Tor Browser includes many patches that reduce linkability. </blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />Where can I have a look what has been patched out of Tor Browser? To me it looks like they&#039;re just using plugins and security update patches, but maybe I&#039;m wrong. It may be possible to make the latest version of Firefox (Linux) look exactly like the Tor Browser Bundle (Windows), I&#039;ll have to play around with it more. <br /><br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">This makes it less secure than Tails, <br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />I&#039;ve already mentioned that it&#039;s possible to break out of the virtual machine, just as it is possible in Whonix. However using a 64bit OS in combination with AMD-V or Intel VT-X probably makes this less likely. You can&#039;t use AMD-V / VT-X with Whonix. Intel VT-X has to be enabled in the BIOS in some cases, AMD-V is already enabled for newer 64bit CPU&#039;s.<br /><br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">A shared clipboard is a security vulnerability.<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />It&#039;s more convenient though. For more security one might want to use Host-to-Guest instead of Bidirectional clipboard sharing, and turn the feature off while it&#039;s not needed. I&#039;ll add this to the tutorial tomorrow.<br /><br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">So why not add a separate Tor VM? In fact, why not modify this setup and run it over the Whonix Gateway?<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />Already working on it. There will be another tutorial in a few days, which works together with this Xubuntu setup. It won&#039;t use Whonix however, it will use a minimal installation of Debian.<br /><br />For buyers of small amounts a single virtual machine without gateway should be enough though. LE most likely&nbsp; doesn&#039;t like to waste their 0-day exploits on small-timers, because it could be detected and exposed on the internet. High profile vendors should better use 2 virtual machines, or even better some Alix or Mini-ITX hardware firewall/router setup. Maybe I&#039;ll write a tutorial for that too in future. Though I don&#039;t have the hardware yet.<br /><br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">Excluding huge swaths of exit nodes like this harms your anonymity by making your circuits more fingerprintable, and can potentially make the Tor experience terrible with long lags and frequent time outs, while at the same time providing minimal benefit. <br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />There are quite a few exit nodes in those countries, especially if you keep the {ru} part. This is still preferable to getting a random entry node in the USA (NSA) and a random exit node in the UK (GCHQ). When both the route from your computer to the entry node, and the route from the exit node to the clearnet website are in PRISM countries, then Tor is pretty much useless. Some people already say Tor is dead because of this. The EntryNodes and ExitNodes lines are there to make it safer again. Though they may need some finetuning and it depends on the country you live in.<br /><br />If you don&#039;t set it yourself, then you are dependent on the random nodes Tor chooses for you. It will happily choose the entry node in the USA and the exit node in the UK, thus negligently exposing your IP address to PRISM. Then I&#039;d rather be fingerprintable because I always &quot;only&quot; use the same 30 exit nodes. But yea, it can get quite laggy that way, and it&#039;s quite useless if your entry node is in the USA/UK and the clearnet website you browse is in the USA/UK.
			</dd>
			<dt class="postheader">
				Title: <strong>Re: Tutorial: Encrypted and Torified Linux Virtual Machine on a Windows USB Stick</strong><br />
				Post by: <strong>astor</strong> on <strong>August 13, 2013, 11:57 pm</strong>
			</dt>
			<dd class="postbody">
				<div class="quoteheader"><div class="topslice_quote"><a href="http://dkn255hz262ypmii.onion/index.php?topic=201405.msg1447578#msg1447578">Quote from: Bazille on August 13, 2013, 11:03 pm</a></div></div><blockquote class="bbc_standard_quote">Where can I have a look what has been patched out of Tor Browser? To me it looks like they&#039;re just using plugins and security update patches, but maybe I&#039;m wrong.<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />https://www.torproject.org/projects/torbrowser/design/#firefox-patches<br /><br />Some specific ones that address linkability:<br /><br />Block Components.interfaces<br /><br />Make Intermediate Cert Store memory-only<br /><br />Add a string-based cacheKey property for domain isolation<br /><br />Disable SSL Session ID tracking<br /><br />Limit Device and System Specific Media Queries<br /><br />Limit the number of fonts per document<br /><br />Randomize HTTP pipeline order and depth<br /><br />Add mozIThirdPartyUtil.getFirstPartyURI() API<br /><br />Do not expose physical screen info to window.screen<br /><br />Do not expose system colors to CSS or canvas<br /><br />Isolate the Image Cache per url bar domain<br /><br />Isolate DOM Storage to first party URI<br /><br /><br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">I&#039;ve already mentioned that it&#039;s possible to break out of the virtual machine, just as it is possible in Whonix. However using a 64bit OS in combination with AMD-V or Intel VT-X probably makes this less likely. You can&#039;t use AMD-V / VT-X with Whonix. Intel VT-X has to be enabled in the BIOS in some cases, AMD-V is already enabled for newer 64bit CPU&#039;s.<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />I was more concerned about an attack from the other direction, where malware on the Windows host can attack the VM, figure out what you&#039;re doing, etc.<br /><br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote"><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_alternate_quote">A shared clipboard is a security vulnerability.<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />It&#039;s more convenient though.<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />That&#039;s not an excuse. :)<br /><br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote"><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_alternate_quote">So why not add a separate Tor VM? In fact, why not modify this setup and run it over the Whonix Gateway?<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />Already working on it. There will be another tutorial in a few days, which works together with this Xubuntu setup. It won&#039;t use Whonix however, it will use a minimal installation of Debian.<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />Nice!<br /><br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote"><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_alternate_quote">Excluding huge swaths of exit nodes like this harms your anonymity by making your circuits more fingerprintable, and can potentially make the Tor experience terrible with long lags and frequent time outs, while at the same time providing minimal benefit. <br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />There are quite a few exit nodes in those countries, especially if you keep the {ru} part. This is still preferable to getting a random entry node in the USA (NSA) and a random exit node in the UK (GCHQ). <br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />Not really. If the clearnet site you are visiting is in the US, as most English speaking web sites are, you&#039;re better off with an exit node in the US, since the chances of being surveilled by the NSA are higher at the borders. If you are in the US and using a non-US entry guard along with a non-US exit node and a connection that comes back into the US to a clearnet site, then you may really be screwed.<br /><br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">When both the route from your computer to the entry node, and the route from the exit node to the clearnet website are in PRISM countries, then Tor is pretty much useless. Some people already say Tor is dead because of this.<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />Yep, I know, but the majority of clearnet sites that people are likely to visit are in the US, so you are slightly safer by using a US exit node. It&#039;s better for the NSA to sniff the encrypted circuit between your middle and exit node then the unencrypted circuit between your exit node and the destination web site, just as it&#039;s better for the NSA to sniff the encrypted circuit between your entry and middle node than between your home and the entry node. Thus it&#039;s better for US citizens to use US entry guards or better yet bridges.<br /><br />It depends on the network topology and where exactly they are watching, of course. If your connection between the exit node and the web site traverses an IX that is tapped by the NSA, you&#039;re screwed anyway.<br /><br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">If you don&#039;t set it yourself, then you are dependent on the random nodes Tor chooses for you. It will happily choose the entry node in the USA and the exit node in the UK, thus negligently exposing your IP address to PRISM.<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />It is my understanding that crossing the US border increases your chances of being surveilled, so US citizens are better off with a US entry node, or even better would be a US bridge.<br />
			</dd>
			<dt class="postheader">
				Title: <strong>Re: Tutorial: Encrypted and Torified Linux Virtual Machine on a Windows USB Stick</strong><br />
				Post by: <strong>astor</strong> on <strong>August 14, 2013, 12:00 am</strong>
			</dt>
			<dd class="postbody">
				Another thing you may notice from this debate is how complex it is to avoid the NSA, and how dependent it is on your geographical location and the sites you are visiting. You shouldn&#039;t make one blanket recommendation for everyone.<br />
			</dd>
			<dt class="postheader">
				Title: <strong>Re: Tutorial: Encrypted and Torified Linux Virtual Machine on a Windows USB Stick</strong><br />
				Post by: <strong>Stonedstupor</strong> on <strong>August 14, 2013, 03:26 am</strong>
			</dt>
			<dd class="postbody">
				im guessing virtual box doesn&#039;t work with windows 8? i just get stuck at the &quot;portable virtualbox **extract // or compress **&quot; or whatever screen. 
			</dd>
			<dt class="postheader">
				Title: <strong>Re: Tutorial: Encrypted and Torified Linux Virtual Machine on a Windows USB Stick</strong><br />
				Post by: <strong>Bazille</strong> on <strong>August 14, 2013, 10:51 am</strong>
			</dt>
			<dd class="postbody">
				I think I may be wrong about the AMD-V/VT-X CPU features. It probably works with a 32bit Guest-OS, too. So using a 64bit Guest-OS does not improve security. However using a 64bit Host-OS probably does slightly improve security.<br /><br /><div class="quoteheader"><div class="topslice_quote"><a href="http://dkn255hz262ypmii.onion/index.php?topic=201405.msg1447752#msg1447752">Quote from: astor on August 13, 2013, 11:57 pm</a></div></div><blockquote class="bbc_standard_quote">https://www.torproject.org/projects/torbrowser/design/#firefox-patches<br />Some specific ones that address linkability:<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />Thanks, I&#039;ll have a closer look later, maybe it&#039;s possible to further secure this installation of Firefox without compiling it yourself. Though some of those patches aren&#039;t necessary when using the virtual machine and the Firefox plugins. <br /><br />Another issue I found after reading about Whonix is that the setup in this tutorial fetches the time from the host OS. That creates some more fingerprinting issues, when using clearnet websites. So for now it&#039;s probably best if you only use this Xubuntu installation to browse hidden services. If you want to browse the clearnet, use Tails or Whonix. Don&#039;t use Tor Browser Bundle on your Windows desktop however, this Xubuntu installation is still safer than that. I&#039;ll update the tutorial after improving these issues.<br /><br />Tails and Whonix fix the time problem, TBB alone does not:<br />https://tails.boum.org/contribute/design/Time_syncing/<br /><br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote"><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_alternate_quote">There are quite a few exit nodes in those countries, especially if you keep the {ru} part. This is still preferable to getting a random entry node in the USA (NSA) and a random exit node in the UK (GCHQ). <br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div>Not really. If the clearnet site you are visiting is in the US, as most English speaking web sites are, you&#039;re better off with an exit node in the US, since the chances of being surveilled by the NSA are higher at the borders. If you are in the US and using a non-US entry guard along with a non-US exit node and a connection that comes back into the US to a clearnet site, then you may really be screwed.<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />True, so with this Xubuntu installation it may be best to choose the clearnet websites you use wisely. E.g. use a search engine outside of the USA, mail provider in Russia etc. The entry guards used in this tutorial will all be in the country you chose anyway. As mentioned in the tutorial you could find 10-20&nbsp; trusted entry nodes in your country and add their fingerprints to the EntryNodes line in the torrc config file. Or you find some trusted bridges (the NSA can run bridges too) of which you know that they are within your country. However even using only trusted entry nodes or bridges doesn&#039;t add much security, I suppose.<br /><br />I personally only use trusted entry nodes with a short route (less than 10 hops) between my computer and the Tor service, and avoid entry nodes where the route goes through/near territory with US facilities in my country. Some politicians in my country say &quot;the NSA is not breaking privacy laws within our country (and of course we blindly believe everything the NSA says)&quot;, but certain US facilities in my country are basically US territory. So technically, politicians are not lying when they say the NSA doesn&#039;t break any laws here. It&#039;s probably similar in South Korea, Japan etc.&nbsp; <br /><br /><div class="quoteheader"><div class="topslice_quote">Quote from: Stonedstupor</div></div><blockquote class="bbc_standard_quote">im guessing virtual box doesn&#039;t work with windows 8? i just get stuck at the &quot;portable virtualbox **extract // or compress **&quot; or whatever screen. </blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />It should work with Windows 8. Does it show any error message? You&#039;re supposed to extract it to your USB stick.
			</dd>
			<dt class="postheader">
				Title: <strong>Re: Tutorial: Encrypted and Torified Linux Virtual Machine on a Windows USB Stick</strong><br />
				Post by: <strong>randomOVDB#2</strong> on <strong>August 29, 2013, 12:14 pm</strong>
			</dt>
			<dd class="postbody">
				Any reason why Xubuntu over Lubuntu?
			</dd>
			<dt class="postheader">
				Title: <strong>Re: Tutorial: Encrypted and Torified Linux Virtual Machine on a Windows USB Stick</strong><br />
				Post by: <strong>Bazille</strong> on <strong>August 29, 2013, 12:58 pm</strong>
			</dt>
			<dd class="postbody">
				Not really. I prefer the looks of Xubuntu, and it doesn&#039;t use much more resources than Lubuntu. The tutorial will work with Lubuntu too, I suppose.
			</dd>
			<dt class="postheader">
				Title: <strong>Re: Tutorial: Encrypted and Torified Linux Virtual Machine on a Windows USB Stick</strong><br />
				Post by: <strong>Bazille</strong> on <strong>August 29, 2013, 01:25 pm</strong>
			</dt>
			<dd class="postbody">
				There have been some minor updates to the tutorial. You can ignore this post if you didn&#039;t complete the tutorial already.<br /><br />Whoever posted this tutorial on torforum.org, you may want to update it too (the entire postings which include steps 3,6,7 and 8). You should also have a closer look at step 6, which doesn&#039;t get displayed properly on torforum.org. You may have to uncheck &quot;HTML&quot; while posting or something like that.<br /><br />In the Oracle VM VirtualBox Manager window, open File -&gt; Preferences and select &quot;Update&quot;. Uncheck &quot;Check for updates&quot; because it would tell someone who sniffs your clearnet connection&nbsp; when you are using VirtualBox.<br /><br />Another optional step has been added to the Tor configuration, if you want to prevent exit nodes in PRISM/Five Eyes countries from getting used for clearnet connections (instead of defining countries which are allowed as exit nodes).<br />ExcludeExitNodes {us},{gb},{ca},{au},{nz},{ie},{a1},{a2},{o1},{??}<br /><br />If you use Firefox instead of Tor Browser, go to Tools -&gt; Add-ons -&gt; Extensions<br />For each add-on click the &quot;More&quot; link and turn &quot;Automatic updates&quot; off, because that can be used for fingerprinting/profiling.<br /><br />To create a backup of this system, simply copy the contents of the USB stick to a folder or another USB stick. This is recommended, as the USB stick may cease to function after some months or years, if a lot of data gets written on it regularly.
			</dd>
			<dt class="postheader">
				Title: <strong>Re: Tutorial: Encrypted and Torified Linux Virtual Machine on a Windows USB Stick</strong><br />
				Post by: <strong>Bazille</strong> on <strong>September 05, 2013, 04:44 pm</strong>
			</dt>
			<dd class="postbody">
				If you are using a system like this then you may want to make your /etc/apt/sources.list use the latest experimental version of Tor, because of the botnet which is terrorizing Tor.<br />Using version 0.2.4 gives your connection a higher priority than the botnet connections (v0.2.3), if the relay is also running the latest version of Tor.<br /><br />To do this, enter &quot;sudo gedit /etc/apt/sources.list&quot; in the Terminal Emulator and scroll down to the line<br /><br />deb&nbsp; &nbsp; &nbsp;http://deb.torproject.org/torproject.org precise main<br /><br />Change that line to<br /><br />deb&nbsp; &nbsp; &nbsp;http://deb.torproject.org/torproject.org experimental-precise main<br /><br />Save the text file and enter &quot;sudo apt-get update &amp;&amp; sudo apt-get upgrade&quot; in the Terminal Emulator. Reboot the virtual machine when downloads and installation are done.<br />
			</dd>
			<dt class="postheader">
				Title: <strong>Re: Tutorial: Encrypted and Torified Linux Virtual Machine on a Windows USB Stick</strong><br />
				Post by: <strong>Bazille</strong> on <strong>September 17, 2013, 07:35 pm</strong>
			</dt>
			<dd class="postbody">
				The tutorial has been updated. Step 7.1.5 has been added which explains how to add the Firefox PPA repository to the system. <br />This makes sure that the latest version of Firefox will get installed when updating the Xubuntu software packages.<br /><br />Start the Terminal Emulator and enter<br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">sudo su<br />torsocks add-apt-repository ppa:ubuntu-mozilla-security/ppa<br />apt-get update &amp;&amp; apt-get dist-upgrade</blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />Step 7.1.3. has been changed. It explains how to make Firefox use TLS 1.2 when possible:<br />Enter about:config in the URL bar and search for &quot;security.tls.version&quot; and change the value of security.tls.version.max to 3 (this may cause problems with some websites but it can use better encryption for SSL connections)<br />See http://kb.mozillazine.org/Security.tls.version.* for more information.
			</dd>
			<dt class="postheader">
				Title: <strong>Re: Tutorial: Encrypted and Torified Linux Virtual Machine on a Windows USB Stick</strong><br />
				Post by: <strong>astor</strong> on <strong>September 17, 2013, 09:44 pm</strong>
			</dt>
			<dd class="postbody">
				I&#039;m pretty sure Firefox gets updated in any Ubuntu LTS without the PPA. Mine does. Since Mozilla doesn&#039;t maintain older versions (except the ESR), each new version is considered a &quot;security update&quot;, so they are updated in the LTSes.<br />
			</dd>
			<dt class="postheader">
				Title: <strong>Re: Tutorial: Encrypted and Torified Linux Virtual Machine on a Windows USB Stick</strong><br />
				Post by: <strong>Bazille</strong> on <strong>September 17, 2013, 10:50 pm</strong>
			</dt>
			<dd class="postbody">
				Right. I just checked it in another installation of Xubuntu. However it only seems to apply to security updates of Firefox. Normal updates of Firefox don&#039;t seem to get updated. I didn&#039;t get version 23.1 here.
			</dd>
			<dt class="postheader">
				Title: <strong>Re: Tutorial: Encrypted and Torified Linux Virtual Machine on a Windows USB Stick</strong><br />
				Post by: <strong>astor</strong> on <strong>September 17, 2013, 11:12 pm</strong>
			</dt>
			<dd class="postbody">
				There is no version 23.1. I was upgraded to version 24 today. That is the security (and feature) update to 23. :)<br />
			</dd>
			<dt class="postheader">
				Title: <strong>Re: Tutorial: Encrypted and Torified Linux Virtual Machine on a Windows USB Stick</strong><br />
				Post by: <strong>Bazille</strong> on <strong>September 17, 2013, 11:27 pm</strong>
			</dt>
			<dd class="postbody">
				There was a version 23.0.1. I didn&#039;t get that on Xubuntu 12.04 LTS 
			</dd>
			<dt class="postheader">
				Title: <strong>Re: Tutorial: Encrypted and Torified Linux Virtual Machine on a Windows USB Stick</strong><br />
				Post by: <strong>astor</strong> on <strong>September 18, 2013, 01:22 am</strong>
			</dt>
			<dd class="postbody">
				hmmm, apparently there was a 23.0.1, probably an important security fix for 23, that came about 2 weeks after version 23, but they are on a 6 week release cycle, and no minor versions come out after the next major version. You can see it in their release history:<br /><br />https://ftp.mozilla.org/pub/mozilla.org/firefox/releases/<br /><br />There was a 19.0.1 and 19.0.2, but no more versions of 19 came out after 20 came out. 20 was the next version and got all the security fixes. 24 got all the security fixes for 23(.0.1).<br /><br />You can also see it in their release notes from today. They say to upgrade to 24 or 17.0.9 ESR. Those are the only versions getting security fixes. There won&#039;t be a 23.0.2.
			</dd>
		</dl>
		<div id="footer" class="smalltext">
			
			<span class="smalltext" style="display: inline; visibility: visible; font-family: Verdana, Arial, sans-serif;"><a href="http://dkn255hz262ypmii.onion/index.php?action=credits" title="Simple Machines Forum" target="_blank" class="new_win">SMF 2.0.5</a> |
 <a href="http://www.simplemachines.org/about/smf/license.php" title="License" target="_blank" class="new_win">SMF &copy; 2013</a>, <a href="http://www.simplemachines.org" title="Simple Machines" target="_blank" class="new_win">Simple Machines</a>
			</span>
		</div>
	</body>
</html>