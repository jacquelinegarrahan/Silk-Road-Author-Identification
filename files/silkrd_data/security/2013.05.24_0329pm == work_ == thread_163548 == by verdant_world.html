<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<meta name="robots" content="noindex" />
		<link rel="canonical" href="http://dkn255hz262ypmii.onion/index.php?topic=163548.0" />
		<title>Print Page -  work?</title>
		<style type="text/css">
			body, a
			{
				color: #000;
				background: #fff;
			}
			body, td, .normaltext
			{
				font-family: Verdana, arial, helvetica, serif;
				font-size: small;
			}
			h1#title
			{
				font-size: large;
				font-weight: bold;
			}
			h2#linktree
			{
				margin: 1em 0 2.5em 0;
				font-size: small;
				font-weight: bold;
			}
			dl#posts
			{
				width: 90%;
				margin: 0;
				padding: 0;
				list-style: none;
			}
			dt.postheader
			{
				border: solid #000;
				border-width: 1px 0;
				padding: 4px 0;
			}
			dd.postbody
			{
				margin: 1em 0 2em 2em;
			}
			table
			{
				empty-cells: show;
			}
			blockquote, code
			{
				border: 1px solid #000;
				margin: 3px;
				padding: 1px;
				display: block;
			}
			code
			{
				font: x-small monospace;
			}
			blockquote
			{
				font-size: x-small;
			}
			.smalltext, .quoteheader, .codeheader
			{
				font-size: x-small;
			}
			.largetext
			{
				font-size: large;
			}
			.centertext
			{
				text-align: center;
			}
			hr
			{
				height: 1px;
				border: 0;
				color: black;
				background-color: black;
			}
		</style>
	</head>
	<body>
		<h1 id="title">Silk Road forums</h1>
		<h2 id="linktree">Discussion => Security => Topic started by: verdant_world on May 24, 2013, 03:29 pm</h2>
		<dl id="posts">
			<dt class="postheader">
				Title: <strong> work?</strong><br />
				Post by: <strong>verdant_world</strong> on <strong>May 24, 2013, 03:29 pm</strong>
			</dt>
			<dd class="postbody">
				&nbsp;;)pefcpu<br />
			</dd>
			<dt class="postheader">
				Title: <strong>Re: How does a signature work?</strong><br />
				Post by: <strong>astor</strong> on <strong>May 24, 2013, 03:47 pm</strong>
			</dt>
			<dd class="postbody">
				No, it&#039;s a separate feature from encrypting and decrypting. Your PGP program should have a &quot;sign&quot; button or menu option. Take a look at the GPG4USB tutorial linked in my signature. It tells you how to do it in that program. There will also be a &quot;verify&quot; option. One person signs a message and everyone else verifies it with his public key.<br /><br />The purpose of a signature is that it proves whoever owns that PGP key wrote it. It has actually been useful in this community. DPR usually signs his messages so the community can trust his announcements. Also, there was a case where a vendor&#039;s SR and forum accounts got hacked. He had to create a separate forum account, and he was asked to post a signed message that could be verified with the public key on his profile, to prove his identity.<br /><br />If you&#039;ve never messed with signing and verifying, grab my public key from the link my signature and verify this message:<br /><br /><br />-----BEGIN PGP SIGNED MESSAGE-----<br />Hash: SHA512<br /><br />Astor wrote this message.<br /><br />-----BEGIN PGP SIGNATURE-----<br /><br />iQIcBAEBCgAGBQJRn4nRAAoJENAcophwbuIHnG0P/jqZzJ+/xl54n9yNQL59wMe/<br />mpUFtYtQa4ZiKaUmJWdGHjNbiMIx5WnYChGQGT9Dk53jMoL5bgGzV7qEul7k8tyE<br />Jzkf+5KZazhOTla8DAGMwZxrnRaWN5fdPh+rNKQ1uEcbYVjBhFAyM0fhiKISfeHZ<br />h8/Un9FIp9Q+NYJilGkTEpV1LeGspBFCn8JG1TvqYz3cCRMAJiQNiHI05fJZW+Qh<br />q4ChxF6LmvZ0Mh62bv2S5YGRkt0p0Z3X2ps4Y8zB0Owz/x+UEyQu+VAKMgaCmxhJ<br />QJsLXGwCrr0mdGo86DluRw22A3OTs5GqDglG8di04VgXAY1ZJK/Mi0+oFxCeUX+B<br />SsEc9ds95qwuGuHdBk3oFnscVM/OrMZBwHnGX2M66wiE0QycIefUufWJUqyEo28y<br />Hac8W+m7IadVyyygKmLzjS3PRMAgmFriazLYsz0NHPekC4NpS3qo+05UvxN5Gg/o<br />yebB68f0omKpHf84LLU1SW24kc8GhEzn/43tgic5JUo4gS+9qohQYr0uLkPBH9dt<br />yKN2LH4Z0pGmPzxixBh2pLBfspjWWoEqb+r30xGdiUoaiqEvFm2KR4FzVMDq/C+7<br />iJiDoRBVCQl6KosC6T+SDMzSQikk2WFOpbr7EF1MQL086qm7xCJmLs/w3CErFs2l<br />BeQCG1rHBApEO5snBxSo<br />=QqtJ<br />-----END PGP SIGNATURE-----<br />
			</dd>
			<dt class="postheader">
				Title: <strong>Re: How does a signature work?</strong><br />
				Post by: <strong>kmfkewm</strong> on <strong>May 25, 2013, 02:16 am</strong>
			</dt>
			<dd class="postbody">
				With RSA, signing is the same as encrypting, it is just you encrypt with the private key and decrypt with the public key. As it is implemented in cryptosystems, you take a hash value of the message to sign, then you encrypt the hash with the private key to get the signature. Then to verify the signature, the verifier takes the hash of the message, then they decrypt the signature with the public key and compare it to the hash value.<br /><br />In addition to only operating on hash values, I believe you also need to use padding for it to be secure. Also, you need to make sure to use constant time comparisons in order to protect from timing attacks. However, the abundance of small (and highly important) details aside, at a core level, sign/verify is the same thing as encrypt/decrypt, just with the utilized keys reversed.<br /><br />Of course you don&#039;t need to know any of this to use GPG, because they package it all up for you. But you were technically pretty much correct at a low level, just not from the high level perspective of using GPG to create and verify RSA signatures (in which case it is not the same thing as encrypt/decrypt, but rather is sign and verify). 
			</dd>
			<dt class="postheader">
				Title: <strong>Re: How does a signature work?</strong><br />
				Post by: <strong>Hendrix99</strong> on <strong>May 25, 2013, 04:02 am</strong>
			</dt>
			<dd class="postbody">
				talk about the simple easy to understand answer followed by a super complicated scientific answer! <br />had a hard time wrapping my head around that one&nbsp; :o
			</dd>
			<dt class="postheader">
				Title: <strong>Re: How does a signature work?</strong><br />
				Post by: <strong>kmfkewm</strong> on <strong>May 25, 2013, 06:17 am</strong>
			</dt>
			<dd class="postbody">
				It is pretty simple really. Given an RSA keypair, anything encrypted with one key can be decrypted with the other. When you use RSA for regular encrypt/decrypt , you encrypt a random session key with the public key and then it is decrypted with the private key. When you use &#039;plain RSA&#039; for signatures, you encrypt the message with the private key, and it is verified by being decrypted with the public key. However, using plain RSA for signatures is weak to all kinds of attacks. Instead you need to use the hash of the message, padding, and all kinds of other things need to be taken into consideration. But at a fundamental level, RSA sign/verify is the same thing as RSA encrypt/decrypt , but with the private key used for encryption and the public key used for decryption. 
			</dd>
			<dt class="postheader">
				Title: <strong>Re: How does a signature work?</strong><br />
				Post by: <strong>kmfkewm</strong> on <strong>May 25, 2013, 06:44 am</strong>
			</dt>
			<dd class="postbody">
				Using Astors post as an example:<br /><br />-----BEGIN PGP SIGNED MESSAGE-----<br />Hash: SHA512<br /><br />Astor wrote this message.<br /><br />-----BEGIN PGP SIGNATURE-----<br /><br />iQIcBAEBCgAGBQJRn4nRAAoJENAcophwbuIHnG0P/jqZzJ+/xl54n9yNQL59wMe/<br />mpUFtYtQa4ZiKaUmJWdGHjNbiMIx5WnYChGQGT9Dk53jMoL5bgGzV7qEul7k8tyE<br />Jzkf+5KZazhOTla8DAGMwZxrnRaWN5fdPh+rNKQ1uEcbYVjBhFAyM0fhiKISfeHZ<br />h8/Un9FIp9Q+NYJilGkTEpV1LeGspBFCn8JG1TvqYz3cCRMAJiQNiHI05fJZW+Qh<br />q4ChxF6LmvZ0Mh62bv2S5YGRkt0p0Z3X2ps4Y8zB0Owz/x+UEyQu+VAKMgaCmxhJ<br />QJsLXGwCrr0mdGo86DluRw22A3OTs5GqDglG8di04VgXAY1ZJK/Mi0+oFxCeUX+B<br />SsEc9ds95qwuGuHdBk3oFnscVM/OrMZBwHnGX2M66wiE0QycIefUufWJUqyEo28y<br />Hac8W+m7IadVyyygKmLzjS3PRMAgmFriazLYsz0NHPekC4NpS3qo+05UvxN5Gg/o<br />yebB68f0omKpHf84LLU1SW24kc8GhEzn/43tgic5JUo4gS+9qohQYr0uLkPBH9dt<br />yKN2LH4Z0pGmPzxixBh2pLBfspjWWoEqb+r30xGdiUoaiqEvFm2KR4FzVMDq/C+7<br />iJiDoRBVCQl6KosC6T+SDMzSQikk2WFOpbr7EF1MQL086qm7xCJmLs/w3CErFs2l<br />BeQCG1rHBApEO5snBxSo<br />=QqtJ<br />-----END PGP SIGNATURE-----<br /><br />When he signed the message &#039;Astor wrote this message&#039; he used the sign button on some GPG GUI, or perhaps he used the CLI command gpg --clearsign <br />Likewise when the signature is verified, the verifier likely either uses a verify button on a GPG GUI, or perhaps they use the CLI command gpg --verify<br /><br />However, when the GPG sign command is used, <br /><br />First GPG takes a hash of the message &#039;Astor wrote this message&#039;, as you can see from the signed text the hashing algorithm SHA512 was utilized. The hex value of the SHA512 of the signed message is:<br /><br />41aef97732043975c8ba34dedb2aeb7c4419677b2fcde5d4c869184837d37a542870a136c812d5ae172b6d4b6ce7e19a07c534fef0fe0cf93ec315644347440a<br /><br />next, GPG used Astor&#039;s private key to encrypt the hash of the message, and then it base64 encoded the ciphertext. The base64 encoded version of the asymmetrically encrypted (with Astor&#039;s private key) version of the previous hash value is:<br /><br />iQIcBAEBCgAGBQJRn4nRAAoJENAcophwbuIHnG0P/jqZzJ+/xl54n9yNQL59wMe/<br />mpUFtYtQa4ZiKaUmJWdGHjNbiMIx5WnYChGQGT9Dk53jMoL5bgGzV7qEul7k8tyE<br />Jzkf+5KZazhOTla8DAGMwZxrnRaWN5fdPh+rNKQ1uEcbYVjBhFAyM0fhiKISfeHZ<br />h8/Un9FIp9Q+NYJilGkTEpV1LeGspBFCn8JG1TvqYz3cCRMAJiQNiHI05fJZW+Qh<br />q4ChxF6LmvZ0Mh62bv2S5YGRkt0p0Z3X2ps4Y8zB0Owz/x+UEyQu+VAKMgaCmxhJ<br />QJsLXGwCrr0mdGo86DluRw22A3OTs5GqDglG8di04VgXAY1ZJK/Mi0+oFxCeUX+B<br />SsEc9ds95qwuGuHdBk3oFnscVM/OrMZBwHnGX2M66wiE0QycIefUufWJUqyEo28y<br />Hac8W+m7IadVyyygKmLzjS3PRMAgmFriazLYsz0NHPekC4NpS3qo+05UvxN5Gg/o<br />yebB68f0omKpHf84LLU1SW24kc8GhEzn/43tgic5JUo4gS+9qohQYr0uLkPBH9dt<br />yKN2LH4Z0pGmPzxixBh2pLBfspjWWoEqb+r30xGdiUoaiqEvFm2KR4FzVMDq/C+7<br />iJiDoRBVCQl6KosC6T+SDMzSQikk2WFOpbr7EF1MQL086qm7xCJmLs/w3CErFs2l<br />BeQCG1rHBApEO5snBxSo<br />=QqtJ<br /><br />which is attached to the message (note that I am skipping a padding step since I don&#039;t know the specification for it by heart):<br /><br />when somebody verifies that Astor signed the message:<br /><br />-----BEGIN PGP SIGNED MESSAGE-----<br />Hash: SHA512<br /><br />Astor wrote this message.<br /><br />-----BEGIN PGP SIGNATURE-----<br /><br />iQIcBAEBCgAGBQJRn4nRAAoJENAcophwbuIHnG0P/jqZzJ+/xl54n9yNQL59wMe/<br />mpUFtYtQa4ZiKaUmJWdGHjNbiMIx5WnYChGQGT9Dk53jMoL5bgGzV7qEul7k8tyE<br />Jzkf+5KZazhOTla8DAGMwZxrnRaWN5fdPh+rNKQ1uEcbYVjBhFAyM0fhiKISfeHZ<br />h8/Un9FIp9Q+NYJilGkTEpV1LeGspBFCn8JG1TvqYz3cCRMAJiQNiHI05fJZW+Qh<br />q4ChxF6LmvZ0Mh62bv2S5YGRkt0p0Z3X2ps4Y8zB0Owz/x+UEyQu+VAKMgaCmxhJ<br />QJsLXGwCrr0mdGo86DluRw22A3OTs5GqDglG8di04VgXAY1ZJK/Mi0+oFxCeUX+B<br />SsEc9ds95qwuGuHdBk3oFnscVM/OrMZBwHnGX2M66wiE0QycIefUufWJUqyEo28y<br />Hac8W+m7IadVyyygKmLzjS3PRMAgmFriazLYsz0NHPekC4NpS3qo+05UvxN5Gg/o<br />yebB68f0omKpHf84LLU1SW24kc8GhEzn/43tgic5JUo4gS+9qohQYr0uLkPBH9dt<br />yKN2LH4Z0pGmPzxixBh2pLBfspjWWoEqb+r30xGdiUoaiqEvFm2KR4FzVMDq/C+7<br />iJiDoRBVCQl6KosC6T+SDMzSQikk2WFOpbr7EF1MQL086qm7xCJmLs/w3CErFs2l<br />BeQCG1rHBApEO5snBxSo<br />=QqtJ<br />-----END PGP SIGNATURE-----<br /><br />first their GPG program notes that the hashing algorithm used was SHA512. Then GPG takes the SHA512 value of the message:<br /><br />41aef97732043975c8ba34dedb2aeb7c4419677b2fcde5d4c869184837d37a542870a136c812d5ae172b6d4b6ce7e19a07c534fef0fe0cf93ec315644347440<br /><br />next it unbase64s the signature, and then it decrypts the signature with Astor&#039;s public key, revealing the hash value (again I am skipping the step that removes padding). Next GPG compares the hash value of the message to the value it obtained after unbase64ing, decrypting and removing padding from the signature. If they both match, then it verifies that the message was signed by Astor, otherwise it says the signature is not valid. <br /><br />41aef97732043975c8ba34dedb2aeb7c4419677b2fcde5d4c869184837d37a542870a136c812d5ae172b6d4b6ce7e19a07c534fef0fe0cf93ec315644347440<br />==<br />41aef97732043975c8ba34dedb2aeb7c4419677b2fcde5d4c869184837d37a542870a136c812d5ae172b6d4b6ce7e19a07c534fef0fe0cf93ec315644347440<br /><br />When it compares the two strings, it must do so in constant time to avoid the possibility of a timing attack. Normally when two strings are compared, the comparing algorithm breaks on the first mismatch. In this case we need to compare every single character, even if there are mismatches, so that successful or unsuccessful verification takes exactly the same amount of time.<br /><br />This is just a rough sketch of what GPG is doing when signing and verifying signatures with RSA, I definitely missed at least one step. <br /><br /><br /><br />
			</dd>
			<dt class="postheader">
				Title: <strong>Re: How does a signature work?</strong><br />
				Post by: <strong>RS7FI8ZRkm</strong> on <strong>May 25, 2013, 07:04 pm</strong>
			</dt>
			<dd class="postbody">
				(head implodes)
			</dd>
			<dt class="postheader">
				Title: <strong>Re: How does a signature work?</strong><br />
				Post by: <strong>astor</strong> on <strong>May 25, 2013, 08:11 pm</strong>
			</dt>
			<dd class="postbody">
				<div class="quoteheader"><div class="topslice_quote"><a href="http://dkn255hz262ypmii.onion/index.php?topic=163548.msg1162505#msg1162505">Quote from: kmfkewm on May 25, 2013, 06:44 am</a></div></div><blockquote class="bbc_standard_quote">When it compares the two strings, it must do so in constant time to avoid the possibility of a timing attack. <br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />Can you explain this attack?
			</dd>
			<dt class="postheader">
				Title: <strong>Re: How does a signature work?</strong><br />
				Post by: <strong>Mr. Fluffles Schrodinger</strong> on <strong>May 26, 2013, 01:01 am</strong>
			</dt>
			<dd class="postbody">
				Yep. There it goes. <br />My head is under something again. 
			</dd>
		</dl>
		<div id="footer" class="smalltext">
			
			<span class="smalltext" style="display: inline; visibility: visible; font-family: Verdana, Arial, sans-serif;"><a href="http://dkn255hz262ypmii.onion/index.php?action=credits" title="Simple Machines Forum" target="_blank" class="new_win">SMF 2.0.5</a> |
 <a href="http://www.simplemachines.org/about/smf/license.php" title="License" target="_blank" class="new_win">SMF &copy; 2013</a>, <a href="http://www.simplemachines.org" title="Simple Machines" target="_blank" class="new_win">Simple Machines</a>
			</span>
		</div>
	</body>
</html>