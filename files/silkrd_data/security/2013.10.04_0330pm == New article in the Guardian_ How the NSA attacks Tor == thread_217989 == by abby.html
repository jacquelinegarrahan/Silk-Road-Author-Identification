<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<meta name="robots" content="noindex" />
		<link rel="canonical" href="http://dkn255hz262ypmii.onion/index.php?topic=217989.0" />
		<title>Print Page - New article in the Guardian: How the NSA attacks Tor</title>
		<style type="text/css">
			body, a
			{
				color: #000;
				background: #fff;
			}
			body, td, .normaltext
			{
				font-family: Verdana, arial, helvetica, serif;
				font-size: small;
			}
			h1#title
			{
				font-size: large;
				font-weight: bold;
			}
			h2#linktree
			{
				margin: 1em 0 2.5em 0;
				font-size: small;
				font-weight: bold;
			}
			dl#posts
			{
				width: 90%;
				margin: 0;
				padding: 0;
				list-style: none;
			}
			dt.postheader
			{
				border: solid #000;
				border-width: 1px 0;
				padding: 4px 0;
			}
			dd.postbody
			{
				margin: 1em 0 2em 2em;
			}
			table
			{
				empty-cells: show;
			}
			blockquote, code
			{
				border: 1px solid #000;
				margin: 3px;
				padding: 1px;
				display: block;
			}
			code
			{
				font: x-small monospace;
			}
			blockquote
			{
				font-size: x-small;
			}
			.smalltext, .quoteheader, .codeheader
			{
				font-size: x-small;
			}
			.largetext
			{
				font-size: large;
			}
			.centertext
			{
				text-align: center;
			}
			hr
			{
				height: 1px;
				border: 0;
				color: black;
				background-color: black;
			}
		</style>
	</head>
	<body>
		<h1 id="title">Silk Road forums</h1>
		<h2 id="linktree">Discussion => Security => Topic started by: abby on October 04, 2013, 03:30 pm</h2>
		<dl id="posts">
			<dt class="postheader">
				Title: <strong>New article in the Guardian: How the NSA attacks Tor</strong><br />
				Post by: <strong>abby</strong> on <strong>October 04, 2013, 03:30 pm</strong>
			</dt>
			<dd class="postbody">
				http://www.theguardian.com/world/2013/oct/04/tor-attacks-nsa-users-online-anonymity<br /><br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote">Attacking Tor: how the NSA targets users&#039; online anonymity<br /><br />Secret servers and a privileged position on the internet&#039;s backbone used to identify users and attack target computers<br /><br /><br />The online anonymity network Tor is a high-priority target for the National Security Agency. The work of attacking Tor is done by the NSA&#039;s application vulnerabilities branch, which is part of the systems intelligence directorate, or SID. The majority of NSA employees work in SID, which is tasked with collecting data from communications systems around the world.<br /><br />According to a top-secret NSA presentation provided by the whistleblower Edward Snowden, one successful technique the NSA has developed involves exploiting the Tor browser bundle, a collection of programs designed to make it easy for people to install and use the software. The trick identified Tor users on the internet and then executes an attack against their Firefox web browser.<br /><br />The NSA refers to these capabilities as CNE, or computer network exploitation.<br /><br />The first step of this process is finding Tor users. To accomplish this, the NSA relies on its vast capability to monitor large parts of the internet. This is done via the agency&#039;s partnership with US telecoms firms under programs codenamed Stormbrew, Fairview, Oakstar and Blarney.<br /><br />The NSA creates &quot;fingerprints&quot; that detect http requests from the Tor network to particular servers. These fingerprints are loaded into NSA database systems like XKeyscore, a bespoke collection and analysis tool which NSA boasts allows its analysts to see &quot;almost everything&quot; a target does on the internet.<br /><br />Using powerful data analysis tools with codenames such as Turbulence, Turmoil and Tumult, the NSA automatically sifts through the enormous amount of internet traffic that it sees, looking for Tor connections.<br /><br />Last week, Brazilian TV news show Fantastico showed screenshots of an NSA tool that had the ability to identify Tor users by monitoring internet traffic.<br /><br />The very feature that makes Tor a powerful anonymity service, and the fact that all Tor users look alike on the internet, makes it easy to differentiate Tor users from other web users. On the other hand, the anonymity provided by Tor makes it impossible for the NSA to know who the user is, or whether or not the user is in the US.<br /><br />After identifying an individual Tor user on the internet, the NSA uses its network of secret internet servers to redirect those users to another set of secret internet servers, with the codename FoxAcid, to infect the user&#039;s computer. FoxAcid is an NSA system designed to act as a matchmaker between potential targets and attacks developed by the NSA, giving the agency opportunity to launch prepared attacks against their systems.<br /><br />Once the computer is successfully attacked, it secretly calls back to a FoxAcid server, which then performs additional attacks on the target computer to ensure that it remains compromised long-term, and continues to provide eavesdropping information back to the NSA.<br />Exploiting the Tor browser bundle<br /><br />Tor is a well-designed and robust anonymity tool, and successfully attacking it is difficult. The NSA attacks we found individually target Tor users by exploiting vulnerabilities in their Firefox browsers, and not the Tor application directly.<br /><br />This, too, is difficult. Tor users often turn off vulnerable services like scripts and Flash when using Tor, making it difficult to target those services. Even so, the NSA uses a series of native Firefox vulnerabilities to attack users of the Tor browser bundle.<br /><br />According to the training presentation provided by Snowden, EgotisticalGiraffe exploits a type confusion vulnerability in EX4, which is an XML extension for Javascript. This vulnerability exists in Firefox 11.0 – 16.0.2, as well as Firefox 10.0 ESR – the Firefox version used until recently in the Tor browser bundle. According to another document, the vulnerability exploited by EgotisticalGiraffe was inadvertently fixed when Mozilla removed the EX4 library with the vulnerability, and when Tor added that Firefox version into the Tor browser bundle, but NSA were confident that they would be able to find a replacement Firefox exploit that worked against version 17.0 ESR.<br />The Quantum system<br /><br />To trick targets into visiting a FoxAcid server, the NSA relies on its secret partnerships with US telecoms companies. As part of the Turmoil system, the NSA places secret servers, codenamed Quantum, at key places on the internet backbone. This placement ensures that they can react faster than other websites can. By exploiting that speed difference, these servers can impersonate a visited website to the target before the legitimate website can respond, thereby tricking the target&#039;s browser to visit a Foxacid server.<br /><br />In the academic literature, these are called &quot;man-on-the-middle&quot; attacks, and have been known to the commercial and academic security communities. More specifically, they are examples of &quot;man-on-the-side&quot; attacks.<br /><br />They are hard for any organization other than the NSA to reliably execute, because they require the attacker to have a privileged position on the internet backbone, and exploit a &quot;race condition&quot; between the NSA server and the legitimate website. This top-secret NSA diagram, made public last month, shows a Quantum server impersonating Google in this type of attack.<br /><br />The NSA uses these fast Quantum servers to execute a packet injection attack, which surreptitiously redirects the target to the FoxAcid server. An article in the German magazine Spiegel, based on additional top secret Snowden documents, mentions an NSA developed attack technology with the name of QuantumInsert that performs redirection attacks. Another top-secret Tor presentation provided by Snowden mentions QuantumCookie to force cookies onto target browsers, and another Quantum program to &quot;degrade/deny/disrupt Tor access&quot;.<br /><br />This same technique is used by the Chinese government to block its citizens from reading censored internet content, and has been hypothesized as a probable NSA attack technique.<br />The FoxAcid system<br /><br />According to various top-secret documents provided by Snowden, FoxAcid is the NSA codename for what the NSA calls an &quot;exploit orchestrator,&quot; an internet-enabled system capable of attacking target computers in a variety of different ways. It is a Windows 2003 computer configured with custom software and a series of Perl scripts. These servers are run by the NSA&#039;s tailored access operations, or TAO, group. TAO is another subgroup of the systems intelligence directorate.<br /><br />The servers are on the public internet. They have normal-looking domain names, and can be visited by any browser from anywhere; ownership of those domains cannot be traced back to the NSA.<br /><br />However, if a browser tries to visit a FoxAcid server with a special URL, called a FoxAcid tag, the server attempts to infect that browser, and then the computer, in an effort to take control of it. The NSA can trick browsers into using that URL using a variety of methods, including the race-condition attack mentioned above and frame injection attacks.<br /><br />FoxAcid tags are designed to look innocuous, so that anyone who sees them would not be suspicious. An example of one such tag is given in another top-secret training presentation provided by Snowden.<br /><br />There is no currently registered domain name by that name; it is just an example for internal NSA training purposes.<br /><br />The training material states that merely trying to visit the homepage of a real FoxAcid server will not result in any attack, and that a specialized URL is required. This URL would be created by TAO for a specific NSA operation, and unique to that operation and target. This allows the FoxAcid server to know exactly who the target is when his computer contacts it.<br /><br />According to Snowden, FoxAcid is a general CNE system, used for many types of attacks other than the Tor attacks described here. It is designed to be modular, with flexibility that allows TAO to swap and replace exploits if they are discovered, and only run certain exploits against certain types of targets.<br /><br />The most valuable exploits are saved for the most important targets. Low-value exploits are run against technically sophisticated targets where the chance of detection is high. TAO maintains a library of exploits, each based on a different vulnerability in a system. Different exploits are authorized against different targets, depending on the value of the target, the target&#039;s technical sophistication, the value of the exploit, and other considerations.<br /><br />In the case of Tor users, FoxAcid might use EgotisticalGiraffe against their Firefox browsers.<br /><br />FoxAcid servers also have sophisticated capabilities to avoid detection and to ensure successful infection of its targets. One of the top-secret documents provided by Snowen demonstrates how FoxAcid can circumvent commercial products that prevent malicious software from making changes to a system that survive a reboot process.<br /><br />According to a top-secret operational management procedures manual provided by Snowden, once a target is successfully exploited it is infected with one of several payloads. Two basic payloads mentioned in the manual, are designed to collect configuration and location information from the target computer so an analyst can determine how to further infect the computer.<br /><br />These decisions are made in part by the technical sophistication of the target and the security software installed on the target computer; called Personal Security Products or PSP, in the manual.<br /><br />FoxAcid payloads are updated regularly by TAO. For example, the manual refers to version 8.2.1.1 of one of them.<br /><br />FoxAcid servers also have sophisticated capabilities to avoid detection and to ensure successful infection of its targets. The operations manual states that a FoxAcid payload with the codename DireScallop can circumvent commercial products that prevent malicious software from making changes to a system that survive a reboot process.<br /><br />The NSA also uses phishing attacks to induce users to click on FoxAcid tags.<br /><br />TAO additionally uses FoxAcid to exploit callbacks – which is the general term for a computer infected by some automatic means – calling back to the NSA for more instructions and possibly to upload data from the target computer.<br /><br />According to a top-secret operational management procedures manual, FoxAcid servers configured to receive callbacks are codenamed FrugalShot. After a callback, the FoxAcid server may run more exploits to ensure that the target computer remains compromised long term, as well as install &quot;implants&quot; designed to exfiltrate data.<br /><br />By 2008, the NSA was getting so much FoxAcid callback data that they needed to build a special system to manage it all. </blockquote><div class="quotefooter"><div class="botslice_quote"></div></div>
			</dd>
			<dt class="postheader">
				Title: <strong>Re: New article in the Guardian: How the NSA attacks Tor</strong><br />
				Post by: <strong>MarcelKetman</strong> on <strong>October 04, 2013, 06:24 pm</strong>
			</dt>
			<dd class="postbody">
				http://www.theguardian.com/world/2013/oct/04/nsa-gchq-attack-tor-network-encryption<br /><br />Another article in the same paper. Very encouraging to see, that if people we do things the right way, we&#039;re safe. For now :) 
			</dd>
			<dt class="postheader">
				Title: <strong>Re: New article in the Guardian: How the NSA attacks Tor</strong><br />
				Post by: <strong>twistedheart</strong> on <strong>October 04, 2013, 07:07 pm</strong>
			</dt>
			<dd class="postbody">
				Some of the links leading to the PowerPoint demonstrations illustrating how the NSA can compromise browsers and potentially disrupt the Tor network are scary:<br /><br />CLEARNET<br /><br />http://www.theguardian.com/world/interactive/2013/oct/04/egotistical-giraffe-nsa-tor-document<br /><br />http://www.theguardian.com/world/interactive/2013/oct/04/tor-stinks-nsa-presentation-document
			</dd>
			<dt class="postheader">
				Title: <strong>Re: New article in the Guardian: How the NSA attacks Tor</strong><br />
				Post by: <strong>robotrippin</strong> on <strong>October 04, 2013, 08:30 pm</strong>
			</dt>
			<dd class="postbody">
				I was reading another thread about this and posted this link there as well. It&#039;s just another article about this for anyone who&#039;s interested, obviously clearnet.<br /><br />http://rt.com/usa/nsa-target-tor-network-739/<br /><br />
			</dd>
			<dt class="postheader">
				Title: <strong>Re: New article in the Guardian: How the NSA attacks Tor</strong><br />
				Post by: <strong>weather420</strong> on <strong>October 04, 2013, 09:58 pm</strong>
			</dt>
			<dd class="postbody">
				No shit.
			</dd>
			<dt class="postheader">
				Title: <strong>Re: New article in the Guardian: How the NSA attacks Tor</strong><br />
				Post by: <strong>AlternateReality</strong> on <strong>October 04, 2013, 11:10 pm</strong>
			</dt>
			<dd class="postbody">
				Fucking NSA. It&#039;s a shame the United Kingdom kisses America&#039;s ass.
			</dd>
			<dt class="postheader">
				Title: <strong>Re: New article in the Guardian: How the NSA attacks Tor</strong><br />
				Post by: <strong>abby</strong> on <strong>October 04, 2013, 11:32 pm</strong>
			</dt>
			<dd class="postbody">
				here&#039;s the initial response from Tor https://blog.torproject.org/blog/yes-we-know-about-guardian-article&nbsp; It&#039;s really just a placeholder at the moment but&nbsp; I&#039;d keep an eye on it to see what their final response will be.<br /><br /><br /><br /><div class="quoteheader"><div class="topslice_quote">Quote</div></div><blockquote class="bbc_standard_quote"> And also the Washington Post article.<br /><br />We&#039;re planning to write up a more detailed analysis later, but for now here&#039;s a place to centralize all the &quot;hey did you know about this article&quot; blog comments.<br /><br />And for the journalists out there who want a statement, here&#039;s my quote from the article:<br /><br />&quot;The good news is that they went for a browser exploit, meaning there&#039;s no indication they can break the Tor protocol or do traffic analysis on the Tor network. Infecting the laptop, phone, or desktop is still the easiest way to learn about the human behind the keyboard.<br /><br />Tor still helps here: you can target individuals with browser exploits, but if you attack too many users, somebody&#039;s going to notice. So even if the NSA aims to surveil everyone, everywhere, they have to be a lot more selective about which Tor users they spy on.<br /><br />Just using Tor isn&#039;t enough to keep you safe in all cases. Browser exploits, large-scale surveillance, and general user security are all challenging topics for the average internet user. These attacks make it clear that we, the broader internet community, need to keep working on better security for browsers and other internet-facing applications.&quot; [\quote]<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div>
			</dd>
			<dt class="postheader">
				Title: <strong>Re: New article in the Guardian: How the NSA attacks Tor</strong><br />
				Post by: <strong>FreedomOutlaw</strong> on <strong>October 05, 2013, 12:11 am</strong>
			</dt>
			<dd class="postbody">
				It sounds to me that that is only effective on people who go onto the clearnet through an exit node and not Hidden Services users. But I could be wrong.
			</dd>
			<dt class="postheader">
				Title: <strong>Re: New article in the Guardian: How the NSA attacks Tor</strong><br />
				Post by: <strong>Radius2000</strong> on <strong>October 05, 2013, 05:53 am</strong>
			</dt>
			<dd class="postbody">
				The &quot;TOR Stinks&quot; presentation is worth viewing too, so you can see what they currently do, what they are (were?) working on and how much attention they&#039;re giving to TOR. The first and last slides of the presentation are the most interesting.<br /><br />Edward Snowden is a hero in my eyes.
			</dd>
			<dt class="postheader">
				Title: <strong>Re: New article in the Guardian: How the NSA attacks Tor</strong><br />
				Post by: <strong>comsec</strong> on <strong>October 05, 2013, 05:57 am</strong>
			</dt>
			<dd class="postbody">
				<div class="quoteheader"><div class="topslice_quote"><a href="http://dkn255hz262ypmii.onion/index.php?topic=217989.msg1590834#msg1590834">Quote from: FreedomOutlaw on October 05, 2013, 12:11 am</a></div></div><blockquote class="bbc_standard_quote">It sounds to me that that is only effective on people who go onto the clearnet through an exit node and not Hidden Services users. But I could be wrong.<br /></blockquote><div class="quotefooter"><div class="botslice_quote"></div></div><br />They are running vast amounts of nodes, and redirecting users into their private network for analysis without them knowing. So if you connect to an NSA/GCHQ server your first hop you&#039;re going to be redirected to a controlled network.<br /><br />They are also &#039;staining&#039; packets, flipping the evil bit and other methods to follow you through nodes and clearnet.<br /><br />They are compromising browsers through MITM attacks, specifically TBB<br /><br />They are implanting tracking cookies that can&#039;t be deleted in TBB<br /><br />They are surprisingly unwilling to hack/exploit existing civillian relays, so make your own. 
			</dd>
		</dl>
		<div id="footer" class="smalltext">
			
			<span class="smalltext" style="display: inline; visibility: visible; font-family: Verdana, Arial, sans-serif;"><a href="http://dkn255hz262ypmii.onion/index.php?action=credits" title="Simple Machines Forum" target="_blank" class="new_win">SMF 2.0.5</a> |
 <a href="http://www.simplemachines.org/about/smf/license.php" title="License" target="_blank" class="new_win">SMF &copy; 2013</a>, <a href="http://www.simplemachines.org" title="Simple Machines" target="_blank" class="new_win">Simple Machines</a>
			</span>
		</div>
	</body>
</html>